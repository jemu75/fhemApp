import{u as Q,c as L,r as h,o as p,b as A,at as U,b5 as V,A as C,a as D,w,O as J,G as X,F as Z,e as S,bH as ne,aQ as q,bu as ae,ar as ie,d as he,U as Ie,af as de,ba as Ue,a5 as He,bv as Ee,aC as ke,ay as Ve,a9 as Oe,b1 as ve,bI as Ne,as as qe,ak as Be,be as W,bJ as $e,bK as Ke,bF as We,bG as Je,av as pe,b7 as Ge,bB as Ze,aV as Qe}from"./index-aZzSaMjR.js";const Ye={__name:"PanelMainInfo",props:{el:Object,iconmap:Array,devices:Object,height:String},setup(e){const t=e,n=Q(),o=L(()=>n.handleDefs(t.el.text,["text","format"],["",!t.el.text2&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),d=L(()=>n.handleDefs(t.el.text2,["text","format"],["",t.el.text&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),r=L(()=>n.handleDefs(t.el.text3,["text","format"],["","text-caption"])),v=L(()=>{let i=n.handleDefs(t.el.icon,["icon","color","size"],["","","x-large"]);return i.icon&&(i.icon=n.getIcon(i.icon,t.iconmap)),i}),a=L(()=>{let i=n.handleDefs(t.el.status,["level","color","min","max","reverse","linear"],[0,"success",0,100,!1,!1]);return i.level=Math.round((i.level-i.min)/(i.max-i.min)*100),i.reverse=!!i.reverse,i});return(i,l)=>{const c=h("v-icon"),f=h("v-progress-circular"),g=h("v-progress-linear");return p(),A(Z,null,[e.el.text?(p(),A("div",{key:0,class:U(o.value.format)},V(o.value.text),3)):C("",!0),e.el.icon?(p(),D(c,{key:1,color:v.value.color,size:v.value.size},{default:w(()=>[J(V(v.value.icon),1)]),_:1},8,["color","size"])):C("",!0),e.el.status&&!a.value.linear?(p(),D(f,{key:2,width:"4",modelValue:a.value.level,"onUpdate:modelValue":l[0]||(l[0]=O=>a.value.level=O),color:a.value.color,reverse:a.value.reverse},null,8,["modelValue","color","reverse"])):C("",!0),e.el.status&&a.value.linear?(p(),D(g,{key:3,height:"7",rounded:"",modelValue:a.value.level,"onUpdate:modelValue":l[1]||(l[1]=O=>a.value.level=O),color:a.value.color,reverse:a.value.reverse},null,8,["modelValue","color","reverse"])):C("",!0),X("div",{class:U(e.el.text2?d.value.format:r.value.format)},[e.el.text2?(p(),A("span",{key:0,class:U(d.value.format)},V(d.value.text),3)):C("",!0),e.el.text3?(p(),A("span",{key:1,class:U(r.value.format)},V(r.value.text),3)):C("",!0)],2)],64)}}},Xe={__name:"PanelMainBtn",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Q(),o=L(()=>{let i=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["",!1,"","text"]);return i.icon&&(i.icon=n.getIcon(i.icon,t.iconmap)),i}),d=L(()=>{let i=n.handleDefs(t.el.status,["level","color","min","max","reverse"],[0,"success",0,100,!1]);return i.level=Math.round((i.level-i.min)/(i.max-i.min)*100),i.reverse=!!i.reverse,i}),r={timer:!1,long:!1};function v(i){let l;if(i.cmd){if(i.type==="cmd"){l=i.cmd.split(";");for(const[c,f]of Object.entries(l)){l[c]=f;for(const g of t.devices)l[c]=l[c].replace(g.split(":")[0],g.split(":")[1])}n.request("text",l.join(";"))}i.type==="route"&&ne.push({name:"devices",params:{view:i.cmd},query:ne.currentRoute.value.query}),i.type==="url"&&window.open(i.cmd,"_self")}}function a(i){let l=n.handleDefs(t.el.click,["cmd","type"],["","cmd"],!1,null,!0),c=n.handleDefs(t.el.longClick,["cmd","type"],["","cmd"],!1,null,!0),f=n.handleDefs(t.el.longRelease,["cmd","type"],["","cmd"],!1,null,!0),g="ontouchstart"in document;(!g&&i==="mouseStart"||i==="touchStart")&&(r.timer=setTimeout(()=>{r.long=!0,c.cmd&&v(c)},1e3)),(!g&&i==="mouseEnd"||i==="touchEnd")&&(r.long?f.cmd&&v(f):l.cmd&&v(l),clearTimeout(r.timer),r.long=!1)}return(i,l)=>{const c=h("v-progress-linear"),f=h("v-icon"),g=h("v-btn");return p(),A(Z,null,[e.el.status?(p(),D(c,{key:0,height:"4",modelValue:d.value.level,"onUpdate:modelValue":l[0]||(l[0]=O=>d.value.level=O),color:d.value.color,reverse:d.value.reverse},null,8,["modelValue","color","reverse"])):C("",!0),S(g,{icon:"",variant:o.value.variant,disabled:o.value.disabled,color:o.value.color,onMousedown:l[1]||(l[1]=O=>a("mouseStart")),onTouchstart:l[2]||(l[2]=O=>a("touchStart")),onMouseup:l[3]||(l[3]=O=>a("mouseEnd")),onTouchend:l[4]||(l[4]=O=>a("touchEnd")),class:"my-2"},{default:w(()=>[S(f,{size:"large"},{default:w(()=>[J(V(o.value.icon),1)]),_:1})]),_:1},8,["variant","disabled","color"])],64)}}},et={class:"text-white"},tt={__name:"PanelMainSlider",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Q(),o=q();function d(i){o.value=i}const r=L(()=>{let i=n.handleDefs(t.el.slider,["cmd","current","color","min","max","steps","reverse","size","vertical"],["",0,"",0,100,10,!1,4,!1],!1,null,!0);return/%v/.test(i.current)&&(i.current=i.current.replace("%v",o.value)),d(i.current),i});let v=null;function a(i){let l=r.value.cmd,c=/\./.exec(r.value.steps),f=0,g=[];c&&(f=r.value.steps.slice(c.index).length-1),l=l.replace("%v",i.toFixed(f));for(const O of t.devices)g=O.split(":"),RegExp(g[0]).test(l)&&(l=l.replace(g[0],g[1]));clearTimeout(v),v=setTimeout(()=>{n.request("text",l)},500)}return(i,l)=>{const c=h("v-slider");return p(),D(c,{modelValue:o.value,"onUpdate:modelValue":[l[0]||(l[0]=f=>o.value=f),l[1]||(l[1]=f=>a(f))],min:r.value.min,max:r.value.max,step:r.value.steps,reverse:r.value.reverse,direction:r.value.vertical?"vertical":"horizontal","track-size":r.value.size,color:r.value.color,"hide-details":"","thumb-label":""},{"thumb-label":w(({modelValue:f})=>[X("div",et,V(f),1)]),_:1},8,["modelValue","min","max","step","reverse","direction","track-size","color"])}}},nt={__name:"PanelMainImage",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Q(),o=q(!1),d=L(()=>n.handleDefs(t.el.image,["source","height"],["",null]));return(r,v)=>{const a=h("v-skeleton-loader"),i=h("v-img");return p(),A(Z,null,[o.value?C("",!0):(p(),D(a,{key:0,type:"image"})),S(i,{src:d.value.source,height:d.value.height,onLoad:v[0]||(v[0]=l=>o.value=!0)},null,8,["src","height"])],64)}}},at={__name:"PanelMainMenu",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Q(),o=q([]);ae(t.el,a=>{r()});const d=L(()=>{let a=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["mdi-dots-vertical",!1,"","text"]);return a.icon&&(a.icon=n.getIcon(a.icon,t.iconmap)),a});async function r(){let a=n.handleDefs(t.el.menu,["name","cmd","convert"],["","",null],!0,","),i,l,c;o.value=[];for(const f of a){i=/^get/.test(f.name)?await v(f.name):f.name;for(const g of[",","|",`
`])RegExp(g).test(i)&&(l=g);for(const g of i.split(l))g&&(c=g,/%v/.test(f.cmd)&&f.convert==="regExp"&&(c=RegExp(g.replace(/[^a-z,^A-Z]/g,"."))),o.value.push({name:g,cmd:f.cmd.replace(/%v/g,c)}))}}async function v(a){let i=[];for(const l of t.devices)i=l.split(":"),RegExp(i[0]).test(a)&&(a=a.replace(i[0],i[1]));return n.request("text",a)}return r(),(a,i)=>{const l=h("v-icon"),c=h("v-btn"),f=h("v-list-item-title"),g=h("v-list-item"),O=h("v-list"),b=h("v-menu");return p(),D(b,null,{activator:w(({props:_})=>[S(c,ie(_,{icon:"",variant:d.value.variant,disabled:d.value.disabled||o.value.length<1,color:d.value.color,class:"my-2"}),{default:w(()=>[S(l,{size:"large"},{default:w(()=>[J(V(d.value.icon),1)]),_:1})]),_:2},1040,["variant","disabled","color"])]),default:w(()=>[S(O,null,{default:w(()=>[(p(!0),A(Z,null,he(o.value,(_,m)=>(p(),D(g,{key:m,value:m,onClick:u=>v(_.cmd)},{default:w(()=>[S(f,null,{default:w(()=>[J(V(_.name),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})}}};var xe=null;function it(e){return xe||(xe=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),xe(e)}var be=null;function ot(e){be||(be=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),be(e)}function rt(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function fe(e,t){t===void 0&&(t={});var n=document.createElement(e);return Object.keys(t).forEach(function(o){n[o]=t[o]}),n}function Te(e,t,n){var o=window.getComputedStyle(e,null)||{display:"none"};return o[t]}function we(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(Te(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var lt='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',ze=0,_e=null;function st(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=dt.bind(e));var n=e.__resize_listeners__;if(!n){if(e.__resize_listeners__=[],window.ResizeObserver){var o=e.offsetWidth,d=e.offsetHeight,r=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===o&&e.offsetHeight===d)||ge(e)}),v=we(e),a=v.detached,i=v.rendered;e.__resize_observer_triggered__=a===!1&&i===!1,e.__resize_observer__=r,r.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){ge(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(ze||(_e=rt(lt)),vt(e),e.__resize_rendered__=we(e).rendered,window.MutationObserver){var l=new MutationObserver(e.__resize_mutation_handler__);l.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=l}}e.__resize_listeners__.push(t),ze++}function ut(e,t){var n=e.__resize_listeners__;if(n){if(t&&n.splice(n.indexOf(t),1),!n.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",Se),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--ze&&_e&&_e.parentNode.removeChild(_e)}}function ct(e){var t=e.__resize_last__,n=t.width,o=t.height,d=e.offsetWidth,r=e.offsetHeight;return d!==n||r!==o?{width:d,height:r}:null}function dt(){var e=we(this),t=e.rendered,n=e.detached;t!==this.__resize_rendered__&&(!n&&this.__resize_triggers__&&(Ce(this),this.addEventListener("scroll",Se,!0)),this.__resize_rendered__=t,ge(this))}function Se(){var e=this;Ce(this),this.__resize_raf__&&ot(this.__resize_raf__),this.__resize_raf__=it(function(){var t=ct(e);t&&(e.__resize_last__=t,ge(e))})}function ge(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function vt(e){var t=Te(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var n=fe("div",{className:"resize-triggers"}),o=fe("div",{className:"resize-expand-trigger"}),d=fe("div"),r=fe("div",{className:"resize-contract-trigger"});o.appendChild(d),n.appendChild(o),n.appendChild(r),e.appendChild(n),e.__resize_triggers__={triggers:n,expand:o,expandChild:d,contract:r},Ce(e),e.addEventListener("scroll",Se,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function Ce(e){var t=e.__resize_triggers__,n=t.expand,o=t.expandChild,d=t.contract,r=d.scrollWidth,v=d.scrollHeight,a=n.offsetWidth,i=n.offsetHeight,l=n.scrollWidth,c=n.scrollHeight;d.scrollLeft=r,d.scrollTop=v,o.style.width=a+1+"px",o.style.height=i+1+"px",n.scrollLeft=l,n.scrollTop=c}var K=function(){return K=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var d in t=arguments[n])Object.prototype.hasOwnProperty.call(t,d)&&(e[d]=t[d]);return e},K.apply(this,arguments)};var ft=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function mt(e){return t=Object.create(null),ft.forEach(function(n){t[n]=function(o){return function(){for(var d=[],r=0;r<arguments.length;r++)d[r]=arguments[r];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[o].apply(e.value,d)}}(n)}),t;var t}var pt={autoresize:[Boolean,Object]},_t=/^on[^a-z]/,Le=function(e){return _t.test(e)};function me(e,t){var n=Be(e)?W(e):e;return n&&typeof n=="object"&&"value"in n?n.value||t:n||t}var ht="ecLoadingOptions",gt={loading:Boolean,loadingOptions:Object},re=null,Pe="x-vue-echarts",De=[],le=[];(function(e,t){if(e&&typeof document<"u"){var n,o=t.prepend===!0?"prepend":"append",d=t.singleTag===!0,r=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(d){var v=De.indexOf(r);v===-1&&(v=De.push(r)-1,le[v]={}),n=le[v]&&le[v][o]?le[v][o]:le[v][o]=a()}else n=a();e.charCodeAt(0)===65279&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function a(){var i=document.createElement("style");if(i.setAttribute("type","text/css"),t.attributes)for(var l=Object.keys(t.attributes),c=0;c<l.length;c++)i.setAttribute(l[c],t.attributes[l[c]]);var f=o==="prepend"?"afterbegin":"beforeend";return r.insertAdjacentElement(f,i),i}})(`x-vue-echarts{display:block;position:relative;width:100%;height:100%;min-width:0}
.vue-echarts-inner{position:absolute;top:0;right:0;bottom:0;left:0}
`,{});var xt=function(){if(re!=null)return re;if(typeof HTMLElement>"u"||typeof customElements>"u")return re=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)(Pe)}catch{return re=!1}return re=!0}(),bt="ecTheme",yt="ecInitOptions",wt="ecUpdateOptions",Re=/(^&?~?!?)native:/,zt=Ie({name:"echarts",props:K(K({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},pt),gt),emits:{},inheritAttrs:!1,setup:function(e,t){var n=t.attrs,o=ve(),d=ve(),r=ve(),v=ve(),a=de(bt,null),i=de(yt,null),l=de(wt,null),c=Ue(e),f=c.autoresize,g=c.manualUpdate,O=c.loading,b=c.loadingOptions,_=L(function(){return v.value||e.option||null}),m=L(function(){return e.theme||me(a,{})}),u=L(function(){return e.initOptions||me(i,{})}),M=L(function(){return e.updateOptions||me(l,{})}),x=L(function(){return function(y){var k={};for(var j in y)Le(j)||(k[j]=y[j]);return k}(n)}),R={},E=He().proxy.$listeners,H={};function N(y){if(d.value){var k=r.value=Ne(d.value,m.value,u.value);e.group&&(k.group=e.group),Object.keys(H).forEach(function(F){var P=H[F];if(P){var I=F.toLowerCase();I.charAt(0)==="~"&&(I=I.substring(1),P.__once__=!0);var ee=k;if(I.indexOf("zr:")===0&&(ee=k.getZr(),I=I.substring(3)),P.__once__){delete P.__once__;var Y=P;P=function(){for(var te=[],$=0;$<arguments.length;$++)te[$]=arguments[$];Y.apply(void 0,te),ee.off(I,P)}}ee.on(I,P)}}),f.value?qe(function(){k&&!k.isDisposed()&&k.resize(),j()}):j()}function j(){var F=y||_.value;F&&k.setOption(F,M.value)}}function z(){r.value&&(r.value.dispose(),r.value=void 0)}E?Object.keys(E).forEach(function(y){Re.test(y)?R[y.replace(Re,"$1")]=E[y]:H[y]=E[y]}):Object.keys(n).filter(function(y){return Le(y)}).forEach(function(y){var k=y.charAt(2).toLowerCase()+y.slice(3);if(k.indexOf("native:")!==0)k.substring(k.length-4)==="Once"&&(k="~".concat(k.substring(0,k.length-4))),H[k]=n[y];else{var j="on".concat(k.charAt(7).toUpperCase()).concat(k.slice(8));R[j]=n[y]}});var s=null;ae(g,function(y){typeof s=="function"&&(s(),s=null),y||(s=ae(function(){return e.option},function(k,j){k&&(r.value?r.value.setOption(k,K({notMerge:k!==j},M.value)):N())},{deep:!0}))},{immediate:!0}),ae([m,u],function(){z(),N()},{deep:!0}),Ee(function(){e.group&&r.value&&(r.value.group=e.group)});var T=mt(r);return function(y,k,j){var F=de(ht,{}),P=L(function(){return K(K({},me(F,{})),j==null?void 0:j.value)});Ee(function(){var I=y.value;I&&(k.value?I.showLoading(P.value):I.hideLoading())})}(r,O,b),function(y,k,j){var F=null;ae([j,y,k],function(P,I,ee){var Y=P[0],te=P[1],$=P[2];if(Y&&te&&$){var se=$===!0?{}:$,ue=se.throttle,G=ue===void 0?100:ue,oe=se.onResize,ce=function(){te.resize(),oe==null||oe()};F=G?$e(ce,G):ce,st(Y,F)}ee(function(){Y&&F&&ut(Y,F)})})}(r,f,d),ke(function(){N()}),Ve(function(){xt&&o.value?o.value.__dispose=z:z()}),K({chart:r,root:o,inner:d,setOption:function(y,k){e.manualUpdate&&(v.value=y),r.value?r.value.setOption(y,k||{}):N(y)},nonEventAttrs:x,nativeListeners:R},T)},render:function(){var e=K(K({},this.nonEventAttrs),this.nativeListeners);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",Oe(Pe,e,[Oe("div",{ref:"inner",class:"vue-echarts-inner"})])}});const kt={key:0,class:"mx-4 my-4 text-right"},St={__name:"PanelMainChart",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Q(),o=Ke(),{mobile:d}=We(),r=Je(),v=q({}),a=q({from:null,to:null,fromMenu:!1,toMenu:!1,loaded:!1});let i=[];const l=L(()=>(O(),"height: "+(/=maximized$/.test(n.app.currentView)?window.innerHeight-250+"px":t.height)));function c(b){return r.d(b,{dateStyle:d.value?"short":"long"})}function f(b,_){let m;return a.value.from&&_&&(m=a.value.from),a.value.to&&!_&&(m=a.value.to),!m&&!isNaN(b)&&(m=(u=>new Date(u.setDate(u.getDate()+(Number(b)||0))))(new Date)),m||(m=new Date(/.*T.*/.test(b)?b:b+"T00:00:00")),!a.value.from&&_&&(a.value.from=m),!a.value.to&&!_&&(a.value.to=m),m=new Date(m.getTime()-m.getTimezoneOffset()*60*1e3),m.toISOString().split("T")[0]}async function g(){let b=n.handleDefs(t.el.serie,["data","name","digits","suffix","type"],[null,"",0,"","line"],!0),_,m,u=[],M,x,R,E,H,N=[];if(b.length>0)for(const z of b){if(/^get.*/.test(z.data)){H="time",_=z.data.split(" ");for(const s of t.devices)s.split(":")[0]===_[1]&&(_[1]=s.split(":")[1]);if(_[4]=f(_[4],!0),_[5]=f(_[5],!1),m=await n.request("text",_.join(" ")),E=[],u=m.split(`
`),u.length>0)for(const s of u)M=s.split(" "),M.length>1&&(x=new Date(M[0].replace("_","T")),R=parseFloat(M[1]).toFixed(z.digits),E.push([x,R]))}else/^\[.*\]/.test(z.data)?E=n.stringToJson(z.data):E=[n.replacer("%n("+z.digits+")",z.data,!0)];N.push({xAxisType:H,type:z.type,name:z.name,digits:z.digits,suffix:z.suffix,data:E})}return N}async function O(){let b={tooltip:{trigger:"axis"},legend:{data:[],bottom:10},backgroundColor:"rgba(255, 255, 255, 0)",grid:{top:30,bottom:60,left:60,right:60},animationDuration:300,series:[],yAxis:[],xAxis:{}},_=JSON.parse(JSON.stringify(n.getEl(t.el,["options"])||{})),m=JSON.parse(JSON.stringify(n.getEl(t.el,["options2"])||{})),u=Object.assign(b,/=maximized$/.test(n.app.currentView)&&Object.keys(m).length>0?m:_),M;a.value.fromMenu=!1,a.value.toMenu=!1,a.value.loaded=!1,i=await g();for(const[x,R]of Object.entries(i))M={formatter:E=>E.toLocaleString(r.locale.value,{minimumFractionDigits:R.digits,maximumFractionDigits:R.digits})+R.suffix},u.series[x]||(u.series[x]={}),u.yAxis[x]||(u.yAxis[x]={}),u.legend.data||(u.legend.data=[]),u.xAxis.type||(u.xAxis.type=R.xAxisType),u.yAxis[x].type||(u.yAxis[x].type="value"),u.yAxis[x].axisLabel||(u.yAxis[x].axisLabel={}),u.yAxis[x].axisLabel.formatter||(u.yAxis[x].axisLabel.formatter=M.formatter),u.legend.data[x]||(u.legend.data[x]=R.name),u.series[x].name||(u.series[x].name=R.name),u.series[x].type||(u.series[x].type=R.type),u.series[x].data||(u.series[x].data=R.data),u.series[x].detail||(u.series[x].detail={}),u.series[x].detail.formatter||(u.series[x].detail.formatter=M.formatter),u.series[x].tooltip||(u.series[x].tooltip={}),u.series[x].tooltip.valueFormatter||(u.series[x].tooltip.valueFormatter=M.formatter);n.log(7,"Chartdata chart.loaded.",u),v.value=Object.assign({},u),a.value.loaded=!0}return(b,_)=>{const m=h("v-btn"),u=h("v-date-picker"),M=h("v-locale-provider"),x=h("v-menu"),R=h("v-skeleton-loader");return p(),A(Z,null,[/=maximized$/.test(W(n).app.currentView)?(p(),A("div",kt,[S(x,{modelValue:a.value.fromMenu,"onUpdate:modelValue":_[2]||(_[2]=E=>a.value.fromMenu=E),"close-on-content-click":!1},{activator:w(({props:E})=>[S(m,ie(E,{variant:"outlined","append-icon":"mdi-calendar",class:"mr-2"}),{default:w(()=>[J(V(c(a.value.from)),1)]),_:2},1040)]),default:w(()=>[S(M,{locale:W(r).locale.value},{default:w(()=>[S(u,{modelValue:a.value.from,"onUpdate:modelValue":[_[0]||(_[0]=E=>a.value.from=E),_[1]||(_[1]=E=>O())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"]),J(" - "),S(x,{modelValue:a.value.toMenu,"onUpdate:modelValue":_[5]||(_[5]=E=>a.value.toMenu=E),"close-on-content-click":!1},{activator:w(({props:E})=>[S(m,ie(E,{variant:"outlined","append-icon":"mdi-calendar",class:"ml-2"}),{default:w(()=>[J(V(c(a.value.to)),1)]),_:2},1040)]),default:w(()=>[S(M,{locale:W(r).locale.value},{default:w(()=>[S(u,{modelValue:a.value.to,"onUpdate:modelValue":[_[3]||(_[3]=E=>a.value.to=E),_[4]||(_[4]=E=>O())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"])])):C("",!0),X("div",{style:pe(l.value)},[a.value.loaded?C("",!0):(p(),D(R,{key:0,type:"text, image, text"})),a.value.loaded?(p(),D(W(zt),{key:1,option:v.value,theme:W(o).global.name.value==="dark"?"dark":"light",autoresize:""},null,8,["option","theme"])):C("",!0)],4)],64)}}},Ct=180/Math.PI,Ae=e=>{const t=e%360;return t<0?360+t:t},Et=({x:e,y:t},n)=>{const o=n.left+n.width/2,d=n.top+n.height/2;return Math.atan2(t-d,e-o)*Ct},ye=()=>{};class Ot{constructor(t,n){this.active=!1,this.element=t,this.element.style.willChange="transform",this.initOptions(n),this.updateCSS(),this.bindHandlers(),this.addListeners()}get angle(){return this._angle}set angle(t){this._angle!==t&&(this._angle=Ae(t),this.updateCSS())}initOptions(t){t=t||{},this.onRotate=t.onRotate||ye,this.onDragStart=t.onDragStart||ye,this.onDragStop=t.onDragStop||ye,this._angle=t.angle||0}bindHandlers(){this.onRotationStart=this.onRotationStart.bind(this),this.onRotated=this.onRotated.bind(this),this.onRotationStop=this.onRotationStop.bind(this)}addListeners(){this.element.addEventListener("touchstart",this.onRotationStart,{passive:!0}),document.addEventListener("touchmove",this.onRotated,{passive:!1}),document.addEventListener("touchend",this.onRotationStop,{passive:!0}),document.addEventListener("touchcancel",this.onRotationStop,{passive:!0}),this.element.addEventListener("mousedown",this.onRotationStart,{passive:!0}),document.addEventListener("mousemove",this.onRotated,{passive:!1}),document.addEventListener("mouseup",this.onRotationStop,{passive:!0}),document.addEventListener("mouseleave",this.onRotationStop,{passive:!1})}removeListeners(){this.element.removeEventListener("touchstart",this.onRotationStart),document.removeEventListener("touchmove",this.onRotated),document.removeEventListener("touchend",this.onRotationStop),document.removeEventListener("touchcancel",this.onRotationStop),this.element.removeEventListener("mousedown",this.onRotationStart),document.removeEventListener("mousemove",this.onRotated),document.removeEventListener("mouseup",this.onRotationStop),document.removeEventListener("mouseleave",this.onRotationStop)}destroy(){this.onRotationStop(),this.removeListeners()}onRotationStart(t){(t.type==="touchstart"||t.button===0)&&(this.active=!0,this.onDragStart(t),this.setAngleFromEvent(t))}onRotationStop(){this.active&&(this.active=!1,this.onDragStop()),this.active=!1}onRotated(t){this.active&&(t.preventDefault(),this.setAngleFromEvent(t))}setAngleFromEvent(t){const n=t.targetTouches?t.targetTouches[0]:t,o=Et({x:n.clientX,y:n.clientY},this.element.getBoundingClientRect());this._angle=Ae(o+90),this.updateCSS(),this.onRotate(this._angle)}updateCSS(){this.element.style.transform="rotate("+this._angle+"deg)"}}const Lt=(e,t)=>{const n=e.__vccOpts||e;for(const[o,d]of t)n[o]=d;return n},Dt=["red","yellow","green","cyan","blue","magenta","red"],Me={ArrowUp:(e,t)=>e+t,ArrowRight:(e,t)=>e+t,ArrowDown:(e,t)=>e-t,ArrowLeft:(e,t)=>e-t,PageUp:(e,t)=>e+t*10,PageDown:(e,t)=>e-t*10,Home:()=>0,End:()=>359},Rt={name:"ColorPicker",emits:["select","input","change"],props:{hue:{default:0},saturation:{default:100},luminosity:{default:50},alpha:{default:1},step:{default:1},mouseScroll:{default:!1},variant:{default:"collapsible"},disabled:{default:!1},initiallyCollapsed:{default:!1},ariaLabel:{default:"color picker"},ariaRoledescription:{default:"radial slider"},ariaValuetext:{default:""},ariaLabelColorWell:{default:"color well"}},setup(e,{emit:t}){q(null);const n=q(null);let o=null;const d=e.hue+"deg",r=q(e.hue),v=q(!e.initiallyCollapsed),a=q(!e.initiallyCollapsed),i=q(!1),l=q(!1),c=L(()=>`hsla(${r.value}, ${e.saturation}%, ${e.luminosity}%, ${e.alpha})`),f=L(()=>Dt[Math.round(r.value/60)]);return ae(()=>e.hue,u=>{r.value=u,o.angle=u}),ke(()=>{o=new Ot(n.value,{angle:r.value,onRotate(u){r.value=u,t("input",r.value)},onDragStop(){t("change",r.value)}})}),Ve(()=>{o.destroy(),o=null}),{rcp:o,rotator:n,initialAngle:d,angle:r,isPaletteIn:v,isKnobIn:a,isRippling:l,isPressed:i,color:c,valuetext:f,onKeyDown:u=>{e.disabled||i.value||!a.value||!(u.key in Me)||(u.preventDefault(),o.angle=Me[u.key](o.angle,e.step),r.value=o.angle,t("input",r.value),t("change",r.value))},onScroll:u=>{i.value||!a.value||(u.preventDefault(),u.deltaY>0?o.angle+=e.step:o.angle-=e.step,r.value=o.angle,t("input",r.value),t("change",r.value))},selectColor:()=>{i.value=!0,v.value&&a.value?(t("select",r.value),l.value=!0):v.value=!0},togglePicker:()=>{e.variant!=="persistent"&&(a.value?a.value=!1:(a.value=!0,v.value=!0)),l.value=!1,i.value=!1},hidePalette:()=>{a.value||(v.value=!1)}}}},At=["aria-roledescription","aria-label","aria-expanded","aria-valuenow","aria-valuetext","aria-disabled","tabindex"],Mt=X("div",{class:"rcp__palette"},null,-1),Vt=["aria-label","disabled","tabindex"];function Tt(e,t,n,o,d,r){return p(),A("div",{role:"slider","aria-roledescription":n.ariaRoledescription,"aria-label":n.ariaLabel,"aria-expanded":o.isPaletteIn,"aria-valuemin":"0","aria-valuemax":"359","aria-valuenow":o.angle,"aria-valuetext":n.ariaValuetext||o.valuetext,"aria-disabled":n.disabled,class:"rcp",tabindex:n.disabled?-1:0,style:pe({"--rcp-initial-angle":o.initialAngle}),onKeyup:t[3]||(t[3]=Ze((...v)=>o.selectColor&&o.selectColor(...v),["enter"])),onKeydown:t[4]||(t[4]=(...v)=>o.onKeyDown&&o.onKeyDown(...v))},[Mt,X("div",ie({class:"rcp__rotator",style:{"pointer-events":n.disabled||o.isPressed||!o.isKnobIn?"none":null}},Ge(n.mouseScroll?{wheel:o.onScroll}:{},!0),{ref:"rotator"}),[X("div",{class:U(["rcp__knob",o.isKnobIn?"in":"out"]),onTransitionend:t[0]||(t[0]=(...v)=>o.hidePalette&&o.hidePalette(...v))},null,34)],16),X("div",{class:U(["rcp__ripple",{rippling:o.isRippling}]),style:pe({borderColor:o.color})},null,6),X("button",{type:"button",class:U(["rcp__well",{pressed:o.isPressed}]),"aria-label":n.ariaLabelColorWell,disabled:n.disabled,tabindex:n.disabled?-1:0,style:pe({backgroundColor:o.color}),onAnimationend:t[1]||(t[1]=(...v)=>o.togglePicker&&o.togglePicker(...v)),onClick:t[2]||(t[2]=(...v)=>o.selectColor&&o.selectColor(...v))},null,46,Vt)],44,At)}const Pt=Lt(Rt,[["render",Tt]]),jt={class:"mt-4 mb-2"},Ft={__name:"PanelMainColorpicker",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Q(),o=L(()=>n.handleDefs(t.el.picker,["cmd","current"],["",!1]));function d(a){let i=r(a,50,100),l=o.value.cmd,c=[];l=l.replace("%v",i);for(const f of t.devices)c=f.split(":"),RegExp(c[0]).test(l)&&(l=l.replace(c[0],c[1]));n.request("text",l)}function r(a,i,l){i/=100;const c=l*Math.min(i,1-i)/100,f=g=>{const O=(g+a/30)%12,b=i-c*Math.max(Math.min(O-3,9-O,1),-1);return Math.round(255*b).toString(16).padStart(2,"0")};return`${f(0)}${f(8)}${f(4)}`}function v(a){a.split(" ").length>1&&(a=a.split(" ").slice(-1)[0]),a=a.replace(/^#/,"");let i=parseInt(a,16),l=i>>16&255,c=i>>8&255,f=i&255;l/=255,c/=255,f/=255;let g=Math.max(l,c,f),O=Math.min(l,c,f),b=g-O,_=(g+O)/2,m=0,u=0;return b!==0&&(g===l?m=((c-f)/b+(c<f?6:0))%6:g===c?m=((f-l)/b+2)%6:m=((l-c)/b+4)%6,m=m*60,u=b/(1-Math.abs(2*_-1))),u=Math.round(u*100),_=Math.round(_*100),{hue:m,saturation:u,luminosity:_}}return(a,i)=>(p(),A("div",jt,[S(W(Pt),ie(v(o.value.current),{variant:"persistent",onChange:i[0]||(i[0]=l=>d(l))}),null,16)]))}},It={__name:"PanelMain",props:{main:Object,levels:Array,iconmap:Object,devices:Object},setup(e){const t=Q();function n(a,i){return t.handleDefs(a[i].size,["size"],[!1]).size}function o(a){let i="";return["info"].indexOf(a)!==-1&&(i="mx-2"),i}function d(a,i){return a[i]?t.handleDefs(a[i].divider,["show"],[!1]).show:!1}function r(a){return a.level?t.handleDefs(a.level.height,["height"],["64px"]).height:"64px"}function v(a){if(a==="info")return Ye;if(a==="btn")return Xe;if(a==="slider")return tt;if(a==="image")return nt;if(a==="menu")return at;if(a==="chart")return St;if(a==="colorpicker")return Ft}return(a,i)=>{const l=h("v-sheet"),c=h("v-col"),f=h("v-divider"),g=h("v-row"),O=h("v-expand-transition");return p(!0),A(Z,null,he(e.main,(b,_)=>(p(),A("div",{key:_},[S(O,null,{default:w(()=>[e.levels.indexOf(_)!==-1?(p(),D(g,{key:0,"no-gutters":"",class:"text-center align-center"},{default:w(()=>[S(l,{height:r(b,"level")},null,8,["height"]),(p(),A(Z,null,he(["left1","left2","mid","right1","right2"],m=>(p(),A(Z,{key:m},[b.level[m]?(p(),D(c,{key:0,cols:n(b,m),class:U(o(b.level[m]))},{default:w(()=>[(p(),D(Qe(v(b.level[m])),{el:b[m],iconmap:e.iconmap,devices:e.devices,height:r(b,"level")},null,8,["el","iconmap","devices","height"]))]),_:2},1032,["cols","class"])):C("",!0),d(b,m)?(p(),D(f,{key:1,vertical:""})):C("",!0)],64))),64)),d(b,"level")?(p(),D(f,{key:0})):C("",!0)]),_:2},1024)):C("",!0)]),_:2},1024)]))),128)}}},Ut={key:0},qt={__name:"PanelCard",props:{panel:Object},setup(e){const t=e,n=Q();let o=n.thread();ke(()=>n.thread(o));function d(z){let s=n.handleDefs(t.panel.status[z],["level","color","min","max","reverse"],[0,"success",0,100,!1]);return s.level=Math.round((s.level-s.min)/(s.max-s.min)*100),s}const r=L(()=>d("bar")),v=L(()=>d("bar2")),a=L(()=>n.handleDefs(t.panel.status.imageUrl,["url"],[""])),i=L(()=>n.handleDefs(t.panel.panel.sortby,["sortby"],[null])),l=L(()=>n.handleDefs(t.panel.status.title,["title"],[""])),c=q(n.handleDefs(t.panel.panel.expandable,["expandable","expanded","maximizable"],[!1,!1,!1]));ae(t.panel.main,z=>{let s=f(z);c.value.activeLevels.join("-")!==s.join("-")&&(c.value.activeLevels=s,g(!0))});function f(z){let s=[];for(const[T,y]of Object.entries(z))n.handleDefs(y.level.show,["show"],[!0]).show&&s.push(Number(T));return s}function g(z){let s=c.value,T;z?(s.activeLevels=f(t.panel.main),/=maximized$/.test(n.app.currentView)&&(s.expanded=!0)):(s.expandable&&(s.expanded=!s.expanded),s.maximizable&&(s.expanded?ne.push({name:"devices",params:{view:"panel="+t.panel.name+"=maximized"},query:ne.currentRoute.value.query}):(n.app.currentView=n.app.currentView.replace(/=maximized$/,""),ne.back()))),s.expanded?s.levels=s.activeLevels:s.expandable||z?s.levels=[s.activeLevels[0]]:(T=s.activeLevels.indexOf(s.levels[0]),s.levels=[s.activeLevels[T+1]>=0?s.activeLevels[T+1]:s.activeLevels[0]]),s.activeLevels.length>1||s.maximizable?s.icon=s.expandable?s.expanded?"mdi-arrow-collapse":"mdi-arrow-expand":s.expanded?"":"mdi-swap-vertical":s.icon=""}function O(z){let s=n.app.config.panels.map(k=>k.name).indexOf(z),T,y;if(s!==-1&&(y=n.app.config.panels[s].template,T=n.app.config.templates.map(k=>k.name).indexOf(y),T!==-1&&!n.app.config.templates[T].dist))return y}function b(z,s){ne.push({name:"settings",params:{tab:s,item:z},query:ne.currentRoute.value.query})}function _(z){window.open(n.createURL("?detail="+z),"_self")}function m(z){let s=n.handleDefs(t.panel.info[z],["text","icon","color"],["","",""]);return s.icon&&(s.icon=n.getIcon(s.icon,t.panel.panel.iconmap)),s}function u(z){let s=["left1","left2","mid1","mid2","right1","right2"],T=m(z);return m(s[s.indexOf(z)-1]).text&&T.text&&!T.icon?"ml-1 text-truncate":T.text?"text-truncate":""}const M=L(()=>m("left1")),x=L(()=>m("left2")),R=L(()=>m("mid1")),E=L(()=>m("mid2")),H=L(()=>m("right1")),N=L(()=>m("right2"));return g(!0),(z,s)=>{const T=h("v-progress-linear"),y=h("v-col"),k=h("v-row"),j=h("v-toolbar-title"),F=h("v-btn"),P=h("v-list-item"),I=h("v-divider"),ee=h("v-list"),Y=h("v-menu"),te=h("v-toolbar"),$=h("v-img"),se=h("v-sheet"),ue=h("v-card-text"),G=h("v-icon"),oe=h("v-spacer"),ce=h("v-system-bar"),je=h("v-layout"),Fe=h("v-card");return W(n).app.isReady?(p(),D(Fe,{key:0,variant:"tonal"},{default:w(()=>[S(k,{"no-gutters":""},{default:w(()=>[e.panel.status.bar?(p(),D(y,{key:0},{default:w(()=>[S(T,{height:"7",modelValue:r.value.level,"onUpdate:modelValue":s[0]||(s[0]=B=>r.value.level=B),color:r.value.color,reverse:r.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):C("",!0),e.panel.status.bar2?(p(),D(y,{key:1},{default:w(()=>[S(T,{height:"7",modelValue:v.value.level,"onUpdate:modelValue":s[1]||(s[1]=B=>v.value.level=B),color:v.value.color,reverse:v.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):C("",!0)]),_:1}),S(se,{color:"primary"},{default:w(()=>[S($,{src:a.value.url,gradient:a.value.url?W(n).app.header.imageGradient:"",height:"48",cover:""},{default:w(()=>[S(te,{color:"transparent",density:"compact",class:"pr-1"},{append:w(()=>[W(n).app.settings.loglevel>6?(p(),A("div",Ut,[J(V(i.value.sortby)+" ",1),S(Y,null,{activator:w(({props:B})=>[S(F,ie({icon:"mdi-dots-vertical",density:"compact"},B),null,16)]),default:w(()=>[S(ee,{density:"compact"},{default:w(()=>[O(e.panel.name)?(p(),D(P,{key:"template",title:"Template","prepend-icon":"mdi-application-edit-outline",onClick:s[2]||(s[2]=B=>b(O(e.panel.name),"templates"))})):C("",!0),S(P,{key:"panel",title:"Panel","prepend-icon":"mdi-pencil",onClick:s[3]||(s[3]=B=>b(e.panel.name,"panels"))}),S(I),(p(!0),A(Z,null,he(e.panel.panel.devices,B=>(p(),D(P,{key:B.split(":")[0],title:B.split(":")[1],"prepend-icon":"mdi-link",onClick:Ht=>_(B.split(":")[1])},null,8,["title","onClick"]))),128))]),_:1})]),_:1})])):C("",!0),c.value.icon?(p(),D(F,{key:1,icon:c.value.icon,size:"small",variant:"plain",density:"compact",onClick:s[4]||(s[4]=B=>g())},null,8,["icon"])):C("",!0)]),default:w(()=>[S(j,{class:"text-truncate"},{default:w(()=>[J(V(l.value.title),1)]),_:1})]),_:1})]),_:1},8,["src","gradient"])]),_:1}),S(It,{main:e.panel.main,levels:c.value.levels,iconmap:e.panel.panel.iconmap,devices:e.panel.panel.devices},null,8,["main","levels","iconmap","devices"]),t.panel.internals?(p(),D(ue,{key:0},{default:w(()=>[J(V(t.panel.internals),1)]),_:1})):C("",!0),S(je,{style:{height:"24px"}},{default:w(()=>[S(ce,{color:"secondary"},{default:w(()=>[M.value.icon?(p(),D(G,{key:0,icon:M.value.icon,color:M.value.color},null,8,["icon","color"])):C("",!0),M.value.text?(p(),A("span",{key:1,class:U(u("left1"))},V(M.value.text),3)):C("",!0),x.value.icon?(p(),D(G,{key:2,icon:x.value.icon,color:x.value.color},null,8,["icon","color"])):C("",!0),x.value.text?(p(),A("span",{key:3,class:U(u("left2"))},V(x.value.text),3)):C("",!0),S(oe),R.value.icon?(p(),D(G,{key:4,icon:R.value.icon,color:R.value.color},null,8,["icon","color"])):C("",!0),R.value.text?(p(),A("span",{key:5,class:U(u("mid1"))},V(R.value.text),3)):C("",!0),E.value.icon?(p(),D(G,{key:6,icon:E.value.icon,color:E.value.color},null,8,["icon","color"])):C("",!0),E.value.text?(p(),A("span",{key:7,class:U(u("mid2"))},V(E.value.text),3)):C("",!0),S(oe),H.value.icon?(p(),D(G,{key:8,icon:H.value.icon,color:H.value.color},null,8,["icon","color"])):C("",!0),H.value.text?(p(),A("span",{key:9,class:U(u("right1"))},V(H.value.text),3)):C("",!0),N.value.icon?(p(),D(G,{key:10,icon:N.value.icon,color:N.value.color},null,8,["icon","color"])):C("",!0),N.value.text?(p(),A("span",{key:11,class:U(u("right2"))},V(N.value.text),3)):C("",!0)]),_:1})]),_:1})]),_:1})):C("",!0)}}};export{qt as _};
