import{u as G,c as w,r as z,o as f,b as P,y as ee,t as V,k,a as D,w as b,j as J,z as De,F as Y,e as y,A as ze,f as I,q as ne,d as _e,l as Re,B as re,C as le,D as Me,E as Te,s as te,G as we,x as pe,H as Oe,m as Se,I as Pe,J as Ve,h as K,K as je,L as Fe,i as Ie,p as Ne,M as Ue,N as He,O as qe,P as Be}from"./index-dd3a22d5.js";const We={__name:"PanelMainInfo",props:{el:Object,iconmap:Array,devices:Object,height:String},setup(e){const t=e,n=G(),l=w(()=>n.handleDefs(t.el.text,["text","format"],["",!t.el.text2&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),u=w(()=>n.handleDefs(t.el.text2,["text","format"],["",t.el.text&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),o=w(()=>n.handleDefs(t.el.text3,["text","format"],["","text-caption"])),s=w(()=>{let a=n.handleDefs(t.el.icon,["icon","color","size"],["","","x-large"]);return a.icon&&(a.icon=n.getIcon(a.icon,t.iconmap)),a}),r=w(()=>{let a=n.handleDefs(t.el.status,["level","color","min","max","reverse","linear"],[0,"success",0,100,!1,!1]);return a.level=Math.round((a.level-a.min)/(a.max-a.min)*100),a.reverse=!!a.reverse,a});return(a,i)=>{const c=z("v-icon"),d=z("v-progress-circular"),C=z("v-progress-linear");return f(),P(Y,null,[e.el.text?(f(),P("div",{key:0,class:ee(l.value.format)},V(l.value.text),3)):k("",!0),e.el.icon?(f(),D(c,{key:1,color:s.value.color,size:s.value.size},{default:b(()=>[J(V(s.value.icon),1)]),_:1},8,["color","size"])):k("",!0),e.el.status&&!r.value.linear?(f(),D(d,{key:2,width:"4",modelValue:r.value.level,"onUpdate:modelValue":i[0]||(i[0]=x=>r.value.level=x),color:r.value.color,reverse:r.value.reverse},null,8,["modelValue","color","reverse"])):k("",!0),e.el.status&&r.value.linear?(f(),D(C,{key:3,height:"7",rounded:"",modelValue:r.value.level,"onUpdate:modelValue":i[1]||(i[1]=x=>r.value.level=x),color:r.value.color,reverse:r.value.reverse},null,8,["modelValue","color","reverse"])):k("",!0),De("div",{class:ee(e.el.text2?u.value.format:o.value.format)},[e.el.text2?(f(),P("span",{key:0,class:ee(u.value.format)},V(u.value.text),3)):k("",!0),e.el.text3?(f(),P("span",{key:1,class:ee(o.value.format)},V(o.value.text),3)):k("",!0)],2)],64)}}},Ke={__name:"PanelMainBtn",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=G(),l=w(()=>{let a=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["",!1,"","text"]);return a.icon&&(a.icon=n.getIcon(a.icon,t.iconmap)),a}),u=w(()=>{let a=n.handleDefs(t.el.status,["level","color","min","max","reverse"],[0,"success",0,100,!1]);return a.level=Math.round((a.level-a.min)/(a.max-a.min)*100),a.reverse=!!a.reverse,a}),o={timer:!1,long:!1};function s(a){let i=[],c=a.cmd;if(a.type==="cmd"){for(const d of t.devices)i=d.split(":"),RegExp(i[0]).test(c)&&(c=c.replace(i[0],i[1]));n.request("text",c)}a.type==="route"&&ze.push({name:"devices",params:{view:a.cmd},query:ze.currentRoute.value.query}),a.type==="url"&&window.open(a.cmd,"_self")}function r(a){let i=n.handleDefs(t.el.click,["cmd","type"],["","cmd"]),c=n.handleDefs(t.el.longClick,["cmd","type"],["","cmd"]),d=n.handleDefs(t.el.longRelease,["cmd","type"],["","cmd"]);(a==="touchStart"||a==="mouseStart")&&(o.timer=setTimeout(()=>{o.long=!0,c.cmd&&s(c)},1e3)),(a==="touchEnd"||a==="mouseEnd")&&(o.long?d.cmd&&s(d):i.cmd&&s(i),clearTimeout(o.timer),o.long=!1)}return(a,i)=>{const c=z("v-progress-linear"),d=z("v-icon"),C=z("v-btn");return f(),P(Y,null,[e.el.status?(f(),D(c,{key:0,height:"4",modelValue:u.value.level,"onUpdate:modelValue":i[0]||(i[0]=x=>u.value.level=x),color:u.value.color,reverse:u.value.reverse},null,8,["modelValue","color","reverse"])):k("",!0),y(C,{icon:"",variant:l.value.variant,disabled:l.value.disabled,color:l.value.color,onTouchstart:i[1]||(i[1]=x=>r("touchStart")),onTouchend:i[2]||(i[2]=x=>r("touchEnd")),onMousedown:i[3]||(i[3]=x=>r("mouseStart")),onMouseup:i[4]||(i[4]=x=>r("mouseEnd")),class:"my-2"},{default:b(()=>[y(d,{size:"large"},{default:b(()=>[J(V(l.value.icon),1)]),_:1})]),_:1},8,["variant","disabled","color"])],64)}}},Je={__name:"PanelMainSlider",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=G(),l=I();function u(a){l.value=a}const o=w(()=>{let a=n.handleDefs(t.el.slider,["cmd","current","color","min","max","steps","reverse","size","vertical"],["",0,"",0,100,10,!1,4,!1]);return/%v/.test(a.current)&&(a.current=a.current.replace("%v",l.value)),u(a.current),a});let s=null;function r(a){let i=o.value.cmd,c=/\./.exec(o.value.steps),d=0,C=[];c&&(d=o.value.steps.slice(c.index).length-1),i=i.replace("%v",a.toFixed(d));for(const x of t.devices)C=x.split(":"),RegExp(C[0]).test(i)&&(i=i.replace(C[0],C[1]));clearTimeout(s),s=setTimeout(()=>{n.request("text",i)},500)}return(a,i)=>{const c=z("v-slider");return f(),D(c,{modelValue:l.value,"onUpdate:modelValue":[i[0]||(i[0]=d=>l.value=d),i[1]||(i[1]=d=>r(d))],min:o.value.min,max:o.value.max,step:o.value.steps,reverse:o.value.reverse,direction:o.value.vertical?"vertical":"horizontal","track-size":o.value.size,color:o.value.color,"hide-details":"","thumb-label":""},null,8,["modelValue","min","max","step","reverse","direction","track-size","color"])}}},Ge={__name:"PanelMainImage",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=G(),l=I(!1),u=w(()=>n.handleDefs(t.el.image,["source","height"],["",null]));return(o,s)=>{const r=z("v-skeleton-loader"),a=z("v-img");return f(),P(Y,null,[l.value?k("",!0):(f(),D(r,{key:0,type:"image"})),y(a,{src:u.value.source,height:u.value.height,onLoad:s[0]||(s[0]=i=>l.value=!0)},null,8,["src","height"])],64)}}},Ye={__name:"PanelMainMenu",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=G(),l=w(()=>{let o=[],s=n.handleDefs(t.el.menu,["name","cmd"],["",""],!0,","),r={};for(const a of s)r={name:/:/.test(a.name)?a.name.split(":")[0]:a.name,cmd:/:/.test(a.cmd)?a.cmd.split(":")[1]:a.cmd},o.push(r);return o});function u(o){let s=[];for(const r of t.devices)s=r.split(":"),RegExp(s[0]).test(o)&&(o=o.replace(s[0],s[1]));n.request("text",o)}return(o,s)=>{const r=z("v-icon"),a=z("v-btn"),i=z("v-list-item-title"),c=z("v-list-item"),d=z("v-list"),C=z("v-menu");return f(),D(C,null,{activator:b(({props:x})=>[y(a,ne({icon:"",variant:"text"},x,{disabled:l.value.length<1}),{default:b(()=>[y(r,{size:"large"},{default:b(()=>[J(" mdi-dots-vertical ")]),_:1})]),_:2},1040,["disabled"])]),default:b(()=>[y(d,null,{default:b(()=>[(f(!0),P(Y,null,_e(l.value,(x,g)=>(f(),D(c,{key:g,value:g,onClick:_=>u(x.cmd)},{default:b(()=>[y(i,null,{default:b(()=>[J(V(x.name),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})}}};var de=null;function Ze(e){return de||(de=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),de(e)}var ve=null;function Xe(e){ve||(ve=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),ve(e)}function $e(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function oe(e,t){t===void 0&&(t={});var n=document.createElement(e);return Object.keys(t).forEach(function(l){n[l]=t[l]}),n}function Ae(e,t,n){var l=window.getComputedStyle(e,n||null)||{display:"none"};return l[t]}function me(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(Ae(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var Qe='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',he=0,se=null;function et(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=at.bind(e));var n=e.__resize_listeners__;if(!n){if(e.__resize_listeners__=[],window.ResizeObserver){var l=e.offsetWidth,u=e.offsetHeight,o=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===l&&e.offsetHeight===u)||ue(e)}),s=me(e),r=s.detached,a=s.rendered;e.__resize_observer_triggered__=r===!1&&a===!1,e.__resize_observer__=o,o.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){ue(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(he||(se=$e(Qe)),rt(e),e.__resize_rendered__=me(e).rendered,window.MutationObserver){var i=new MutationObserver(e.__resize_mutation_handler__);i.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=i}}e.__resize_listeners__.push(t),he++}function tt(e,t){var n=e.__resize_listeners__;if(n){if(t&&n.splice(n.indexOf(t),1),!n.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",ge),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--he&&se&&se.parentNode.removeChild(se)}}function nt(e){var t=e.__resize_last__,n=t.width,l=t.height,u=e.offsetWidth,o=e.offsetHeight;return u!==n||o!==l?{width:u,height:o}:null}function at(){var e=me(this),t=e.rendered,n=e.detached;t!==this.__resize_rendered__&&(!n&&this.__resize_triggers__&&(xe(this),this.addEventListener("scroll",ge,!0)),this.__resize_rendered__=t,ue(this))}function ge(){var e=this;xe(this),this.__resize_raf__&&Xe(this.__resize_raf__),this.__resize_raf__=Ze(function(){var t=nt(e);t&&(e.__resize_last__=t,ue(e))})}function ue(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function rt(e){var t=Ae(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var n=oe("div",{className:"resize-triggers"}),l=oe("div",{className:"resize-expand-trigger"}),u=oe("div"),o=oe("div",{className:"resize-contract-trigger"});l.appendChild(u),n.appendChild(l),n.appendChild(o),e.appendChild(n),e.__resize_triggers__={triggers:n,expand:l,expandChild:u,contract:o},xe(e),e.addEventListener("scroll",ge,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function xe(e){var t=e.__resize_triggers__,n=t.expand,l=t.expandChild,u=t.contract,o=u.scrollWidth,s=u.scrollHeight,r=n.offsetWidth,a=n.offsetHeight,i=n.scrollWidth,c=n.scrollHeight;u.scrollLeft=o,u.scrollTop=s,l.style.width=r+1+"px",l.style.height=a+1+"px",n.scrollLeft=i,n.scrollTop=c}var W=function(){return W=Object.assign||function(e){for(var t,n=1,l=arguments.length;n<l;n++)for(var u in t=arguments[n])Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u]);return e},W.apply(this,arguments)};var lt=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function ot(e){return t=Object.create(null),lt.forEach(function(n){t[n]=function(l){return function(){for(var u=[],o=0;o<arguments.length;o++)u[o]=arguments[o];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[l].apply(e.value,u)}}(n)}),t;var t}var it={autoresize:[Boolean,Object]},st=/^on[^a-z]/,ut=function(e){return st.test(e)};function ie(e,t){var n=K(e);return n&&typeof n=="object"&&"value"in n?n.value||t:n||t}var ct="ecLoadingOptions",dt={loading:Boolean,loadingOptions:Object},$=null,Le="x-vue-echarts",ke=[],Q=[];(function(e,t){if(e&&typeof document<"u"){var n,l=t.prepend===!0?"prepend":"append",u=t.singleTag===!0,o=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(u){var s=ke.indexOf(o);s===-1&&(s=ke.push(o)-1,Q[s]={}),n=Q[s]&&Q[s][l]?Q[s][l]:Q[s][l]=r()}else n=r();e.charCodeAt(0)===65279&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function r(){var a=document.createElement("style");if(a.setAttribute("type","text/css"),t.attributes)for(var i=Object.keys(t.attributes),c=0;c<i.length;c++)a.setAttribute(i[c],t.attributes[i[c]]);var d=l==="prepend"?"afterbegin":"beforeend";return o.insertAdjacentElement(d,a),a}})(`x-vue-echarts{display:flex;flex-direction:column;width:100%;height:100%;min-width:0}
.vue-echarts-inner{flex-grow:1;min-width:0}
`,{});var vt=function(){if($!=null)return $;if(typeof HTMLElement>"u"||typeof customElements>"u")return $=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)(Le)}catch{return $=!1}return $=!0}(),ft="ecTheme",_t="ecInitOptions",mt="ecUpdateOptions",ht=Re({name:"echarts",props:W(W({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},it),dt),emits:{},inheritAttrs:!1,setup:function(e,t){var n=t.attrs,l=re(),u=re(),o=re(),s=re(),r=le(ft,null),a=le(_t,null),i=le(mt,null),c=Me(e),d=c.autoresize,C=c.manualUpdate,x=c.loading,g=c.loadingOptions,_=w(function(){return s.value||e.option||null}),v=w(function(){return e.theme||ie(r,{})}),L=w(function(){return e.initOptions||ie(a,{})}),p=w(function(){return e.updateOptions||ie(i,{})}),h=w(function(){return function(m){var O={};for(var A in m)ut(A)||(O[A]=m[A]);return O}(n)}),R=Te().proxy.$listeners;function S(m){if(u.value){var O=o.value=Pe(u.value,v.value,L.value);e.group&&(O.group=e.group);var A=R;A||(A={},Object.keys(n).filter(function(T){return T.indexOf("on")===0&&T.length>2}).forEach(function(T){var M=T.charAt(2).toLowerCase()+T.slice(3);M.substring(M.length-4)==="Once"&&(M="~".concat(M.substring(0,M.length-4))),A[M]=n[T]})),Object.keys(A).forEach(function(T){var M=A[T];if(M){var H=T.toLowerCase();H.charAt(0)==="~"&&(H=H.substring(1),M.__once__=!0);var q=O;if(H.indexOf("zr:")===0&&(q=O.getZr(),H=H.substring(3)),M.__once__){delete M.__once__;var Z=M;M=function(){for(var U=[],B=0;B<arguments.length;B++)U[B]=arguments[B];Z.apply(void 0,U),q.off(H,M)}}q.on(H,M)}}),d.value?Ve(function(){O&&!O.isDisposed()&&O.resize(),N()}):N()}function N(){var T=m||_.value;T&&O.setOption(T,p.value)}}function j(){o.value&&(o.value.dispose(),o.value=void 0)}var F=null;te(C,function(m){typeof F=="function"&&(F(),F=null),m||(F=te(function(){return e.option},function(O,A){O&&(o.value?o.value.setOption(O,W({notMerge:O!==A},p.value)):S())},{deep:!0}))},{immediate:!0}),te([v,L],function(){j(),S()},{deep:!0}),we(function(){e.group&&o.value&&(o.value.group=e.group)});var E=ot(o);return function(m,O,A){var N=le(ct,{}),T=w(function(){return W(W({},ie(N,{})),A==null?void 0:A.value)});we(function(){var M=m.value;M&&(O.value?M.showLoading(T.value):M.hideLoading())})}(o,x,g),function(m,O,A){var N=null;te([A,m,O],function(T,M,H){var q=T[0],Z=T[1],U=T[2];if(q&&Z&&U){var B=U===!0?{}:U,ae=B.throttle,X=ae===void 0?100:ae,ye=B.onResize,be=function(){Z.resize(),ye==null||ye()};N=X?je(be,X):be,et(q,N)}H(function(){q&&N&&tt(q,N)})})}(o,d,u),pe(function(){S()}),Oe(function(){vt&&l.value?l.value.__dispose=j:j()}),W({chart:o,root:l,inner:u,setOption:function(m,O){e.manualUpdate&&(s.value=m),o.value?o.value.setOption(m,O||{}):S(m)},nonEventAttrs:h},E)},render:function(){var e=W({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",Se(Le,e,[Se("div",{ref:"inner",class:"vue-echarts-inner"})])}});const pt={key:0,class:"mx-4 my-4 text-right"},gt={__name:"PanelMainChart",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=G(),l=Fe(),{mobile:u}=Ie(),o=Ne(),s=I({}),r=I({from:null,to:null,fromMenu:!1,toMenu:!1,loaded:!1});let a=[];const i=w(()=>(x(),"height: "+(n.app.panelMaximized?window.innerHeight-250+"px":t.height)));function c(g){return o.d(g,{dateStyle:u.value?"short":"long"})}function d(g,_){let v;return r.value.from&&_&&(v=r.value.from),r.value.to&&!_&&(v=r.value.to),!v&&!isNaN(g)&&(v=(L=>new Date(L.setDate(L.getDate()+(Number(g)||0))))(new Date)),v||(v=new Date(/.*T.*/.test(g)?g:g+"T00:00:00")),!r.value.from&&_&&(r.value.from=v),!r.value.to&&!_&&(r.value.to=v),v=new Date(v.getTime()-v.getTimezoneOffset()*60*1e3),v.toISOString().split("T")[0]}async function C(){let g=n.handleDefs(t.el.serie,["data","name","digits","suffix","type"],[null,"",0,"","line"],!0),_,v,L=[],p,h,R,S,j,F=[];if(g.length>0)for(const E of g){if(/^get.*/.test(E.data)){j="time",_=E.data.split(" ");for(const m of t.devices)m.split(":")[0]===_[1]&&(_[1]=m.split(":")[1]);if(_[4]=d(_[4],!0),_[5]=d(_[5],!1),v=await n.request("text",_.join(" ")),S=[],L=v.split(`
`),L.length>0)for(const m of L)p=m.split(" "),p.length>1&&(h=new Date(p[0].replace("_","T")),R=parseFloat(p[1]).toFixed(E.digits),S.push([h,R]))}else j="category",v=/,/.test(E.data)?E.data:E.data.replace(/ /g,","),/^\[.*\]$/.test(C)||(v="["+v+"]"),S=n.stringToJson(v);F.push({xAxisType:j,type:E.type,name:E.name,digits:E.digits,suffix:E.suffix,data:S})}return F}async function x(){let g={tooltip:{trigger:"axis"},legend:{data:[],bottom:10},backgroundColor:"rgba(255, 255, 255, 0)",grid:{top:30,bottom:60,left:60,right:60},animationDuration:300,series:[],yAxis:[],xAxis:{}},_,v=JSON.parse(JSON.stringify(n.getEl(t.el,["options"])||{})),L=JSON.parse(JSON.stringify(n.getEl(t.el,["options2"])||{})),p=Object.assign(g,n.app.panelMaximized&&Object.keys(L).length>0?L:v);r.value.fromMenu=!1,r.value.toMenu=!1,r.value.loaded=!1,a=await C();for(const[h,R]of Object.entries(a))_={formatter:S=>S.toLocaleString(o.locale.value,{minimumFractionDigits:R.digits,maximumFractionDigits:R.digits})+R.suffix},p.series[h]||(p.series[h]={}),p.yAxis[h]||(p.yAxis[h]={}),p.legend.data||(p.legend.data=[]),p.xAxis.type||(p.xAxis.type=R.xAxisType),p.series[h].name||(p.series[h].name=R.name),p.series[h].type||(p.series[h].type=R.type),p.series[h].data||(p.series[h].data=R.data),p.yAxis[h].type||(p.yAxis[h].type="value"),p.yAxis[h].axisLabel||(p.yAxis[h].axisLabel=_),p.legend.data[h]||(p.legend.data[h]=R.name);n.log(7,"Chartdata chart.loaded.",p),s.value=Object.assign({},p),r.value.loaded=!0}return(g,_)=>{const v=z("v-btn"),L=z("v-date-picker"),p=z("v-locale-provider"),h=z("v-menu"),R=z("v-skeleton-loader");return f(),P(Y,null,[K(n).app.panelMaximized?(f(),P("div",pt,[y(h,{modelValue:r.value.fromMenu,"onUpdate:modelValue":_[2]||(_[2]=S=>r.value.fromMenu=S),"close-on-content-click":!1},{activator:b(({props:S})=>[y(v,ne(S,{variant:"outlined","append-icon":"mdi-calendar",class:"mr-2"}),{default:b(()=>[J(V(c(r.value.from)),1)]),_:2},1040)]),default:b(()=>[y(p,{locale:K(o).locale.value},{default:b(()=>[y(L,{modelValue:r.value.from,"onUpdate:modelValue":[_[0]||(_[0]=S=>r.value.from=S),_[1]||(_[1]=S=>x())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"]),J(" - "),y(h,{modelValue:r.value.toMenu,"onUpdate:modelValue":_[5]||(_[5]=S=>r.value.toMenu=S),"close-on-content-click":!1},{activator:b(({props:S})=>[y(v,ne(S,{variant:"outlined","append-icon":"mdi-calendar",class:"ml-2"}),{default:b(()=>[J(V(c(r.value.to)),1)]),_:2},1040)]),default:b(()=>[y(p,{locale:K(o).locale.value},{default:b(()=>[y(L,{modelValue:r.value.to,"onUpdate:modelValue":[_[3]||(_[3]=S=>r.value.to=S),_[4]||(_[4]=S=>x())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"])])):k("",!0),De("div",{style:Ue(i.value)},[r.value.loaded?k("",!0):(f(),D(R,{key:0,type:"text, image, text"})),r.value.loaded?(f(),D(K(ht),{key:1,option:s.value,theme:K(l).global.name.value==="dark"?"dark":"light",autoresize:""},null,8,["option","theme"])):k("",!0)],4)],64)}}},xt=180/Math.PI,Ce=e=>{const t=e%360;return t<0?360+t:t},yt=({x:e,y:t},n)=>{const l=n.left+n.width/2,u=n.top+n.height/2;return Math.atan2(t-u,e-l)*xt},fe=()=>{};class bt{constructor(t,n){this.active=!1,this.element=t,this.element.style.willChange="transform",this.initOptions(n),this.updateCSS(),this.bindHandlers(),this.addListeners()}get angle(){return this._angle}set angle(t){this._angle!==t&&(this._angle=Ce(t),this.updateCSS())}initOptions(t){t=t||{},this.onRotate=t.onRotate||fe,this.onDragStart=t.onDragStart||fe,this.onDragStop=t.onDragStop||fe,this._angle=t.angle||0}bindHandlers(){this.onRotationStart=this.onRotationStart.bind(this),this.onRotated=this.onRotated.bind(this),this.onRotationStop=this.onRotationStop.bind(this)}addListeners(){this.element.addEventListener("touchstart",this.onRotationStart,{passive:!0}),document.addEventListener("touchmove",this.onRotated,{passive:!1}),document.addEventListener("touchend",this.onRotationStop,{passive:!0}),document.addEventListener("touchcancel",this.onRotationStop,{passive:!0}),this.element.addEventListener("mousedown",this.onRotationStart,{passive:!0}),document.addEventListener("mousemove",this.onRotated,{passive:!1}),document.addEventListener("mouseup",this.onRotationStop,{passive:!0}),document.addEventListener("mouseleave",this.onRotationStop,{passive:!1})}removeListeners(){this.element.removeEventListener("touchstart",this.onRotationStart),document.removeEventListener("touchmove",this.onRotated),document.removeEventListener("touchend",this.onRotationStop),document.removeEventListener("touchcancel",this.onRotationStop),this.element.removeEventListener("mousedown",this.onRotationStart),document.removeEventListener("mousemove",this.onRotated),document.removeEventListener("mouseup",this.onRotationStop),document.removeEventListener("mouseleave",this.onRotationStop)}destroy(){this.onRotationStop(),this.removeListeners()}onRotationStart(t){(t.type==="touchstart"||t.button===0)&&(this.active=!0,this.onDragStart(t),this.setAngleFromEvent(t))}onRotationStop(){this.active&&(this.active=!1,this.onDragStop()),this.active=!1}onRotated(t){this.active&&(t.preventDefault(),this.setAngleFromEvent(t))}setAngleFromEvent(t){const n=t.targetTouches?t.targetTouches[0]:t,l=yt({x:n.clientX,y:n.clientY},this.element.getBoundingClientRect());this._angle=Ce(l+90),this.updateCSS(),this.onRotate(this._angle)}updateCSS(){this.element.style.transform="rotate("+this._angle+"deg)"}}const zt=["red","yellow","green","cyan","blue","magenta","red"],Ee={ArrowUp:(e,t)=>e+t,ArrowRight:(e,t)=>e+t,ArrowDown:(e,t)=>e-t,ArrowLeft:(e,t)=>e-t,PageUp:(e,t)=>e+t*10,PageDown:(e,t)=>e-t*10,Home:()=>0,End:()=>359},ce={name:"ColorPicker",emits:["select","input","change"],props:{hue:{default:0},saturation:{default:100},luminosity:{default:50},alpha:{default:1},step:{default:1},mouseScroll:{default:!1},variant:{default:"collapsible"},disabled:{default:!1},initiallyCollapsed:{default:!1},ariaLabel:{default:"color picker"},ariaRoledescription:{default:"radial slider"},ariaValuetext:{default:""},ariaLabelColorWell:{default:"color well"}},setup(e,{emit:t}){const n=I(null),l=I(null);let u=null;const o=e.hue+"deg",s=I(e.hue),r=I(!e.initiallyCollapsed),a=I(!e.initiallyCollapsed),i=I(!1),c=I(!1),d=I(!1),C=w(()=>`hsla(${s.value}, ${e.saturation}%, ${e.luminosity}%, ${e.alpha})`),x=w(()=>zt[Math.round(s.value/60)]);return te(()=>e.hue,h=>{s.value=h,u.angle=h}),pe(()=>{u=new bt(l.value,{angle:s.value,onRotate(h){s.value=h,t("input",s.value)},onDragStart(){d.value=!0},onDragStop(){d.value=!1,t("change",s.value)}})}),Oe(()=>{u.destroy(),u=null}),{rcp:u,el:n,rotator:l,initialAngle:o,angle:s,isPaletteIn:r,isKnobIn:a,isDragging:d,isRippling:c,isPressed:i,color:C,valuetext:x,onKeyDown:h=>{e.disabled||i.value||!a.value||!(h.key in Ee)||(h.preventDefault(),u.angle=Ee[h.key](u.angle,e.step),s.value=u.angle,t("input",s.value),t("change",s.value))},onScroll:h=>{i.value||!a.value||(h.preventDefault(),h.deltaY>0?u.angle+=e.step:u.angle-=e.step,s.value=u.angle,t("input",s.value),t("change",s.value))},selectColor:()=>{i.value=!0,r.value&&a.value?(t("select",s.value),c.value=!0):r.value=!0},togglePicker:()=>{e.variant!=="persistent"&&(a.value?a.value=!1:(a.value=!0,r.value=!0)),c.value=!1,i.value=!1},hidePalette:()=>{a.value||(r.value=!1)}}}};function wt(e,t,n,l,u,o){return f(),D("div",{ref:"el",role:"slider","aria-roledescription":n.ariaRoledescription,"aria-label":n.ariaLabel,"aria-expanded":l.isPaletteIn,"aria-valuemin":"0","aria-valuemax":"359","aria-valuenow":l.angle,"aria-valuetext":n.ariaValuetext||l.valuetext,"aria-disabled":n.disabled,class:["rcp",{dragging:l.isDragging,disabled:n.disabled}],tabindex:n.disabled?-1:0,style:{"--rcp-initial-angle":l.initialAngle},onKeyup:t[4]||(t[4]=qe((...s)=>l.selectColor&&l.selectColor(...s),["enter"])),onKeydown:t[5]||(t[5]=(...s)=>l.onKeyDown&&l.onKeyDown(...s))},[y("div",{class:["rcp__palette",l.isPaletteIn?"in":"out"]},null,2),y("div",ne({class:"rcp__rotator",style:{"pointer-events":n.disabled||l.isPressed||!l.isKnobIn?"none":null}},He(n.mouseScroll?{wheel:l.onScroll}:{}),{ref:"rotator"}),[y("div",{class:["rcp__knob",l.isKnobIn?"in":"out"],onTransitionend:t[1]||(t[1]=(...s)=>l.hidePalette&&l.hidePalette(...s))},null,34)],16),y("div",{class:["rcp__ripple",{rippling:l.isRippling}],style:{borderColor:l.color}},null,6),y("button",{type:"button",class:["rcp__well",{pressed:l.isPressed}],"aria-label":n.ariaLabelColorWell,disabled:n.disabled,tabindex:n.disabled?-1:0,style:{backgroundColor:l.color},onAnimationend:t[2]||(t[2]=(...s)=>l.togglePicker&&l.togglePicker(...s)),onClick:t[3]||(t[3]=(...s)=>l.selectColor&&l.selectColor(...s))},null,46,["aria-label","disabled","tabindex"])],46,["aria-roledescription","aria-label","aria-expanded","aria-valuenow","aria-valuetext","aria-disabled","tabindex"])}ce.render=wt;ce.install=function(e){e.component("ColorPicker",ce)};const St={class:"mt-4 mb-2"},kt={__name:"PanelMainColorpicker",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=G(),l=w(()=>n.handleDefs(t.el.picker,["cmd","current"],["",!1]));function u(r){let a=o(r,50,100),i=l.value.cmd,c=[];i=i.replace("%v",a);for(const d of t.devices)c=d.split(":"),RegExp(c[0]).test(i)&&(i=i.replace(c[0],c[1]));n.request("text",i)}function o(r,a,i){a/=100;const c=i*Math.min(a,1-a)/100,d=C=>{const x=(C+r/30)%12,g=a-c*Math.max(Math.min(x-3,9-x,1),-1);return Math.round(255*g).toString(16).padStart(2,"0")};return`${d(0)}${d(8)}${d(4)}`}function s(r){r.split(" ").length>1&&(r=r.split(" ").slice(-1)[0]),r=r.replace(/^#/,"");let a=parseInt(r,16),i=a>>16&255,c=a>>8&255,d=a&255;i/=255,c/=255,d/=255;let C=Math.max(i,c,d),x=Math.min(i,c,d),g=C-x,_=(C+x)/2,v=0,L=0;return g!==0&&(C===i?v=((c-d)/g+(c<d?6:0))%6:C===c?v=((d-i)/g+2)%6:v=((i-c)/g+4)%6,v=v*60,L=g/(1-Math.abs(2*_-1))),L=Math.round(L*100),_=Math.round(_*100),{hue:v,saturation:L,luminosity:_}}return(r,a)=>(f(),P("div",St,[y(K(ce),ne(s(l.value.current),{variant:"persistent",onChange:a[0]||(a[0]=i=>u(i))}),null,16)]))}},Ct={__name:"PanelMain",props:{main:Object,levels:Array,iconmap:Object,devices:Object},setup(e){const t=G();function n(r,a){return t.handleDefs(r[a].size,["size"],[!1]).size}function l(r){let a="";return["info"].indexOf(r)!==-1&&(a="mx-2"),a}function u(r,a){return r[a]?t.handleDefs(r[a].divider,["show"],[!1]).show:!1}function o(r){return r.level?t.handleDefs(r.level.height,["height"],["64px"]).height:"64px"}function s(r){if(r==="info")return We;if(r==="btn")return Ke;if(r==="slider")return Je;if(r==="image")return Ge;if(r==="menu")return Ye;if(r==="chart")return gt;if(r==="colorpicker")return kt}return(r,a)=>{const i=z("v-sheet"),c=z("v-col"),d=z("v-divider"),C=z("v-row"),x=z("v-expand-transition");return f(!0),P(Y,null,_e(e.main,(g,_)=>(f(),P("div",{key:_},[y(x,null,{default:b(()=>[e.levels.indexOf(_)!==-1?(f(),D(C,{key:0,"no-gutters":"",class:"text-center align-center"},{default:b(()=>[y(i,{height:o(g,"level")},null,8,["height"]),(f(),P(Y,null,_e(["left1","left2","mid","right1","right2"],v=>(f(),P(Y,{key:v},[g.level[v]?(f(),D(c,{key:0,cols:n(g,v),class:ee(l(g.level[v]))},{default:b(()=>[(f(),D(Be(s(g.level[v])),{el:g[v],iconmap:e.iconmap,devices:e.devices,height:o(g,"level")},null,8,["el","iconmap","devices","height"]))]),_:2},1032,["cols","class"])):k("",!0),u(g,v)?(f(),D(d,{key:1,vertical:""})):k("",!0)],64))),64)),u(g,"level")?(f(),D(d,{key:0})):k("",!0)]),_:2},1024)):k("",!0)]),_:2},1024)]))),128)}}},Et={key:1},Dt={key:3},Ot={key:1},At={key:3},Lt={key:1},Rt={key:3},Tt={__name:"PanelCard",props:{panel:Object},setup(e){const t=e,n=G();let l=n.thread();pe(()=>n.thread(l));function u(E){let m=n.handleDefs(t.panel.status[E],["level","color","min","max","reverse"],[0,"success",0,100,!1]);return m.level=Math.round((m.level-m.min)/(m.max-m.min)*100),m}const o=w(()=>u("bar")),s=w(()=>u("bar2")),r=w(()=>n.handleDefs(t.panel.status.imageUrl,["url"],[""])),a=w(()=>n.handleDefs(t.panel.panel.sortby,["sortby"],[null])),i=w(()=>n.handleDefs(t.panel.status.title,["title"],[""])),c=w(()=>n.handleDefs(t.panel.panel.expandable,["expandable","expanded","maximizable"],[!1,!1,!1])),d=I(c.value.expanded),C=w(()=>{let E=null;return c.value.expandable&&(E=d.value?"mdi-arrow-collapse":"mdi-arrow-expand"),!c.value.expandable&&!c.value.expanded&&t.panel.main.length>1&&(E="mdi-swap-vertical"),E}),x=w(()=>{let E=[];for(const[m,O]of Object.entries(t.panel.main))n.handleDefs(O.level.show,["show"],[!0]).show&&E.push(Number(m));return E});function g(E){let m=-1;c.value.expandable||!c.value.expandable&&c.value.expanded?(E||(c.value.maximizable&&(n.app.panelMaximized=d.value?!1:t.panel),d.value=!d.value),_.value=d.value?x.value:[x.value[0]]):(m=x.value.indexOf(_.value?_.value[0]:null),_.value=m===-1||m===x.value.length-1?[x.value[0]]:[x.value[m+1]])}const _=I([]);function v(E){let m=n.handleDefs(t.panel.info[E],["text","icon","color"],["","",""]);return m.icon&&(m.icon=n.getIcon(m.icon,t.panel.panel.iconmap)),m}function L(){let E=!!(p.value.text||h.value.text),m=!!(R.value.text||S.value.text),O=!!(j.value.text||F.value.text);return!E&&m&&!O?7:null}const p=w(()=>v("left1")),h=w(()=>v("left2")),R=w(()=>v("mid1")),S=w(()=>v("mid2")),j=w(()=>v("right1")),F=w(()=>v("right2"));return g(!0),(E,m)=>{const O=z("v-progress-linear"),A=z("v-col"),N=z("v-row"),T=z("v-spacer"),M=z("v-btn"),H=z("v-card-title"),q=z("v-img"),Z=z("v-sheet"),U=z("v-icon"),B=z("v-card-text"),ae=z("v-card");return f(),D(ae,{variant:"tonal"},{default:b(()=>[y(N,{"no-gutters":""},{default:b(()=>[e.panel.status.bar?(f(),D(A,{key:0},{default:b(()=>[y(O,{height:"7",modelValue:o.value.level,"onUpdate:modelValue":m[0]||(m[0]=X=>o.value.level=X),color:o.value.color,reverse:o.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):k("",!0),e.panel.status.bar2?(f(),D(A,{key:1},{default:b(()=>[y(O,{height:"7",modelValue:s.value.level,"onUpdate:modelValue":m[1]||(m[1]=X=>s.value.level=X),color:s.value.color,reverse:s.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):k("",!0)]),_:1}),y(Z,{color:"secondary"},{default:b(()=>[y(q,{src:r.value.url,gradient:r.value.url?K(n).app.header.imageGradient:"",height:"48",cover:""},{default:b(()=>[e.panel.status.title?(f(),D(H,{key:0},{default:b(()=>[y(N,{"no-gutters":""},{default:b(()=>[y(A,null,{default:b(()=>[J(V(i.value.title),1)]),_:1}),y(T),K(n).app.settings.loglevel>6?(f(),D(A,{key:0,class:"text-right"},{default:b(()=>[J(V(a.value.sortby),1)]),_:1})):k("",!0),C.value?(f(),D(A,{key:1,cols:"1",class:"text-right"},{default:b(()=>[y(M,{icon:C.value,size:"small",variant:"plain",density:"compact",onClick:m[2]||(m[2]=X=>g(!1))},null,8,["icon"])]),_:1})):k("",!0)]),_:1})]),_:1})):k("",!0)]),_:1},8,["src","gradient"])]),_:1}),y(Ct,{main:e.panel.main,levels:_.value,iconmap:e.panel.panel.iconmap,devices:e.panel.panel.devices},null,8,["main","levels","iconmap","devices"]),y(Z,{color:"secondary"},{default:b(()=>[y(B,{class:"pa-1"},{default:b(()=>[y(N,{"no-gutters":""},{default:b(()=>[y(A,{class:"text-truncate text-left"},{default:b(()=>[p.value.icon?(f(),D(U,{key:0,icon:p.value.icon,color:p.value.color,size:"small"},null,8,["icon","color"])):k("",!0),p.value.text?(f(),P("span",Et,V(p.value.text),1)):k("",!0),h.value.icon?(f(),D(U,{key:2,icon:h.value.icon,color:h.value.color,size:"small",class:"ml-2"},null,8,["icon","color"])):k("",!0),h.value.text?(f(),P("span",Dt,V(h.value.text),1)):k("",!0)]),_:1}),y(A,{class:"text-truncate text-center",cols:L()},{default:b(()=>[R.value.icon?(f(),D(U,{key:0,icon:R.value.icon,color:R.value.color,size:"small"},null,8,["icon","color"])):k("",!0),R.value.text?(f(),P("span",Ot,V(R.value.text),1)):k("",!0),S.value.icon?(f(),D(U,{key:2,icon:S.value.icon,color:S.value.color,size:"small",class:"ml-2"},null,8,["icon","color"])):k("",!0),S.value.text?(f(),P("span",At,V(S.value.text),1)):k("",!0)]),_:1},8,["cols"]),y(A,{class:"text-truncate text-right"},{default:b(()=>[j.value.icon?(f(),D(U,{key:0,icon:j.value.icon,color:j.value.color,size:"small"},null,8,["icon","color"])):k("",!0),j.value.text?(f(),P("span",Lt,V(j.value.text),1)):k("",!0),F.value.icon?(f(),D(U,{key:2,icon:F.value.icon,color:F.value.color,size:"small",class:"ml-2"},null,8,["icon","color"])):k("",!0),F.value.text?(f(),P("span",Rt,V(F.value.text),1)):k("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}};export{Tt as _};
