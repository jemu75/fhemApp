import{u as Y,c as b,r as y,o as m,b as T,y as q,t as V,k as S,a as A,w as z,j as G,z as De,F as Z,e as x,A as we,f as j,q as ne,d as me,l as Re,B as oe,C as le,D as Me,E as Pe,s as te,G as ze,x as ge,H as Oe,m as Se,I as Te,J as Ve,h as J,K as je,L as Ie,i as Fe,p as Ne,M as Ue,N as He,O as qe,P as Be}from"./index-a0ee2194.js";const We={__name:"PanelMainInfo",props:{el:Object,iconmap:Array,devices:Object,height:String},setup(e){const t=e,n=Y(),o=b(()=>n.handleDefs(t.el.text,["text","format"],["",!t.el.text2&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),u=b(()=>n.handleDefs(t.el.text2,["text","format"],["",t.el.text&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),s=b(()=>n.handleDefs(t.el.text3,["text","format"],["","text-caption"])),i=b(()=>{let a=n.handleDefs(t.el.icon,["icon","color","size"],["","","x-large"]);return a.icon&&(a.icon=n.getIcon(a.icon,t.iconmap)),a}),r=b(()=>{let a=n.handleDefs(t.el.status,["level","color","min","max","reverse","linear"],[0,"success",0,100,!1,!1]);return a.level=Math.round((a.level-a.min)/(a.max-a.min)*100),a.reverse=!!a.reverse,a});return(a,l)=>{const c=y("v-icon"),v=y("v-progress-circular"),C=y("v-progress-linear");return m(),T(Z,null,[e.el.text?(m(),T("div",{key:0,class:q(o.value.format)},V(o.value.text),3)):S("",!0),e.el.icon?(m(),A(c,{key:1,color:i.value.color,size:i.value.size},{default:z(()=>[G(V(i.value.icon),1)]),_:1},8,["color","size"])):S("",!0),e.el.status&&!r.value.linear?(m(),A(v,{key:2,width:"4",modelValue:r.value.level,"onUpdate:modelValue":l[0]||(l[0]=w=>r.value.level=w),color:r.value.color,reverse:r.value.reverse},null,8,["modelValue","color","reverse"])):S("",!0),e.el.status&&r.value.linear?(m(),A(C,{key:3,height:"7",rounded:"",modelValue:r.value.level,"onUpdate:modelValue":l[1]||(l[1]=w=>r.value.level=w),color:r.value.color,reverse:r.value.reverse},null,8,["modelValue","color","reverse"])):S("",!0),De("div",{class:q(e.el.text2?u.value.format:s.value.format)},[e.el.text2?(m(),T("span",{key:0,class:q(u.value.format)},V(u.value.text),3)):S("",!0),e.el.text3?(m(),T("span",{key:1,class:q(s.value.format)},V(s.value.text),3)):S("",!0)],2)],64)}}},Ke={__name:"PanelMainBtn",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Y(),o=b(()=>{let a=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["",!1,"","text"]);return a.icon&&(a.icon=n.getIcon(a.icon,t.iconmap)),a}),u=b(()=>{let a=n.handleDefs(t.el.status,["level","color","min","max","reverse"],[0,"success",0,100,!1]);return a.level=Math.round((a.level-a.min)/(a.max-a.min)*100),a.reverse=!!a.reverse,a}),s={timer:!1,long:!1};function i(a){let l=[],c=a.cmd;if(a.type==="cmd"){for(const v of t.devices)l=v.split(":"),RegExp(l[0]).test(c)&&(c=c.replace(l[0],l[1]));n.request("text",c)}a.type==="route"&&we.push({name:"devices",params:{view:a.cmd},query:we.currentRoute.value.query}),a.type==="url"&&window.open(a.cmd,"_self")}function r(a){let l=n.handleDefs(t.el.click,["cmd","type"],["","cmd"]),c=n.handleDefs(t.el.longClick,["cmd","type"],["","cmd"]),v=n.handleDefs(t.el.longRelease,["cmd","type"],["","cmd"]);a==="mouseStart"&&(s.timer=setTimeout(()=>{s.long=!0,c.cmd&&i(c)},1e3)),a==="mouseEnd"&&(s.long?v.cmd&&i(v):l.cmd&&i(l),clearTimeout(s.timer),s.long=!1)}return(a,l)=>{const c=y("v-progress-linear"),v=y("v-icon"),C=y("v-btn");return m(),T(Z,null,[e.el.status?(m(),A(c,{key:0,height:"4",modelValue:u.value.level,"onUpdate:modelValue":l[0]||(l[0]=w=>u.value.level=w),color:u.value.color,reverse:u.value.reverse},null,8,["modelValue","color","reverse"])):S("",!0),x(C,{icon:"",variant:o.value.variant,disabled:o.value.disabled,color:o.value.color,onMousedown:l[1]||(l[1]=w=>r("mouseStart")),onMouseup:l[2]||(l[2]=w=>r("mouseEnd")),class:"my-2"},{default:z(()=>[x(v,{size:"large"},{default:z(()=>[G(V(o.value.icon),1)]),_:1})]),_:1},8,["variant","disabled","color"])],64)}}},Je={__name:"PanelMainSlider",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Y(),o=j();function u(a){o.value=a}const s=b(()=>{let a=n.handleDefs(t.el.slider,["cmd","current","color","min","max","steps","reverse","size","vertical"],["",0,"",0,100,10,!1,4,!1]);return/%v/.test(a.current)&&(a.current=a.current.replace("%v",o.value)),u(a.current),a});let i=null;function r(a){let l=s.value.cmd,c=/\./.exec(s.value.steps),v=0,C=[];c&&(v=s.value.steps.slice(c.index).length-1),l=l.replace("%v",a.toFixed(v));for(const w of t.devices)C=w.split(":"),RegExp(C[0]).test(l)&&(l=l.replace(C[0],C[1]));clearTimeout(i),i=setTimeout(()=>{n.request("text",l)},500)}return(a,l)=>{const c=y("v-slider");return m(),A(c,{modelValue:o.value,"onUpdate:modelValue":[l[0]||(l[0]=v=>o.value=v),l[1]||(l[1]=v=>r(v))],min:s.value.min,max:s.value.max,step:s.value.steps,reverse:s.value.reverse,direction:s.value.vertical?"vertical":"horizontal","track-size":s.value.size,color:s.value.color,"hide-details":"","thumb-label":""},null,8,["modelValue","min","max","step","reverse","direction","track-size","color"])}}},Ge={__name:"PanelMainImage",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Y(),o=j(!1),u=b(()=>n.handleDefs(t.el.image,["source","height"],["",null]));return(s,i)=>{const r=y("v-skeleton-loader"),a=y("v-img");return m(),T(Z,null,[o.value?S("",!0):(m(),A(r,{key:0,type:"image"})),x(a,{src:u.value.source,height:u.value.height,onLoad:i[0]||(i[0]=l=>o.value=!0)},null,8,["src","height"])],64)}}},Ye={__name:"PanelMainMenu",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Y(),o=b(()=>{let i=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["mdi-dots-vertical",!1,"","text"]);return i.icon&&(i.icon=n.getIcon(i.icon,t.iconmap)),i}),u=b(()=>{let i=[],r=n.handleDefs(t.el.menu,["name","cmd"],["",""],!0,","),a={};for(const l of r)a={name:/:/.test(l.name)?l.name.split(":")[0]:l.name,cmd:/:/.test(l.cmd)?l.cmd.split(":")[1]:l.cmd},i.push(a);return i});function s(i){let r=[];for(const a of t.devices)r=a.split(":"),RegExp(r[0]).test(i)&&(i=i.replace(r[0],r[1]));n.request("text",i)}return(i,r)=>{const a=y("v-icon"),l=y("v-btn"),c=y("v-list-item-title"),v=y("v-list-item"),C=y("v-list"),w=y("v-menu");return m(),A(w,null,{activator:z(({props:p})=>[x(l,ne(p,{icon:"",variant:o.value.variant,disabled:o.value.disabled||u.value.length<1,color:o.value.color,class:"my-2"}),{default:z(()=>[x(a,{size:"large"},{default:z(()=>[G(V(o.value.icon),1)]),_:1})]),_:2},1040,["variant","disabled","color"])]),default:z(()=>[x(C,null,{default:z(()=>[(m(!0),T(Z,null,me(u.value,(p,f)=>(m(),A(v,{key:f,value:f,onClick:d=>s(p.cmd)},{default:z(()=>[x(c,null,{default:z(()=>[G(V(p.name),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})}}};var ve=null;function Ze(e){return ve||(ve=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),ve(e)}var fe=null;function Xe(e){fe||(fe=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),fe(e)}function Qe(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function ie(e,t){t===void 0&&(t={});var n=document.createElement(e);return Object.keys(t).forEach(function(o){n[o]=t[o]}),n}function Ae(e,t,n){var o=window.getComputedStyle(e,n||null)||{display:"none"};return o[t]}function pe(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(Ae(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var $e='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',he=0,ue=null;function et(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=at.bind(e));var n=e.__resize_listeners__;if(!n){if(e.__resize_listeners__=[],window.ResizeObserver){var o=e.offsetWidth,u=e.offsetHeight,s=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===o&&e.offsetHeight===u)||ce(e)}),i=pe(e),r=i.detached,a=i.rendered;e.__resize_observer_triggered__=r===!1&&a===!1,e.__resize_observer__=s,s.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){ce(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(he||(ue=Qe($e)),rt(e),e.__resize_rendered__=pe(e).rendered,window.MutationObserver){var l=new MutationObserver(e.__resize_mutation_handler__);l.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=l}}e.__resize_listeners__.push(t),he++}function tt(e,t){var n=e.__resize_listeners__;if(n){if(t&&n.splice(n.indexOf(t),1),!n.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",xe),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--he&&ue&&ue.parentNode.removeChild(ue)}}function nt(e){var t=e.__resize_last__,n=t.width,o=t.height,u=e.offsetWidth,s=e.offsetHeight;return u!==n||s!==o?{width:u,height:s}:null}function at(){var e=pe(this),t=e.rendered,n=e.detached;t!==this.__resize_rendered__&&(!n&&this.__resize_triggers__&&(ye(this),this.addEventListener("scroll",xe,!0)),this.__resize_rendered__=t,ce(this))}function xe(){var e=this;ye(this),this.__resize_raf__&&Xe(this.__resize_raf__),this.__resize_raf__=Ze(function(){var t=nt(e);t&&(e.__resize_last__=t,ce(e))})}function ce(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function rt(e){var t=Ae(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var n=ie("div",{className:"resize-triggers"}),o=ie("div",{className:"resize-expand-trigger"}),u=ie("div"),s=ie("div",{className:"resize-contract-trigger"});o.appendChild(u),n.appendChild(o),n.appendChild(s),e.appendChild(n),e.__resize_triggers__={triggers:n,expand:o,expandChild:u,contract:s},ye(e),e.addEventListener("scroll",xe,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function ye(e){var t=e.__resize_triggers__,n=t.expand,o=t.expandChild,u=t.contract,s=u.scrollWidth,i=u.scrollHeight,r=n.offsetWidth,a=n.offsetHeight,l=n.scrollWidth,c=n.scrollHeight;u.scrollLeft=s,u.scrollTop=i,o.style.width=r+1+"px",o.style.height=a+1+"px",n.scrollLeft=l,n.scrollTop=c}var K=function(){return K=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var u in t=arguments[n])Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u]);return e},K.apply(this,arguments)};var ot=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function lt(e){return t=Object.create(null),ot.forEach(function(n){t[n]=function(o){return function(){for(var u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[o].apply(e.value,u)}}(n)}),t;var t}var it={autoresize:[Boolean,Object]},st=/^on[^a-z]/,ut=function(e){return st.test(e)};function se(e,t){var n=J(e);return n&&typeof n=="object"&&"value"in n?n.value||t:n||t}var ct="ecLoadingOptions",dt={loading:Boolean,loadingOptions:Object},$=null,Le="x-vue-echarts",ke=[],ee=[];(function(e,t){if(e&&typeof document<"u"){var n,o=t.prepend===!0?"prepend":"append",u=t.singleTag===!0,s=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(u){var i=ke.indexOf(s);i===-1&&(i=ke.push(s)-1,ee[i]={}),n=ee[i]&&ee[i][o]?ee[i][o]:ee[i][o]=r()}else n=r();e.charCodeAt(0)===65279&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function r(){var a=document.createElement("style");if(a.setAttribute("type","text/css"),t.attributes)for(var l=Object.keys(t.attributes),c=0;c<l.length;c++)a.setAttribute(l[c],t.attributes[l[c]]);var v=o==="prepend"?"afterbegin":"beforeend";return s.insertAdjacentElement(v,a),a}})(`x-vue-echarts,.echarts-inner{display:block;width:100%;height:100%;min-width:0}
`,{});var vt=function(){if($!=null)return $;if(typeof HTMLElement>"u"||typeof customElements>"u")return $=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)(Le)}catch{return $=!1}return $=!0}(),ft="ecTheme",_t="ecInitOptions",mt="ecUpdateOptions",pt=Re({name:"echarts",props:K(K({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},it),dt),emits:{},inheritAttrs:!1,setup:function(e,t){var n=t.attrs,o=oe(),u=oe(),s=oe(),i=oe(),r=le(ft,null),a=le(_t,null),l=le(mt,null),c=Me(e),v=c.autoresize,C=c.manualUpdate,w=c.loading,p=c.loadingOptions,f=b(function(){return i.value||e.option||null}),d=b(function(){return e.theme||se(r,{})}),O=b(function(){return e.initOptions||se(a,{})}),g=b(function(){return e.updateOptions||se(l,{})}),h=b(function(){return function(_){var D={};for(var L in _)ut(L)||(D[L]=_[L]);return D}(n)}),P=Pe().proxy.$listeners;function k(_){if(u.value){var D=s.value=Te(u.value,d.value,O.value);e.group&&(D.group=e.group);var L=P;L||(L={},Object.keys(n).filter(function(R){return R.indexOf("on")===0&&R.length>2}).forEach(function(R){var M=R.charAt(2).toLowerCase()+R.slice(3);M.substring(M.length-4)==="Once"&&(M="~".concat(M.substring(0,M.length-4))),L[M]=n[R]})),Object.keys(L).forEach(function(R){var M=L[R];if(M){var H=R.toLowerCase();H.charAt(0)==="~"&&(H=H.substring(1),M.__once__=!0);var B=D;if(H.indexOf("zr:")===0&&(B=D.getZr(),H=H.substring(3)),M.__once__){delete M.__once__;var Q=M;M=function(){for(var N=[],W=0;W<arguments.length;W++)N[W]=arguments[W];Q.apply(void 0,N),B.off(H,M)}}B.on(H,M)}}),v.value?Ve(function(){D&&!D.isDisposed()&&D.resize(),U()}):U()}function U(){var R=_||f.value;R&&D.setOption(R,g.value)}}function I(){s.value&&(s.value.dispose(),s.value=void 0)}var F=null;te(C,function(_){typeof F=="function"&&(F(),F=null),_||(F=te(function(){return e.option},function(D,L){D&&(s.value?s.value.setOption(D,K({notMerge:D!==L},g.value)):k())},{deep:!0}))},{immediate:!0}),te([d,O],function(){I(),k()},{deep:!0}),ze(function(){e.group&&s.value&&(s.value.group=e.group)});var E=lt(s);return function(_,D,L){var U=le(ct,{}),R=b(function(){return K(K({},se(U,{})),L==null?void 0:L.value)});ze(function(){var M=_.value;M&&(D.value?M.showLoading(R.value):M.hideLoading())})}(s,w,p),function(_,D,L){var U=null;te([L,_,D],function(R,M,H){var B=R[0],Q=R[1],N=R[2];if(B&&Q&&N){var W=N===!0?{}:N,ae=W.throttle,re=ae===void 0?100:ae,X=W.onResize,be=function(){Q.resize(),X==null||X()};U=re?je(be,re):be,et(B,U)}H(function(){B&&U&&tt(B,U)})})}(s,v,u),ge(function(){k()}),Oe(function(){vt&&o.value?o.value.__dispose=I:I()}),K({chart:s,root:o,inner:u,setOption:function(_,D){e.manualUpdate&&(i.value=_),s.value?s.value.setOption(_,D||{}):k(_)},nonEventAttrs:h},E)},render:function(){var e=K({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",Se(Le,e,[Se("div",{ref:"inner",class:"echarts-inner"})])}});const ht={key:0,class:"mx-4 my-4 text-right"},gt={__name:"PanelMainChart",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Y(),o=Ie(),{mobile:u}=Fe(),s=Ne(),i=j({}),r=j({from:null,to:null,fromMenu:!1,toMenu:!1,loaded:!1});let a=[];const l=b(()=>(w(),"height: "+(n.app.panelMaximized?window.innerHeight-250+"px":t.height)));function c(p){return s.d(p,{dateStyle:u.value?"short":"long"})}function v(p,f){let d;return r.value.from&&f&&(d=r.value.from),r.value.to&&!f&&(d=r.value.to),!d&&!isNaN(p)&&(d=(O=>new Date(O.setDate(O.getDate()+(Number(p)||0))))(new Date)),d||(d=new Date(/.*T.*/.test(p)?p:p+"T00:00:00")),!r.value.from&&f&&(r.value.from=d),!r.value.to&&!f&&(r.value.to=d),d=new Date(d.getTime()-d.getTimezoneOffset()*60*1e3),d.toISOString().split("T")[0]}async function C(){let p=n.handleDefs(t.el.serie,["data","name","digits","suffix","type"],[null,"",0,"","line"],!0),f,d,O=[],g,h,P,k,I,F=[];if(p.length>0)for(const E of p){if(/^get.*/.test(E.data)){I="time",f=E.data.split(" ");for(const _ of t.devices)_.split(":")[0]===f[1]&&(f[1]=_.split(":")[1]);if(f[4]=v(f[4],!0),f[5]=v(f[5],!1),d=await n.request("text",f.join(" ")),k=[],O=d.split(`
`),O.length>0)for(const _ of O)g=_.split(" "),g.length>1&&(h=new Date(g[0].replace("_","T")),P=parseFloat(g[1]).toFixed(E.digits),k.push([h,P]))}else I="category",d=/,/.test(E.data)?E.data:E.data.replace(/ /g,","),/^\[.*\]$/.test(C)||(d="["+d+"]"),k=n.stringToJson(d);F.push({xAxisType:I,type:E.type,name:E.name,digits:E.digits,suffix:E.suffix,data:k})}return F}async function w(){let p={tooltip:{trigger:"axis"},legend:{data:[],bottom:10},backgroundColor:"rgba(255, 255, 255, 0)",grid:{top:30,bottom:60,left:60,right:60},animationDuration:300,series:[],yAxis:[],xAxis:{}},f,d=JSON.parse(JSON.stringify(n.getEl(t.el,["options"])||{})),O=JSON.parse(JSON.stringify(n.getEl(t.el,["options2"])||{})),g=Object.assign(p,n.app.panelMaximized&&Object.keys(O).length>0?O:d);r.value.fromMenu=!1,r.value.toMenu=!1,r.value.loaded=!1,a=await C();for(const[h,P]of Object.entries(a))f={formatter:k=>k.toLocaleString(s.locale.value,{minimumFractionDigits:P.digits,maximumFractionDigits:P.digits})+P.suffix},g.series[h]||(g.series[h]={}),g.yAxis[h]||(g.yAxis[h]={}),g.legend.data||(g.legend.data=[]),g.xAxis.type||(g.xAxis.type=P.xAxisType),g.series[h].name||(g.series[h].name=P.name),g.series[h].type||(g.series[h].type=P.type),g.series[h].data||(g.series[h].data=P.data),g.yAxis[h].type||(g.yAxis[h].type="value"),g.yAxis[h].axisLabel||(g.yAxis[h].axisLabel=f),g.legend.data[h]||(g.legend.data[h]=P.name);n.log(7,"Chartdata chart.loaded.",g),i.value=Object.assign({},g),r.value.loaded=!0}return(p,f)=>{const d=y("v-btn"),O=y("v-date-picker"),g=y("v-locale-provider"),h=y("v-menu"),P=y("v-skeleton-loader");return m(),T(Z,null,[J(n).app.panelMaximized?(m(),T("div",ht,[x(h,{modelValue:r.value.fromMenu,"onUpdate:modelValue":f[2]||(f[2]=k=>r.value.fromMenu=k),"close-on-content-click":!1},{activator:z(({props:k})=>[x(d,ne(k,{variant:"outlined","append-icon":"mdi-calendar",class:"mr-2"}),{default:z(()=>[G(V(c(r.value.from)),1)]),_:2},1040)]),default:z(()=>[x(g,{locale:J(s).locale.value},{default:z(()=>[x(O,{modelValue:r.value.from,"onUpdate:modelValue":[f[0]||(f[0]=k=>r.value.from=k),f[1]||(f[1]=k=>w())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"]),G(" - "),x(h,{modelValue:r.value.toMenu,"onUpdate:modelValue":f[5]||(f[5]=k=>r.value.toMenu=k),"close-on-content-click":!1},{activator:z(({props:k})=>[x(d,ne(k,{variant:"outlined","append-icon":"mdi-calendar",class:"ml-2"}),{default:z(()=>[G(V(c(r.value.to)),1)]),_:2},1040)]),default:z(()=>[x(g,{locale:J(s).locale.value},{default:z(()=>[x(O,{modelValue:r.value.to,"onUpdate:modelValue":[f[3]||(f[3]=k=>r.value.to=k),f[4]||(f[4]=k=>w())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"])])):S("",!0),De("div",{style:Ue(l.value)},[r.value.loaded?S("",!0):(m(),A(P,{key:0,type:"text, image, text"})),r.value.loaded?(m(),A(J(pt),{key:1,option:i.value,theme:J(o).global.name.value==="dark"?"dark":"light",autoresize:""},null,8,["option","theme"])):S("",!0)],4)],64)}}},xt=180/Math.PI,Ce=e=>{const t=e%360;return t<0?360+t:t},yt=({x:e,y:t},n)=>{const o=n.left+n.width/2,u=n.top+n.height/2;return Math.atan2(t-u,e-o)*xt},_e=()=>{};class bt{constructor(t,n){this.active=!1,this.element=t,this.element.style.willChange="transform",this.initOptions(n),this.updateCSS(),this.bindHandlers(),this.addListeners()}get angle(){return this._angle}set angle(t){this._angle!==t&&(this._angle=Ce(t),this.updateCSS())}initOptions(t){t=t||{},this.onRotate=t.onRotate||_e,this.onDragStart=t.onDragStart||_e,this.onDragStop=t.onDragStop||_e,this._angle=t.angle||0}bindHandlers(){this.onRotationStart=this.onRotationStart.bind(this),this.onRotated=this.onRotated.bind(this),this.onRotationStop=this.onRotationStop.bind(this)}addListeners(){this.element.addEventListener("touchstart",this.onRotationStart,{passive:!0}),document.addEventListener("touchmove",this.onRotated,{passive:!1}),document.addEventListener("touchend",this.onRotationStop,{passive:!0}),document.addEventListener("touchcancel",this.onRotationStop,{passive:!0}),this.element.addEventListener("mousedown",this.onRotationStart,{passive:!0}),document.addEventListener("mousemove",this.onRotated,{passive:!1}),document.addEventListener("mouseup",this.onRotationStop,{passive:!0}),document.addEventListener("mouseleave",this.onRotationStop,{passive:!1})}removeListeners(){this.element.removeEventListener("touchstart",this.onRotationStart),document.removeEventListener("touchmove",this.onRotated),document.removeEventListener("touchend",this.onRotationStop),document.removeEventListener("touchcancel",this.onRotationStop),this.element.removeEventListener("mousedown",this.onRotationStart),document.removeEventListener("mousemove",this.onRotated),document.removeEventListener("mouseup",this.onRotationStop),document.removeEventListener("mouseleave",this.onRotationStop)}destroy(){this.onRotationStop(),this.removeListeners()}onRotationStart(t){(t.type==="touchstart"||t.button===0)&&(this.active=!0,this.onDragStart(t),this.setAngleFromEvent(t))}onRotationStop(){this.active&&(this.active=!1,this.onDragStop()),this.active=!1}onRotated(t){this.active&&(t.preventDefault(),this.setAngleFromEvent(t))}setAngleFromEvent(t){const n=t.targetTouches?t.targetTouches[0]:t,o=yt({x:n.clientX,y:n.clientY},this.element.getBoundingClientRect());this._angle=Ce(o+90),this.updateCSS(),this.onRotate(this._angle)}updateCSS(){this.element.style.transform="rotate("+this._angle+"deg)"}}const wt=["red","yellow","green","cyan","blue","magenta","red"],Ee={ArrowUp:(e,t)=>e+t,ArrowRight:(e,t)=>e+t,ArrowDown:(e,t)=>e-t,ArrowLeft:(e,t)=>e-t,PageUp:(e,t)=>e+t*10,PageDown:(e,t)=>e-t*10,Home:()=>0,End:()=>359},de={name:"ColorPicker",emits:["select","input","change"],props:{hue:{default:0},saturation:{default:100},luminosity:{default:50},alpha:{default:1},step:{default:1},mouseScroll:{default:!1},variant:{default:"collapsible"},disabled:{default:!1},initiallyCollapsed:{default:!1},ariaLabel:{default:"color picker"},ariaRoledescription:{default:"radial slider"},ariaValuetext:{default:""},ariaLabelColorWell:{default:"color well"}},setup(e,{emit:t}){const n=j(null),o=j(null);let u=null;const s=e.hue+"deg",i=j(e.hue),r=j(!e.initiallyCollapsed),a=j(!e.initiallyCollapsed),l=j(!1),c=j(!1),v=j(!1),C=b(()=>`hsla(${i.value}, ${e.saturation}%, ${e.luminosity}%, ${e.alpha})`),w=b(()=>wt[Math.round(i.value/60)]);return te(()=>e.hue,h=>{i.value=h,u.angle=h}),ge(()=>{u=new bt(o.value,{angle:i.value,onRotate(h){i.value=h,t("input",i.value)},onDragStart(){v.value=!0},onDragStop(){v.value=!1,t("change",i.value)}})}),Oe(()=>{u.destroy(),u=null}),{rcp:u,el:n,rotator:o,initialAngle:s,angle:i,isPaletteIn:r,isKnobIn:a,isDragging:v,isRippling:c,isPressed:l,color:C,valuetext:w,onKeyDown:h=>{e.disabled||l.value||!a.value||!(h.key in Ee)||(h.preventDefault(),u.angle=Ee[h.key](u.angle,e.step),i.value=u.angle,t("input",i.value),t("change",i.value))},onScroll:h=>{l.value||!a.value||(h.preventDefault(),h.deltaY>0?u.angle+=e.step:u.angle-=e.step,i.value=u.angle,t("input",i.value),t("change",i.value))},selectColor:()=>{l.value=!0,r.value&&a.value?(t("select",i.value),c.value=!0):r.value=!0},togglePicker:()=>{e.variant!=="persistent"&&(a.value?a.value=!1:(a.value=!0,r.value=!0)),c.value=!1,l.value=!1},hidePalette:()=>{a.value||(r.value=!1)}}}};function zt(e,t,n,o,u,s){return m(),A("div",{ref:"el",role:"slider","aria-roledescription":n.ariaRoledescription,"aria-label":n.ariaLabel,"aria-expanded":o.isPaletteIn,"aria-valuemin":"0","aria-valuemax":"359","aria-valuenow":o.angle,"aria-valuetext":n.ariaValuetext||o.valuetext,"aria-disabled":n.disabled,class:["rcp",{dragging:o.isDragging,disabled:n.disabled}],tabindex:n.disabled?-1:0,style:{"--rcp-initial-angle":o.initialAngle},onKeyup:t[4]||(t[4]=qe((...i)=>o.selectColor&&o.selectColor(...i),["enter"])),onKeydown:t[5]||(t[5]=(...i)=>o.onKeyDown&&o.onKeyDown(...i))},[x("div",{class:["rcp__palette",o.isPaletteIn?"in":"out"]},null,2),x("div",ne({class:"rcp__rotator",style:{"pointer-events":n.disabled||o.isPressed||!o.isKnobIn?"none":null}},He(n.mouseScroll?{wheel:o.onScroll}:{}),{ref:"rotator"}),[x("div",{class:["rcp__knob",o.isKnobIn?"in":"out"],onTransitionend:t[1]||(t[1]=(...i)=>o.hidePalette&&o.hidePalette(...i))},null,34)],16),x("div",{class:["rcp__ripple",{rippling:o.isRippling}],style:{borderColor:o.color}},null,6),x("button",{type:"button",class:["rcp__well",{pressed:o.isPressed}],"aria-label":n.ariaLabelColorWell,disabled:n.disabled,tabindex:n.disabled?-1:0,style:{backgroundColor:o.color},onAnimationend:t[2]||(t[2]=(...i)=>o.togglePicker&&o.togglePicker(...i)),onClick:t[3]||(t[3]=(...i)=>o.selectColor&&o.selectColor(...i))},null,46,["aria-label","disabled","tabindex"])],46,["aria-roledescription","aria-label","aria-expanded","aria-valuenow","aria-valuetext","aria-disabled","tabindex"])}de.render=zt;de.install=function(e){e.component("ColorPicker",de)};const St={class:"mt-4 mb-2"},kt={__name:"PanelMainColorpicker",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Y(),o=b(()=>n.handleDefs(t.el.picker,["cmd","current"],["",!1]));function u(r){let a=s(r,50,100),l=o.value.cmd,c=[];l=l.replace("%v",a);for(const v of t.devices)c=v.split(":"),RegExp(c[0]).test(l)&&(l=l.replace(c[0],c[1]));n.request("text",l)}function s(r,a,l){a/=100;const c=l*Math.min(a,1-a)/100,v=C=>{const w=(C+r/30)%12,p=a-c*Math.max(Math.min(w-3,9-w,1),-1);return Math.round(255*p).toString(16).padStart(2,"0")};return`${v(0)}${v(8)}${v(4)}`}function i(r){r.split(" ").length>1&&(r=r.split(" ").slice(-1)[0]),r=r.replace(/^#/,"");let a=parseInt(r,16),l=a>>16&255,c=a>>8&255,v=a&255;l/=255,c/=255,v/=255;let C=Math.max(l,c,v),w=Math.min(l,c,v),p=C-w,f=(C+w)/2,d=0,O=0;return p!==0&&(C===l?d=((c-v)/p+(c<v?6:0))%6:C===c?d=((v-l)/p+2)%6:d=((l-c)/p+4)%6,d=d*60,O=p/(1-Math.abs(2*f-1))),O=Math.round(O*100),f=Math.round(f*100),{hue:d,saturation:O,luminosity:f}}return(r,a)=>(m(),T("div",St,[x(J(de),ne(i(o.value.current),{variant:"persistent",onChange:a[0]||(a[0]=l=>u(l))}),null,16)]))}},Ct={__name:"PanelMain",props:{main:Object,levels:Array,iconmap:Object,devices:Object},setup(e){const t=Y();function n(r,a){return t.handleDefs(r[a].size,["size"],[!1]).size}function o(r){let a="";return["info"].indexOf(r)!==-1&&(a="mx-2"),a}function u(r,a){return r[a]?t.handleDefs(r[a].divider,["show"],[!1]).show:!1}function s(r){return r.level?t.handleDefs(r.level.height,["height"],["64px"]).height:"64px"}function i(r){if(r==="info")return We;if(r==="btn")return Ke;if(r==="slider")return Je;if(r==="image")return Ge;if(r==="menu")return Ye;if(r==="chart")return gt;if(r==="colorpicker")return kt}return(r,a)=>{const l=y("v-sheet"),c=y("v-col"),v=y("v-divider"),C=y("v-row"),w=y("v-expand-transition");return m(!0),T(Z,null,me(e.main,(p,f)=>(m(),T("div",{key:f},[x(w,null,{default:z(()=>[e.levels.indexOf(f)!==-1?(m(),A(C,{key:0,"no-gutters":"",class:"text-center align-center"},{default:z(()=>[x(l,{height:s(p,"level")},null,8,["height"]),(m(),T(Z,null,me(["left1","left2","mid","right1","right2"],d=>(m(),T(Z,{key:d},[p.level[d]?(m(),A(c,{key:0,cols:n(p,d),class:q(o(p.level[d]))},{default:z(()=>[(m(),A(Be(i(p.level[d])),{el:p[d],iconmap:e.iconmap,devices:e.devices,height:s(p,"level")},null,8,["el","iconmap","devices","height"]))]),_:2},1032,["cols","class"])):S("",!0),u(p,d)?(m(),A(v,{key:1,vertical:""})):S("",!0)],64))),64)),u(p,"level")?(m(),A(v,{key:0})):S("",!0)]),_:2},1024)):S("",!0)]),_:2},1024)]))),128)}}},Dt={__name:"PanelCard",props:{panel:Object},setup(e){const t=e,n=Y();let o=n.thread();ge(()=>n.thread(o));function u(E){let _=n.handleDefs(t.panel.status[E],["level","color","min","max","reverse"],[0,"success",0,100,!1]);return _.level=Math.round((_.level-_.min)/(_.max-_.min)*100),_}const s=b(()=>u("bar")),i=b(()=>u("bar2")),r=b(()=>n.handleDefs(t.panel.status.imageUrl,["url"],[""])),a=b(()=>n.handleDefs(t.panel.panel.sortby,["sortby"],[null])),l=b(()=>n.handleDefs(t.panel.status.title,["title"],[""])),c=b(()=>n.handleDefs(t.panel.panel.expandable,["expandable","expanded","maximizable"],[!1,!1,!1])),v=j(c.value.expanded),C=b(()=>{let E=null;return c.value.expandable&&(E=v.value?"mdi-arrow-collapse":"mdi-arrow-expand"),!c.value.expandable&&!c.value.expanded&&t.panel.main.length>1&&(E="mdi-swap-vertical"),E}),w=b(()=>{let E=[];for(const[_,D]of Object.entries(t.panel.main))n.handleDefs(D.level.show,["show"],[!0]).show&&E.push(Number(_));return E});function p(E){let _=-1;c.value.expandable||!c.value.expandable&&c.value.expanded?(E||(c.value.maximizable&&(n.app.panelMaximized=v.value?!1:t.panel),v.value=!v.value),f.value=v.value?w.value:[w.value[0]]):(_=w.value.indexOf(f.value?f.value[0]:null),f.value=_===-1||_===w.value.length-1?[w.value[0]]:[w.value[_+1]])}const f=j([]);function d(E){let _=n.handleDefs(t.panel.info[E],["text","icon","color"],["","",""]);return _.icon&&(_.icon=n.getIcon(_.icon,t.panel.panel.iconmap)),_}function O(E){let _=["left1","left2","mid1","mid2","right1","right2"],D=d(E);return d(_[_.indexOf(E)-1]).text&&D.text&&!D.icon?"ml-1 text-truncate":D.text?"text-truncate":""}const g=b(()=>d("left1")),h=b(()=>d("left2")),P=b(()=>d("mid1")),k=b(()=>d("mid2")),I=b(()=>d("right1")),F=b(()=>d("right2"));return p(!0),(E,_)=>{const D=y("v-progress-linear"),L=y("v-col"),U=y("v-row"),R=y("v-spacer"),M=y("v-btn"),H=y("v-card-title"),B=y("v-img"),Q=y("v-sheet"),N=y("v-icon"),W=y("v-system-bar"),ae=y("v-layout"),re=y("v-card");return m(),A(re,{variant:"tonal"},{default:z(()=>[x(U,{"no-gutters":""},{default:z(()=>[e.panel.status.bar?(m(),A(L,{key:0},{default:z(()=>[x(D,{height:"7",modelValue:s.value.level,"onUpdate:modelValue":_[0]||(_[0]=X=>s.value.level=X),color:s.value.color,reverse:s.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):S("",!0),e.panel.status.bar2?(m(),A(L,{key:1},{default:z(()=>[x(D,{height:"7",modelValue:i.value.level,"onUpdate:modelValue":_[1]||(_[1]=X=>i.value.level=X),color:i.value.color,reverse:i.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):S("",!0)]),_:1}),x(Q,{color:"secondary"},{default:z(()=>[x(B,{src:r.value.url,gradient:r.value.url?J(n).app.header.imageGradient:"",height:"48",cover:""},{default:z(()=>[e.panel.status.title?(m(),A(H,{key:0},{default:z(()=>[x(U,{"no-gutters":""},{default:z(()=>[x(L,null,{default:z(()=>[G(V(l.value.title),1)]),_:1}),x(R),J(n).app.settings.loglevel>6?(m(),A(L,{key:0,class:"text-right"},{default:z(()=>[G(V(a.value.sortby),1)]),_:1})):S("",!0),C.value?(m(),A(L,{key:1,cols:"1",class:"text-right"},{default:z(()=>[x(M,{icon:C.value,size:"small",variant:"plain",density:"compact",onClick:_[2]||(_[2]=X=>p(!1))},null,8,["icon"])]),_:1})):S("",!0)]),_:1})]),_:1})):S("",!0)]),_:1},8,["src","gradient"])]),_:1}),x(Ct,{main:e.panel.main,levels:f.value,iconmap:e.panel.panel.iconmap,devices:e.panel.panel.devices},null,8,["main","levels","iconmap","devices"]),x(ae,{style:{height:"24px"}},{default:z(()=>[x(W,{color:"secondary"},{default:z(()=>[g.value.icon?(m(),A(N,{key:0,icon:g.value.icon,color:g.value.color},null,8,["icon","color"])):S("",!0),g.value.text?(m(),T("span",{key:1,class:q(O("left1"))},V(g.value.text),3)):S("",!0),h.value.icon?(m(),A(N,{key:2,icon:h.value.icon,color:h.value.color},null,8,["icon","color"])):S("",!0),h.value.text?(m(),T("span",{key:3,class:q(O("left2"))},V(h.value.text),3)):S("",!0),x(R),P.value.icon?(m(),A(N,{key:4,icon:P.value.icon,color:P.value.color},null,8,["icon","color"])):S("",!0),P.value.text?(m(),T("span",{key:5,class:q(O("mid1"))},V(P.value.text),3)):S("",!0),k.value.icon?(m(),A(N,{key:6,icon:k.value.icon,color:k.value.color},null,8,["icon","color"])):S("",!0),k.value.text?(m(),T("span",{key:7,class:q(O("mid2"))},V(k.value.text),3)):S("",!0),x(R),I.value.icon?(m(),A(N,{key:8,icon:I.value.icon,color:I.value.color},null,8,["icon","color"])):S("",!0),I.value.text?(m(),T("span",{key:9,class:q(O("right1"))},V(I.value.text),3)):S("",!0),F.value.icon?(m(),A(N,{key:10,icon:F.value.icon,color:F.value.color},null,8,["icon","color"])):S("",!0),F.value.text?(m(),T("span",{key:11,class:q(O("right2"))},V(F.value.text),3)):S("",!0)]),_:1})]),_:1})]),_:1})}}};export{Dt as _};
