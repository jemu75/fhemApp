import{u as G,c as S,r as y,o as p,b as P,y as q,t as I,k as b,a as E,w as z,j as J,z as ge,F as Y,e as w,s as Q,f as N,q as ee,x as ae,d as _e,l as Ae,A as ie,B as le,C as Me,D as Ve,E as ke,G as xe,H as Le,m as Se,I as Pe,J as Te,h as B,K as je,L as Ie,i as Fe,p as Ne,M as Ue,N as He,O as qe,P as Be}from"./index-ae1cfcb8.js";const We={__name:"PanelMainInfo",props:{el:Object,iconmap:Array,devices:Object,height:String},setup(e){const t=e,n=G(),i=S(()=>n.handleDefs(t.el.text,["text","format"],["",!t.el.text2&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),s=S(()=>n.handleDefs(t.el.text2,["text","format"],["",t.el.text&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),o=S(()=>n.handleDefs(t.el.text3,["text","format"],["","text-caption"])),u=S(()=>{let a=n.handleDefs(t.el.icon,["icon","color","size"],["","","x-large"]);return a.icon&&(a.icon=n.getIcon(a.icon,t.iconmap)),a}),r=S(()=>{let a=n.handleDefs(t.el.status,["level","color","min","max","reverse","linear"],[0,"success",0,100,!1,!1]);return a.level=Math.round((a.level-a.min)/(a.max-a.min)*100),a.reverse=!!a.reverse,a});return(a,l)=>{const c=y("v-icon"),v=y("v-progress-circular"),x=y("v-progress-linear");return p(),P(Y,null,[e.el.text?(p(),P("div",{key:0,class:q(i.value.format)},I(i.value.text),3)):b("",!0),e.el.icon?(p(),E(c,{key:1,color:u.value.color,size:u.value.size},{default:z(()=>[J(I(u.value.icon),1)]),_:1},8,["color","size"])):b("",!0),e.el.status&&!r.value.linear?(p(),E(v,{key:2,width:"4",modelValue:r.value.level,"onUpdate:modelValue":l[0]||(l[0]=C=>r.value.level=C),color:r.value.color,reverse:r.value.reverse},null,8,["modelValue","color","reverse"])):b("",!0),e.el.status&&r.value.linear?(p(),E(x,{key:3,height:"7",rounded:"",modelValue:r.value.level,"onUpdate:modelValue":l[1]||(l[1]=C=>r.value.level=C),color:r.value.color,reverse:r.value.reverse},null,8,["modelValue","color","reverse"])):b("",!0),ge("div",{class:q(e.el.text2?s.value.format:o.value.format)},[e.el.text2?(p(),P("span",{key:0,class:q(s.value.format)},I(s.value.text),3)):b("",!0),e.el.text3?(p(),P("span",{key:1,class:q(o.value.format)},I(o.value.text),3)):b("",!0)],2)],64)}}},Ke={__name:"PanelMainBtn",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=G(),i=S(()=>{let a=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["",!1,"","text"]);return a.icon&&(a.icon=n.getIcon(a.icon,t.iconmap)),a}),s=S(()=>{let a=n.handleDefs(t.el.status,["level","color","min","max","reverse"],[0,"success",0,100,!1]);return a.level=Math.round((a.level-a.min)/(a.max-a.min)*100),a.reverse=!!a.reverse,a}),o={timer:!1,long:!1};function u(a){let l=[],c=a.cmd,v;if(a.type==="cmd"){for(const x of t.devices)l=x.split(":"),v=RegExp(l[0],"g"),v.test(c)&&(c=c.replace(v,l[1]));n.request("text",c)}a.type==="route"&&Q.push({name:"devices",params:{view:a.cmd},query:Q.currentRoute.value.query}),a.type==="url"&&window.open(a.cmd,"_self")}function r(a){let l=n.handleDefs(t.el.click,["cmd","type"],["","cmd"],!1,null,!0),c=n.handleDefs(t.el.longClick,["cmd","type"],["","cmd"],!1,null,!0),v=n.handleDefs(t.el.longRelease,["cmd","type"],["","cmd"],!1,null,!0);a==="mouseStart"&&(o.timer=setTimeout(()=>{o.long=!0,c.cmd&&u(c)},1e3)),a==="mouseEnd"&&(o.long?v.cmd&&u(v):l.cmd&&u(l),clearTimeout(o.timer),o.long=!1)}return(a,l)=>{const c=y("v-progress-linear"),v=y("v-icon"),x=y("v-btn");return p(),P(Y,null,[e.el.status?(p(),E(c,{key:0,height:"4",modelValue:s.value.level,"onUpdate:modelValue":l[0]||(l[0]=C=>s.value.level=C),color:s.value.color,reverse:s.value.reverse},null,8,["modelValue","color","reverse"])):b("",!0),w(x,{icon:"",variant:i.value.variant,disabled:i.value.disabled,color:i.value.color,onMousedown:l[1]||(l[1]=C=>r("mouseStart")),onMouseup:l[2]||(l[2]=C=>r("mouseEnd")),class:"my-2"},{default:z(()=>[w(v,{size:"large"},{default:z(()=>[J(I(i.value.icon),1)]),_:1})]),_:1},8,["variant","disabled","color"])],64)}}},Je={class:"text-white"},Ge={__name:"PanelMainSlider",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=G(),i=N();function s(a){i.value=a}const o=S(()=>{let a=n.handleDefs(t.el.slider,["cmd","current","color","min","max","steps","reverse","size","vertical"],["",0,"",0,100,10,!1,4,!1],!1,null,!0);return/%v/.test(a.current)&&(a.current=a.current.replace("%v",i.value)),s(a.current),a});let u=null;function r(a){let l=o.value.cmd,c=/\./.exec(o.value.steps),v=0,x=[];c&&(v=o.value.steps.slice(c.index).length-1),l=l.replace("%v",a.toFixed(v));for(const C of t.devices)x=C.split(":"),RegExp(x[0]).test(l)&&(l=l.replace(x[0],x[1]));clearTimeout(u),u=setTimeout(()=>{n.request("text",l)},500)}return(a,l)=>{const c=y("v-slider");return p(),E(c,{modelValue:i.value,"onUpdate:modelValue":[l[0]||(l[0]=v=>i.value=v),l[1]||(l[1]=v=>r(v))],min:o.value.min,max:o.value.max,step:o.value.steps,reverse:o.value.reverse,direction:o.value.vertical?"vertical":"horizontal","track-size":o.value.size,color:o.value.color,"hide-details":"","thumb-label":""},{"thumb-label":z(({modelValue:v})=>[ge("div",Je,I(v),1)]),_:1},8,["modelValue","min","max","step","reverse","direction","track-size","color"])}}},Ze={__name:"PanelMainImage",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=G(),i=N(!1),s=S(()=>n.handleDefs(t.el.image,["source","height"],["",null]));return(o,u)=>{const r=y("v-skeleton-loader"),a=y("v-img");return p(),P(Y,null,[i.value?b("",!0):(p(),E(r,{key:0,type:"image"})),w(a,{src:s.value.source,height:s.value.height,onLoad:u[0]||(u[0]=l=>i.value=!0)},null,8,["src","height"])],64)}}},$e={__name:"PanelMainMenu",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=G(),i=N([]);ee(t.el,r=>{o()});const s=S(()=>{let r=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["mdi-dots-vertical",!1,"","text"]);return r.icon&&(r.icon=n.getIcon(r.icon,t.iconmap)),r});async function o(){let r=n.handleDefs(t.el.menu,["name","cmd","convert"],["","",null],!0,","),a,l,c;for(const v of r){a=/^get/.test(v.name)?await u(v.name):v.name;for(const x of[",","|",`
`])RegExp(x).test(a)&&(l=x);for(const x of a.split(l))x&&(c=x,/%v/.test(v.cmd)&&v.convert==="regExp"&&(c=RegExp(x.replace(/[^a-z,^A-Z]/g,"."))),i.value.push({name:x,cmd:v.cmd.replace(/%v/g,c)}))}}async function u(r){let a=[];for(const l of t.devices)a=l.split(":"),RegExp(a[0]).test(r)&&(r=r.replace(a[0],a[1]));return n.request("text",r)}return o(),(r,a)=>{const l=y("v-icon"),c=y("v-btn"),v=y("v-list-item-title"),x=y("v-list-item"),C=y("v-list"),g=y("v-menu");return p(),E(g,null,{activator:z(({props:_})=>[w(c,ae(_,{icon:"",variant:s.value.variant,disabled:s.value.disabled||i.value.length<1,color:s.value.color,class:"my-2"}),{default:z(()=>[w(l,{size:"large"},{default:z(()=>[J(I(s.value.icon),1)]),_:1})]),_:2},1040,["variant","disabled","color"])]),default:z(()=>[w(C,null,{default:z(()=>[(p(!0),P(Y,null,_e(i.value,(_,h)=>(p(),E(x,{key:h,value:h,onClick:f=>u(_.cmd)},{default:z(()=>[w(v,null,{default:z(()=>[J(I(_.name),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})}}};var ve=null;function Ye(e){return ve||(ve=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),ve(e)}var fe=null;function Xe(e){fe||(fe=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),fe(e)}function Qe(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function oe(e,t){t===void 0&&(t={});var n=document.createElement(e);return Object.keys(t).forEach(function(i){n[i]=t[i]}),n}function Oe(e,t,n){var i=window.getComputedStyle(e,n||null)||{display:"none"};return i[t]}function pe(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(Oe(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var et='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',he=0,ue=null;function tt(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=rt.bind(e));var n=e.__resize_listeners__;if(!n){if(e.__resize_listeners__=[],window.ResizeObserver){var i=e.offsetWidth,s=e.offsetHeight,o=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===i&&e.offsetHeight===s)||ce(e)}),u=pe(e),r=u.detached,a=u.rendered;e.__resize_observer_triggered__=r===!1&&a===!1,e.__resize_observer__=o,o.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){ce(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(he||(ue=Qe(et)),it(e),e.__resize_rendered__=pe(e).rendered,window.MutationObserver){var l=new MutationObserver(e.__resize_mutation_handler__);l.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=l}}e.__resize_listeners__.push(t),he++}function nt(e,t){var n=e.__resize_listeners__;if(n){if(t&&n.splice(n.indexOf(t),1),!n.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",ye),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--he&&ue&&ue.parentNode.removeChild(ue)}}function at(e){var t=e.__resize_last__,n=t.width,i=t.height,s=e.offsetWidth,o=e.offsetHeight;return s!==n||o!==i?{width:s,height:o}:null}function rt(){var e=pe(this),t=e.rendered,n=e.detached;t!==this.__resize_rendered__&&(!n&&this.__resize_triggers__&&(be(this),this.addEventListener("scroll",ye,!0)),this.__resize_rendered__=t,ce(this))}function ye(){var e=this;be(this),this.__resize_raf__&&Xe(this.__resize_raf__),this.__resize_raf__=Ye(function(){var t=at(e);t&&(e.__resize_last__=t,ce(e))})}function ce(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function it(e){var t=Oe(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var n=oe("div",{className:"resize-triggers"}),i=oe("div",{className:"resize-expand-trigger"}),s=oe("div"),o=oe("div",{className:"resize-contract-trigger"});i.appendChild(s),n.appendChild(i),n.appendChild(o),e.appendChild(n),e.__resize_triggers__={triggers:n,expand:i,expandChild:s,contract:o},be(e),e.addEventListener("scroll",ye,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function be(e){var t=e.__resize_triggers__,n=t.expand,i=t.expandChild,s=t.contract,o=s.scrollWidth,u=s.scrollHeight,r=n.offsetWidth,a=n.offsetHeight,l=n.scrollWidth,c=n.scrollHeight;s.scrollLeft=o,s.scrollTop=u,i.style.width=r+1+"px",i.style.height=a+1+"px",n.scrollLeft=l,n.scrollTop=c}var K=function(){return K=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},K.apply(this,arguments)};var lt=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function ot(e){return t=Object.create(null),lt.forEach(function(n){t[n]=function(i){return function(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[i].apply(e.value,s)}}(n)}),t;var t}var st={autoresize:[Boolean,Object]},ut=/^on[^a-z]/,ct=function(e){return ut.test(e)};function se(e,t){var n=B(e);return n&&typeof n=="object"&&"value"in n?n.value||t:n||t}var dt="ecLoadingOptions",vt={loading:Boolean,loadingOptions:Object},te=null,Re="x-vue-echarts",Ce=[],ne=[];(function(e,t){if(e&&typeof document<"u"){var n,i=t.prepend===!0?"prepend":"append",s=t.singleTag===!0,o=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(s){var u=Ce.indexOf(o);u===-1&&(u=Ce.push(o)-1,ne[u]={}),n=ne[u]&&ne[u][i]?ne[u][i]:ne[u][i]=r()}else n=r();e.charCodeAt(0)===65279&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function r(){var a=document.createElement("style");if(a.setAttribute("type","text/css"),t.attributes)for(var l=Object.keys(t.attributes),c=0;c<l.length;c++)a.setAttribute(l[c],t.attributes[l[c]]);var v=i==="prepend"?"afterbegin":"beforeend";return o.insertAdjacentElement(v,a),a}})(`x-vue-echarts,.echarts-inner{display:block;width:100%;height:100%;min-width:0}
`,{});var ft=function(){if(te!=null)return te;if(typeof HTMLElement>"u"||typeof customElements>"u")return te=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)(Re)}catch{return te=!1}return te=!0}(),mt="ecTheme",_t="ecInitOptions",pt="ecUpdateOptions",ht=Ae({name:"echarts",props:K(K({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},st),vt),emits:{},inheritAttrs:!1,setup:function(e,t){var n=t.attrs,i=ie(),s=ie(),o=ie(),u=ie(),r=le(mt,null),a=le(_t,null),l=le(pt,null),c=Me(e),v=c.autoresize,x=c.manualUpdate,C=c.loading,g=c.loadingOptions,_=S(function(){return u.value||e.option||null}),h=S(function(){return e.theme||se(r,{})}),f=S(function(){return e.initOptions||se(a,{})}),A=S(function(){return e.updateOptions||se(l,{})}),m=S(function(){return function(L){var R={};for(var j in L)ct(j)||(R[j]=L[j]);return R}(n)}),V=Ve().proxy.$listeners;function k(L){if(s.value){var R=o.value=Pe(s.value,h.value,f.value);e.group&&(R.group=e.group);var j=V;j||(j={},Object.keys(n).filter(function(T){return T.indexOf("on")===0&&T.length>2}).forEach(function(T){var M=T.charAt(2).toLowerCase()+T.slice(3);M.substring(M.length-4)==="Once"&&(M="~".concat(M.substring(0,M.length-4))),j[M]=n[T]})),Object.keys(j).forEach(function(T){var M=j[T];if(M){var U=T.toLowerCase();U.charAt(0)==="~"&&(U=U.substring(1),M.__once__=!0);var F=R;if(U.indexOf("zr:")===0&&(F=R.getZr(),U=U.substring(3)),M.__once__){delete M.__once__;var X=M;M=function(){for(var Z=[],W=0;W<arguments.length;W++)Z[W]=arguments[W];X.apply(void 0,Z),F.off(U,M)}}F.on(U,M)}}),v.value?Te(function(){R&&!R.isDisposed()&&R.resize(),H()}):H()}function H(){var T=L||_.value;T&&R.setOption(T,A.value)}}function O(){o.value&&(o.value.dispose(),o.value=void 0)}var d=null;ee(x,function(L){typeof d=="function"&&(d(),d=null),L||(d=ee(function(){return e.option},function(R,j){R&&(o.value?o.value.setOption(R,K({notMerge:R!==j},A.value)):k())},{deep:!0}))},{immediate:!0}),ee([h,f],function(){O(),k()},{deep:!0}),ke(function(){e.group&&o.value&&(o.value.group=e.group)});var D=ot(o);return function(L,R,j){var H=le(dt,{}),T=S(function(){return K(K({},se(H,{})),j==null?void 0:j.value)});ke(function(){var M=L.value;M&&(R.value?M.showLoading(T.value):M.hideLoading())})}(o,C,g),function(L,R,j){var H=null;ee([j,L,R],function(T,M,U){var F=T[0],X=T[1],Z=T[2];if(F&&X&&Z){var W=Z===!0?{}:Z,re=W.throttle,$=re===void 0?100:re,we=W.onResize,ze=function(){X.resize(),we==null||we()};H=$?je(ze,$):ze,tt(F,H)}U(function(){F&&H&&nt(F,H)})})}(o,v,s),xe(function(){k()}),Le(function(){ft&&i.value?i.value.__dispose=O:O()}),K({chart:o,root:i,inner:s,setOption:function(L,R){e.manualUpdate&&(u.value=L),o.value?o.value.setOption(L,R||{}):k(L)},nonEventAttrs:m},D)},render:function(){var e=K({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",Se(Re,e,[Se("div",{ref:"inner",class:"echarts-inner"})])}});const gt={key:0,class:"mx-4 my-4 text-right"},xt={__name:"PanelMainChart",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=G(),i=Ie(),{mobile:s}=Fe(),o=Ne(),u=N({}),r=N({from:null,to:null,fromMenu:!1,toMenu:!1,loaded:!1});let a=[];const l=S(()=>(C(),"height: "+(/=maximized$/.test(n.app.currentView)?window.innerHeight-250+"px":t.height)));function c(g){return o.d(g,{dateStyle:s.value?"short":"long"})}function v(g,_){let h;return r.value.from&&_&&(h=r.value.from),r.value.to&&!_&&(h=r.value.to),!h&&!isNaN(g)&&(h=(f=>new Date(f.setDate(f.getDate()+(Number(g)||0))))(new Date)),h||(h=new Date(/.*T.*/.test(g)?g:g+"T00:00:00")),!r.value.from&&_&&(r.value.from=h),!r.value.to&&!_&&(r.value.to=h),h=new Date(h.getTime()-h.getTimezoneOffset()*60*1e3),h.toISOString().split("T")[0]}async function x(){let g=n.handleDefs(t.el.serie,["data","name","digits","suffix","type"],[null,"",0,"","line"],!0),_,h,f=[],A,m,V,k,O,d=[];if(g.length>0)for(const D of g){if(/^get.*/.test(D.data)){O="time",_=D.data.split(" ");for(const L of t.devices)L.split(":")[0]===_[1]&&(_[1]=L.split(":")[1]);if(_[4]=v(_[4],!0),_[5]=v(_[5],!1),h=await n.request("text",_.join(" ")),k=[],f=h.split(`
`),f.length>0)for(const L of f)A=L.split(" "),A.length>1&&(m=new Date(A[0].replace("_","T")),V=parseFloat(A[1]).toFixed(D.digits),k.push([m,V]))}else/^\[.*\]/.test(D.data)?k=n.stringToJson(D.data):k=[n.replacer("%n("+D.digits+")",D.data,!0)];d.push({xAxisType:O,type:D.type,name:D.name,digits:D.digits,suffix:D.suffix,data:k})}return d}async function C(){let g={tooltip:{trigger:"axis"},legend:{data:[],bottom:10},backgroundColor:"rgba(255, 255, 255, 0)",grid:{top:30,bottom:60,left:60,right:60},animationDuration:300,series:[],yAxis:[],xAxis:{}},_=JSON.parse(JSON.stringify(n.getEl(t.el,["options"])||{})),h=JSON.parse(JSON.stringify(n.getEl(t.el,["options2"])||{})),f=Object.assign(g,/=maximized$/.test(n.app.currentView)&&Object.keys(h).length>0?h:_),A;r.value.fromMenu=!1,r.value.toMenu=!1,r.value.loaded=!1,a=await x();for(const[m,V]of Object.entries(a))A={formatter:k=>k.toLocaleString(o.locale.value,{minimumFractionDigits:V.digits,maximumFractionDigits:V.digits})+V.suffix},f.series[m]||(f.series[m]={}),f.yAxis[m]||(f.yAxis[m]={}),f.legend.data||(f.legend.data=[]),f.xAxis.type||(f.xAxis.type=V.xAxisType),f.yAxis[m].type||(f.yAxis[m].type="value"),f.yAxis[m].axisLabel||(f.yAxis[m].axisLabel={}),f.yAxis[m].axisLabel.formatter||(f.yAxis[m].axisLabel.formatter=A.formatter),f.legend.data[m]||(f.legend.data[m]=V.name),f.series[m].name||(f.series[m].name=V.name),f.series[m].type||(f.series[m].type=V.type),f.series[m].data||(f.series[m].data=V.data),f.series[m].detail||(f.series[m].detail={}),f.series[m].detail.formatter||(f.series[m].detail.formatter=A.formatter),f.series[m].tooltip||(f.series[m].tooltip={}),f.series[m].tooltip.valueFormatter||(f.series[m].tooltip.valueFormatter=A.formatter);n.log(7,"Chartdata chart.loaded.",f),u.value=Object.assign({},f),r.value.loaded=!0}return(g,_)=>{const h=y("v-btn"),f=y("v-date-picker"),A=y("v-locale-provider"),m=y("v-menu"),V=y("v-skeleton-loader");return p(),P(Y,null,[/=maximized$/.test(B(n).app.currentView)?(p(),P("div",gt,[w(m,{modelValue:r.value.fromMenu,"onUpdate:modelValue":_[2]||(_[2]=k=>r.value.fromMenu=k),"close-on-content-click":!1},{activator:z(({props:k})=>[w(h,ae(k,{variant:"outlined","append-icon":"mdi-calendar",class:"mr-2"}),{default:z(()=>[J(I(c(r.value.from)),1)]),_:2},1040)]),default:z(()=>[w(A,{locale:B(o).locale.value},{default:z(()=>[w(f,{modelValue:r.value.from,"onUpdate:modelValue":[_[0]||(_[0]=k=>r.value.from=k),_[1]||(_[1]=k=>C())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"]),J(" - "),w(m,{modelValue:r.value.toMenu,"onUpdate:modelValue":_[5]||(_[5]=k=>r.value.toMenu=k),"close-on-content-click":!1},{activator:z(({props:k})=>[w(h,ae(k,{variant:"outlined","append-icon":"mdi-calendar",class:"ml-2"}),{default:z(()=>[J(I(c(r.value.to)),1)]),_:2},1040)]),default:z(()=>[w(A,{locale:B(o).locale.value},{default:z(()=>[w(f,{modelValue:r.value.to,"onUpdate:modelValue":[_[3]||(_[3]=k=>r.value.to=k),_[4]||(_[4]=k=>C())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"])])):b("",!0),ge("div",{style:Ue(l.value)},[r.value.loaded?b("",!0):(p(),E(V,{key:0,type:"text, image, text"})),r.value.loaded?(p(),E(B(ht),{key:1,option:u.value,theme:B(i).global.name.value==="dark"?"dark":"light",autoresize:""},null,8,["option","theme"])):b("",!0)],4)],64)}}},yt=180/Math.PI,Ee=e=>{const t=e%360;return t<0?360+t:t},bt=({x:e,y:t},n)=>{const i=n.left+n.width/2,s=n.top+n.height/2;return Math.atan2(t-s,e-i)*yt},me=()=>{};class wt{constructor(t,n){this.active=!1,this.element=t,this.element.style.willChange="transform",this.initOptions(n),this.updateCSS(),this.bindHandlers(),this.addListeners()}get angle(){return this._angle}set angle(t){this._angle!==t&&(this._angle=Ee(t),this.updateCSS())}initOptions(t){t=t||{},this.onRotate=t.onRotate||me,this.onDragStart=t.onDragStart||me,this.onDragStop=t.onDragStop||me,this._angle=t.angle||0}bindHandlers(){this.onRotationStart=this.onRotationStart.bind(this),this.onRotated=this.onRotated.bind(this),this.onRotationStop=this.onRotationStop.bind(this)}addListeners(){this.element.addEventListener("touchstart",this.onRotationStart,{passive:!0}),document.addEventListener("touchmove",this.onRotated,{passive:!1}),document.addEventListener("touchend",this.onRotationStop,{passive:!0}),document.addEventListener("touchcancel",this.onRotationStop,{passive:!0}),this.element.addEventListener("mousedown",this.onRotationStart,{passive:!0}),document.addEventListener("mousemove",this.onRotated,{passive:!1}),document.addEventListener("mouseup",this.onRotationStop,{passive:!0}),document.addEventListener("mouseleave",this.onRotationStop,{passive:!1})}removeListeners(){this.element.removeEventListener("touchstart",this.onRotationStart),document.removeEventListener("touchmove",this.onRotated),document.removeEventListener("touchend",this.onRotationStop),document.removeEventListener("touchcancel",this.onRotationStop),this.element.removeEventListener("mousedown",this.onRotationStart),document.removeEventListener("mousemove",this.onRotated),document.removeEventListener("mouseup",this.onRotationStop),document.removeEventListener("mouseleave",this.onRotationStop)}destroy(){this.onRotationStop(),this.removeListeners()}onRotationStart(t){(t.type==="touchstart"||t.button===0)&&(this.active=!0,this.onDragStart(t),this.setAngleFromEvent(t))}onRotationStop(){this.active&&(this.active=!1,this.onDragStop()),this.active=!1}onRotated(t){this.active&&(t.preventDefault(),this.setAngleFromEvent(t))}setAngleFromEvent(t){const n=t.targetTouches?t.targetTouches[0]:t,i=bt({x:n.clientX,y:n.clientY},this.element.getBoundingClientRect());this._angle=Ee(i+90),this.updateCSS(),this.onRotate(this._angle)}updateCSS(){this.element.style.transform="rotate("+this._angle+"deg)"}}const zt=["red","yellow","green","cyan","blue","magenta","red"],De={ArrowUp:(e,t)=>e+t,ArrowRight:(e,t)=>e+t,ArrowDown:(e,t)=>e-t,ArrowLeft:(e,t)=>e-t,PageUp:(e,t)=>e+t*10,PageDown:(e,t)=>e-t*10,Home:()=>0,End:()=>359},de={name:"ColorPicker",emits:["select","input","change"],props:{hue:{default:0},saturation:{default:100},luminosity:{default:50},alpha:{default:1},step:{default:1},mouseScroll:{default:!1},variant:{default:"collapsible"},disabled:{default:!1},initiallyCollapsed:{default:!1},ariaLabel:{default:"color picker"},ariaRoledescription:{default:"radial slider"},ariaValuetext:{default:""},ariaLabelColorWell:{default:"color well"}},setup(e,{emit:t}){const n=N(null),i=N(null);let s=null;const o=e.hue+"deg",u=N(e.hue),r=N(!e.initiallyCollapsed),a=N(!e.initiallyCollapsed),l=N(!1),c=N(!1),v=N(!1),x=S(()=>`hsla(${u.value}, ${e.saturation}%, ${e.luminosity}%, ${e.alpha})`),C=S(()=>zt[Math.round(u.value/60)]);return ee(()=>e.hue,m=>{u.value=m,s.angle=m}),xe(()=>{s=new wt(i.value,{angle:u.value,onRotate(m){u.value=m,t("input",u.value)},onDragStart(){v.value=!0},onDragStop(){v.value=!1,t("change",u.value)}})}),Le(()=>{s.destroy(),s=null}),{rcp:s,el:n,rotator:i,initialAngle:o,angle:u,isPaletteIn:r,isKnobIn:a,isDragging:v,isRippling:c,isPressed:l,color:x,valuetext:C,onKeyDown:m=>{e.disabled||l.value||!a.value||!(m.key in De)||(m.preventDefault(),s.angle=De[m.key](s.angle,e.step),u.value=s.angle,t("input",u.value),t("change",u.value))},onScroll:m=>{l.value||!a.value||(m.preventDefault(),m.deltaY>0?s.angle+=e.step:s.angle-=e.step,u.value=s.angle,t("input",u.value),t("change",u.value))},selectColor:()=>{l.value=!0,r.value&&a.value?(t("select",u.value),c.value=!0):r.value=!0},togglePicker:()=>{e.variant!=="persistent"&&(a.value?a.value=!1:(a.value=!0,r.value=!0)),c.value=!1,l.value=!1},hidePalette:()=>{a.value||(r.value=!1)}}}};function kt(e,t,n,i,s,o){return p(),E("div",{ref:"el",role:"slider","aria-roledescription":n.ariaRoledescription,"aria-label":n.ariaLabel,"aria-expanded":i.isPaletteIn,"aria-valuemin":"0","aria-valuemax":"359","aria-valuenow":i.angle,"aria-valuetext":n.ariaValuetext||i.valuetext,"aria-disabled":n.disabled,class:["rcp",{dragging:i.isDragging,disabled:n.disabled}],tabindex:n.disabled?-1:0,style:{"--rcp-initial-angle":i.initialAngle},onKeyup:t[4]||(t[4]=qe((...u)=>i.selectColor&&i.selectColor(...u),["enter"])),onKeydown:t[5]||(t[5]=(...u)=>i.onKeyDown&&i.onKeyDown(...u))},[w("div",{class:["rcp__palette",i.isPaletteIn?"in":"out"]},null,2),w("div",ae({class:"rcp__rotator",style:{"pointer-events":n.disabled||i.isPressed||!i.isKnobIn?"none":null}},He(n.mouseScroll?{wheel:i.onScroll}:{}),{ref:"rotator"}),[w("div",{class:["rcp__knob",i.isKnobIn?"in":"out"],onTransitionend:t[1]||(t[1]=(...u)=>i.hidePalette&&i.hidePalette(...u))},null,34)],16),w("div",{class:["rcp__ripple",{rippling:i.isRippling}],style:{borderColor:i.color}},null,6),w("button",{type:"button",class:["rcp__well",{pressed:i.isPressed}],"aria-label":n.ariaLabelColorWell,disabled:n.disabled,tabindex:n.disabled?-1:0,style:{backgroundColor:i.color},onAnimationend:t[2]||(t[2]=(...u)=>i.togglePicker&&i.togglePicker(...u)),onClick:t[3]||(t[3]=(...u)=>i.selectColor&&i.selectColor(...u))},null,46,["aria-label","disabled","tabindex"])],46,["aria-roledescription","aria-label","aria-expanded","aria-valuenow","aria-valuetext","aria-disabled","tabindex"])}de.render=kt;de.install=function(e){e.component("ColorPicker",de)};const St={class:"mt-4 mb-2"},Ct={__name:"PanelMainColorpicker",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=G(),i=S(()=>n.handleDefs(t.el.picker,["cmd","current"],["",!1]));function s(r){let a=o(r,50,100),l=i.value.cmd,c=[];l=l.replace("%v",a);for(const v of t.devices)c=v.split(":"),RegExp(c[0]).test(l)&&(l=l.replace(c[0],c[1]));n.request("text",l)}function o(r,a,l){a/=100;const c=l*Math.min(a,1-a)/100,v=x=>{const C=(x+r/30)%12,g=a-c*Math.max(Math.min(C-3,9-C,1),-1);return Math.round(255*g).toString(16).padStart(2,"0")};return`${v(0)}${v(8)}${v(4)}`}function u(r){r.split(" ").length>1&&(r=r.split(" ").slice(-1)[0]),r=r.replace(/^#/,"");let a=parseInt(r,16),l=a>>16&255,c=a>>8&255,v=a&255;l/=255,c/=255,v/=255;let x=Math.max(l,c,v),C=Math.min(l,c,v),g=x-C,_=(x+C)/2,h=0,f=0;return g!==0&&(x===l?h=((c-v)/g+(c<v?6:0))%6:x===c?h=((v-l)/g+2)%6:h=((l-c)/g+4)%6,h=h*60,f=g/(1-Math.abs(2*_-1))),f=Math.round(f*100),_=Math.round(_*100),{hue:h,saturation:f,luminosity:_}}return(r,a)=>(p(),P("div",St,[w(B(de),ae(u(i.value.current),{variant:"persistent",onChange:a[0]||(a[0]=l=>s(l))}),null,16)]))}},Et={__name:"PanelMain",props:{main:Object,levels:Array,iconmap:Object,devices:Object},setup(e){const t=G();function n(r,a){return t.handleDefs(r[a].size,["size"],[!1]).size}function i(r){let a="";return["info"].indexOf(r)!==-1&&(a="mx-2"),a}function s(r,a){return r[a]?t.handleDefs(r[a].divider,["show"],[!1]).show:!1}function o(r){return r.level?t.handleDefs(r.level.height,["height"],["64px"]).height:"64px"}function u(r){if(r==="info")return We;if(r==="btn")return Ke;if(r==="slider")return Ge;if(r==="image")return Ze;if(r==="menu")return $e;if(r==="chart")return xt;if(r==="colorpicker")return Ct}return(r,a)=>{const l=y("v-sheet"),c=y("v-col"),v=y("v-divider"),x=y("v-row"),C=y("v-expand-transition");return p(!0),P(Y,null,_e(e.main,(g,_)=>(p(),P("div",{key:_},[w(C,null,{default:z(()=>[e.levels.indexOf(_)!==-1?(p(),E(x,{key:0,"no-gutters":"",class:"text-center align-center"},{default:z(()=>[w(l,{height:o(g,"level")},null,8,["height"]),(p(),P(Y,null,_e(["left1","left2","mid","right1","right2"],h=>(p(),P(Y,{key:h},[g.level[h]?(p(),E(c,{key:0,cols:n(g,h),class:q(i(g.level[h]))},{default:z(()=>[(p(),E(Be(u(g.level[h])),{el:g[h],iconmap:e.iconmap,devices:e.devices,height:o(g,"level")},null,8,["el","iconmap","devices","height"]))]),_:2},1032,["cols","class"])):b("",!0),s(g,h)?(p(),E(v,{key:1,vertical:""})):b("",!0)],64))),64)),s(g,"level")?(p(),E(v,{key:0})):b("",!0)]),_:2},1024)):b("",!0)]),_:2},1024)]))),128)}}},Dt={key:1,class:"mx-2"},Ot={__name:"PanelCard",props:{panel:Object},setup(e){const t=e,n=G();let i=n.thread();xe(()=>n.thread(i));function s(O){let d=n.handleDefs(t.panel.status[O],["level","color","min","max","reverse"],[0,"success",0,100,!1]);return d.level=Math.round((d.level-d.min)/(d.max-d.min)*100),d}const o=S(()=>s("bar")),u=S(()=>s("bar2")),r=S(()=>n.handleDefs(t.panel.status.imageUrl,["url"],[""])),a=S(()=>n.handleDefs(t.panel.panel.sortby,["sortby"],[null])),l=S(()=>n.handleDefs(t.panel.status.title,["title"],[""])),c=N(n.handleDefs(t.panel.panel.expandable,["expandable","expanded","maximizable"],[!1,!1,!1]));ee(t.panel.main,O=>{let d=v(O);c.value.activeLevels.join("-")!==d.join("-")&&(c.value.activeLevels=d,x(!0))});function v(O){let d=[];for(const[D,L]of Object.entries(O))n.handleDefs(L.level.show,["show"],[!0]).show&&d.push(Number(D));return d}function x(O){let d=c.value,D;O?d.activeLevels=v(t.panel.main):(d.expandable&&(d.expanded=!d.expanded),d.maximizable&&(d.expanded?Q.push({name:"devices",params:{view:"panel="+t.panel.name+"=maximized"},query:Q.currentRoute.value.query}):Q.back())),d.expanded?d.levels=d.activeLevels:d.expandable||O?d.levels=[d.activeLevels[0]]:(D=d.activeLevels.indexOf(d.levels[0]),d.levels=[d.activeLevels[D+1]>=0?d.activeLevels[D+1]:d.activeLevels[0]]),d.activeLevels.length>1||d.maximizable?d.icon=d.expandable?d.expanded?"mdi-arrow-collapse":"mdi-arrow-expand":d.expanded?"":"mdi-swap-vertical":d.icon=""}function C(O){Q.push({name:"settings",params:{tab:"panels",item:O},query:Q.currentRoute.value.query})}function g(O){let d=n.handleDefs(t.panel.info[O],["text","icon","color"],["","",""]);return d.icon&&(d.icon=n.getIcon(d.icon,t.panel.panel.iconmap)),d}function _(O){let d=["left1","left2","mid1","mid2","right1","right2"],D=g(O);return g(d[d.indexOf(O)-1]).text&&D.text&&!D.icon?"ml-1 text-truncate":D.text?"text-truncate":""}const h=S(()=>g("left1")),f=S(()=>g("left2")),A=S(()=>g("mid1")),m=S(()=>g("mid2")),V=S(()=>g("right1")),k=S(()=>g("right2"));return x(!0),(O,d)=>{const D=y("v-progress-linear"),L=y("v-col"),R=y("v-row"),j=y("v-btn"),H=y("v-card-title"),T=y("v-img"),M=y("v-sheet"),U=y("v-card-text"),F=y("v-icon"),X=y("v-spacer"),Z=y("v-system-bar"),W=y("v-layout"),re=y("v-card");return B(n).app.isReady?(p(),E(re,{key:0,variant:"tonal"},{default:z(()=>[w(R,{"no-gutters":""},{default:z(()=>[e.panel.status.bar?(p(),E(L,{key:0},{default:z(()=>[w(D,{height:"7",modelValue:o.value.level,"onUpdate:modelValue":d[0]||(d[0]=$=>o.value.level=$),color:o.value.color,reverse:o.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):b("",!0),e.panel.status.bar2?(p(),E(L,{key:1},{default:z(()=>[w(D,{height:"7",modelValue:u.value.level,"onUpdate:modelValue":d[1]||(d[1]=$=>u.value.level=$),color:u.value.color,reverse:u.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):b("",!0)]),_:1}),w(M,{color:"primary"},{default:z(()=>[w(T,{src:r.value.url,gradient:r.value.url?B(n).app.header.imageGradient:"",height:"48",cover:""},{default:z(()=>[w(H,null,{default:z(()=>[w(R,{"no-gutters":"",class:"align-center"},{default:z(()=>[e.panel.status.title?(p(),E(L,{key:0,class:"text-truncate"},{default:z(()=>[J(I(l.value.title),1)]),_:1})):b("",!0),B(n).app.settings.loglevel>6?(p(),P("span",Dt,I(a.value.sortby),1)):b("",!0),B(n).app.settings.loglevel>6?(p(),E(j,{key:2,icon:"mdi-pencil",size:"small",variant:"plain",density:"compact",onClick:d[2]||(d[2]=$=>C(e.panel.name))})):b("",!0),c.value.icon?(p(),E(j,{key:3,icon:c.value.icon,size:"small",variant:"plain",density:"compact",onClick:d[3]||(d[3]=$=>x())},null,8,["icon"])):b("",!0)]),_:1})]),_:1})]),_:1},8,["src","gradient"])]),_:1}),w(Et,{main:e.panel.main,levels:c.value.levels,iconmap:e.panel.panel.iconmap,devices:e.panel.panel.devices},null,8,["main","levels","iconmap","devices"]),t.panel.internals?(p(),E(U,{key:0},{default:z(()=>[J(I(t.panel.internals),1)]),_:1})):b("",!0),w(W,{style:{height:"24px"}},{default:z(()=>[w(Z,{color:"secondary"},{default:z(()=>[h.value.icon?(p(),E(F,{key:0,icon:h.value.icon,color:h.value.color},null,8,["icon","color"])):b("",!0),h.value.text?(p(),P("span",{key:1,class:q(_("left1"))},I(h.value.text),3)):b("",!0),f.value.icon?(p(),E(F,{key:2,icon:f.value.icon,color:f.value.color},null,8,["icon","color"])):b("",!0),f.value.text?(p(),P("span",{key:3,class:q(_("left2"))},I(f.value.text),3)):b("",!0),w(X),A.value.icon?(p(),E(F,{key:4,icon:A.value.icon,color:A.value.color},null,8,["icon","color"])):b("",!0),A.value.text?(p(),P("span",{key:5,class:q(_("mid1"))},I(A.value.text),3)):b("",!0),m.value.icon?(p(),E(F,{key:6,icon:m.value.icon,color:m.value.color},null,8,["icon","color"])):b("",!0),m.value.text?(p(),P("span",{key:7,class:q(_("mid2"))},I(m.value.text),3)):b("",!0),w(X),V.value.icon?(p(),E(F,{key:8,icon:V.value.icon,color:V.value.color},null,8,["icon","color"])):b("",!0),V.value.text?(p(),P("span",{key:9,class:q(_("right1"))},I(V.value.text),3)):b("",!0),k.value.icon?(p(),E(F,{key:10,icon:k.value.icon,color:k.value.color},null,8,["icon","color"])):b("",!0),k.value.text?(p(),P("span",{key:11,class:q(_("right2"))},I(k.value.text),3)):b("",!0)]),_:1})]),_:1})]),_:1})):b("",!0)}}};export{Ot as _};
