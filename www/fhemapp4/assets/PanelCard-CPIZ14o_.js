import{u as J,c as O,r as h,o as p,b as M,at as H,b5 as V,A as E,a as D,w as b,O as K,G as Q,F as Y,e as z,bH as ne,aQ as U,bu as ae,ar as ie,d as he,U as Ie,af as de,ba as Ue,a5 as He,bv as Oe,aC as ke,ay as Ve,a9 as Ee,b1 as ve,bI as Ne,as as qe,ak as $e,be as Z,bJ as Be,bK as We,bF as Ke,bG as Je,av as pe,b7 as Ge,bB as Ze,aV as Qe}from"./index-BX4CvJnf.js";const Ye={__name:"PanelMainInfo",props:{el:Object,iconmap:Array,devices:Object,height:String},setup(e){const t=e,n=J(),a=O(()=>n.handleDefs(t.el.text,["text","format"],["",!t.el.text2&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),d=O(()=>n.handleDefs(t.el.text2,["text","format"],["",t.el.text&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),r=O(()=>n.handleDefs(t.el.text3,["text","format"],["","text-caption"])),f=O(()=>{let o=n.handleDefs(t.el.icon,["icon","color","size"],["","","x-large"]);return o.icon&&(o.icon=n.getIcon(o.icon,t.iconmap)),o}),i=O(()=>{let o=n.handleDefs(t.el.status,["level","color","min","max","reverse","linear"],[0,"success",0,100,!1,!1]);return o.level=Math.round((o.level-o.min)/(o.max-o.min)*100),o.reverse=!!o.reverse,o});return(o,l)=>{const u=h("v-icon"),v=h("v-progress-circular"),g=h("v-progress-linear");return p(),M(Y,null,[e.el.text?(p(),M("div",{key:0,class:H(a.value.format)},V(a.value.text),3)):E("",!0),e.el.icon?(p(),D(u,{key:1,color:f.value.color,size:f.value.size},{default:b(()=>[K(V(f.value.icon),1)]),_:1},8,["color","size"])):E("",!0),e.el.status&&!i.value.linear?(p(),D(v,{key:2,width:"4",modelValue:i.value.level,"onUpdate:modelValue":l[0]||(l[0]=k=>i.value.level=k),color:i.value.color,reverse:i.value.reverse},null,8,["modelValue","color","reverse"])):E("",!0),e.el.status&&i.value.linear?(p(),D(g,{key:3,height:"7",rounded:"",modelValue:i.value.level,"onUpdate:modelValue":l[1]||(l[1]=k=>i.value.level=k),color:i.value.color,reverse:i.value.reverse},null,8,["modelValue","color","reverse"])):E("",!0),Q("div",{class:H(e.el.text2?d.value.format:r.value.format)},[e.el.text2?(p(),M("span",{key:0,class:H(d.value.format)},V(d.value.text),3)):E("",!0),e.el.text3?(p(),M("span",{key:1,class:H(r.value.format)},V(r.value.text),3)):E("",!0)],2)],64)}}},Xe={__name:"PanelMainBtn",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=J(),a=O(()=>{let o=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["",!1,"","text"]);return o.icon&&(o.icon=n.getIcon(o.icon,t.iconmap)),o}),d=O(()=>{let o=n.handleDefs(t.el.status,["level","color","min","max","reverse"],[0,"success",0,100,!1]);return o.level=Math.round((o.level-o.min)/(o.max-o.min)*100),o.reverse=!!o.reverse,o}),r={timer:!1,long:!1};function f(o){let l=[];if(o.cmd){if(o.type==="cmd"){l=o.cmd.split(";");for(const[u]of Object.entries(l))for(const v of t.devices)l[u]=l[u].replace(" "+v.split(":")[0]+" "," "+v.split(":")[1]+" ");n.request("text",l.join(";"))}o.type==="route"&&ne.push({name:"devices",params:{view:o.cmd},query:ne.currentRoute.value.query}),o.type==="url"&&window.open(o.cmd,"_self")}}function i(o){let l=n.handleDefs(t.el.click,["cmd","type"],["","cmd"],!1,null,!0),u=n.handleDefs(t.el.longClick,["cmd","type"],["","cmd"],!1,null,!0),v=n.handleDefs(t.el.longRelease,["cmd","type"],["","cmd"],!1,null,!0),g="ontouchstart"in document;(!g&&o==="mouseStart"||o==="touchStart")&&(r.timer=setTimeout(()=>{r.long=!0,u.cmd&&f(u)},1e3)),(!g&&o==="mouseEnd"||o==="touchEnd")&&(r.long?v.cmd&&f(v):l.cmd&&f(l),clearTimeout(r.timer),r.long=!1)}return(o,l)=>{const u=h("v-progress-linear"),v=h("v-icon"),g=h("v-btn");return p(),M(Y,null,[e.el.status?(p(),D(u,{key:0,height:"4",modelValue:d.value.level,"onUpdate:modelValue":l[0]||(l[0]=k=>d.value.level=k),color:d.value.color,reverse:d.value.reverse},null,8,["modelValue","color","reverse"])):E("",!0),z(g,{icon:"",variant:a.value.variant,disabled:a.value.disabled,color:a.value.color,onMousedown:l[1]||(l[1]=k=>i("mouseStart")),onTouchstart:l[2]||(l[2]=k=>i("touchStart")),onMouseup:l[3]||(l[3]=k=>i("mouseEnd")),onTouchend:l[4]||(l[4]=k=>i("touchEnd")),class:"my-2"},{default:b(()=>[z(v,{size:"large"},{default:b(()=>[K(V(a.value.icon),1)]),_:1})]),_:1},8,["variant","disabled","color"])],64)}}},et={class:"text-white"},tt={__name:"PanelMainSlider",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=J(),a=U();function d(o){a.value=o}const r=O(()=>{let o=n.handleDefs(t.el.slider,["cmd","current","color","min","max","steps","reverse","size","vertical"],["",0,"",0,100,10,!1,4,!1],!1,null,!0);return/%v/.test(o.current)&&(o.current=o.current.replace("%v",a.value)),d(o.current),o});let f=null;function i(o){let l=r.value.cmd,u=/\./.exec(r.value.steps),v=0;u&&(v=r.value.steps.slice(u.index).length-1),l=l.replace("%v",o.toFixed(v));for(const g of t.devices)l=l.replace(" "+g.split(":")[0]+" "," "+g.split(":")[1]+" ");clearTimeout(f),f=setTimeout(()=>{n.request("text",l)},500)}return(o,l)=>{const u=h("v-slider");return p(),D(u,{modelValue:a.value,"onUpdate:modelValue":[l[0]||(l[0]=v=>a.value=v),l[1]||(l[1]=v=>i(v))],min:r.value.min,max:r.value.max,step:r.value.steps,reverse:r.value.reverse,direction:r.value.vertical?"vertical":"horizontal","track-size":r.value.size,color:r.value.color,"hide-details":"","thumb-label":""},{"thumb-label":b(({modelValue:v})=>[Q("div",et,V(v),1)]),_:1},8,["modelValue","min","max","step","reverse","direction","track-size","color"])}}},nt={__name:"PanelMainImage",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=J(),a=U(!1),d=O(()=>n.handleDefs(t.el.image,["source","height"],["","auto"])),r=O(()=>({height:/=maximized$/.test(n.app.currentView)?window.innerHeight-170:d.value.height||t.height}));return(f,i)=>{const o=h("v-skeleton-loader"),l=h("v-img");return p(),M(Y,null,[a.value?E("",!0):(p(),D(o,{key:0,type:"image"})),z(l,{src:d.value.source,height:r.value.height,onLoad:i[0]||(i[0]=u=>a.value=!0)},null,8,["src","height"])],64)}}},at=["src","width","height"],it={__name:"PanelMainIframe",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=J(),a=U(),d=O(()=>n.handleDefs(t.el.iframe,["source"],[""])),r=O(()=>({width:a.value&&a.value.scrollWidth?a.value.scrollWidth:0,height:/=maximized$/.test(n.app.currentView)?window.innerHeight-170:t.height}));return(f,i)=>(p(),M("div",{ref_key:"extContent",ref:a},[Q("iframe",{src:d.value.source,width:r.value.width,height:r.value.height,loading:"lazy",style:{border:"none"}},null,8,at)],512))}},ot={__name:"PanelMainMenu",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=J(),a=U([]);ae(t.el,i=>{r()});const d=O(()=>{let i=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["mdi-dots-vertical",!1,"","text"]);return i.icon&&(i.icon=n.getIcon(i.icon,t.iconmap)),i});async function r(){let i=n.handleDefs(t.el.menu,["name","cmd","convert"],["","",null],!0,","),o,l,u;a.value=[];for(const v of i){o=/^get/.test(v.name)?await f(v.name):v.name;for(const g of[",","|",`
`])RegExp(g).test(o)&&(l=g);for(const g of o.split(l))g&&(u=g,/%v/.test(v.cmd)&&v.convert==="regExp"&&(u=RegExp(g.replace(/[^a-z,^A-Z]/g,"."))),a.value.push({name:g,cmd:v.cmd.replace(/%v/g,u)}))}}async function f(i){let o=[];o=i.split(";");for(const[l]of Object.entries(o))for(const u of t.devices)o[l]=o[l].replace(" "+u.split(":")[0]+" "," "+u.split(":")[1]+" ");return n.request("text",o.join(";"))}return r(),(i,o)=>{const l=h("v-icon"),u=h("v-btn"),v=h("v-list-item-title"),g=h("v-list-item"),k=h("v-list"),y=h("v-menu");return p(),D(y,null,{activator:b(({props:_})=>[z(u,ie(_,{icon:"",variant:d.value.variant,disabled:d.value.disabled||a.value.length<1,color:d.value.color,class:"my-2"}),{default:b(()=>[z(l,{size:"large"},{default:b(()=>[K(V(d.value.icon),1)]),_:1})]),_:2},1040,["variant","disabled","color"])]),default:b(()=>[z(k,null,{default:b(()=>[(p(!0),M(Y,null,he(a.value,(_,m)=>(p(),D(g,{key:m,value:m,onClick:c=>f(_.cmd)},{default:b(()=>[z(v,null,{default:b(()=>[K(V(_.name),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})}}};var xe=null;function rt(e){return xe||(xe=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),xe(e)}var ye=null;function lt(e){ye||(ye=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),ye(e)}function st(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function fe(e,t){t===void 0&&(t={});var n=document.createElement(e);return Object.keys(t).forEach(function(a){n[a]=t[a]}),n}function Te(e,t,n){var a=window.getComputedStyle(e,null)||{display:"none"};return a[t]}function we(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(Te(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var ct='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',ze=0,_e=null;function ut(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=ft.bind(e));var n=e.__resize_listeners__;if(!n){if(e.__resize_listeners__=[],window.ResizeObserver){var a=e.offsetWidth,d=e.offsetHeight,r=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===a&&e.offsetHeight===d)||ge(e)}),f=we(e),i=f.detached,o=f.rendered;e.__resize_observer_triggered__=i===!1&&o===!1,e.__resize_observer__=r,r.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){ge(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(ze||(_e=st(ct)),mt(e),e.__resize_rendered__=we(e).rendered,window.MutationObserver){var l=new MutationObserver(e.__resize_mutation_handler__);l.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=l}}e.__resize_listeners__.push(t),ze++}function dt(e,t){var n=e.__resize_listeners__;if(n){if(t&&n.splice(n.indexOf(t),1),!n.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",Se),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--ze&&_e&&_e.parentNode.removeChild(_e)}}function vt(e){var t=e.__resize_last__,n=t.width,a=t.height,d=e.offsetWidth,r=e.offsetHeight;return d!==n||r!==a?{width:d,height:r}:null}function ft(){var e=we(this),t=e.rendered,n=e.detached;t!==this.__resize_rendered__&&(!n&&this.__resize_triggers__&&(Ce(this),this.addEventListener("scroll",Se,!0)),this.__resize_rendered__=t,ge(this))}function Se(){var e=this;Ce(this),this.__resize_raf__&&lt(this.__resize_raf__),this.__resize_raf__=rt(function(){var t=vt(e);t&&(e.__resize_last__=t,ge(e))})}function ge(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function mt(e){var t=Te(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var n=fe("div",{className:"resize-triggers"}),a=fe("div",{className:"resize-expand-trigger"}),d=fe("div"),r=fe("div",{className:"resize-contract-trigger"});a.appendChild(d),n.appendChild(a),n.appendChild(r),e.appendChild(n),e.__resize_triggers__={triggers:n,expand:a,expandChild:d,contract:r},Ce(e),e.addEventListener("scroll",Se,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function Ce(e){var t=e.__resize_triggers__,n=t.expand,a=t.expandChild,d=t.contract,r=d.scrollWidth,f=d.scrollHeight,i=n.offsetWidth,o=n.offsetHeight,l=n.scrollWidth,u=n.scrollHeight;d.scrollLeft=r,d.scrollTop=f,a.style.width=i+1+"px",a.style.height=o+1+"px",n.scrollLeft=l,n.scrollTop=u}var W=function(){return W=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var d in t=arguments[n])Object.prototype.hasOwnProperty.call(t,d)&&(e[d]=t[d]);return e},W.apply(this,arguments)};var pt=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function _t(e){return t=Object.create(null),pt.forEach(function(n){t[n]=function(a){return function(){for(var d=[],r=0;r<arguments.length;r++)d[r]=arguments[r];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[a].apply(e.value,d)}}(n)}),t;var t}var ht={autoresize:[Boolean,Object]},gt=/^on[^a-z]/,Le=function(e){return gt.test(e)};function me(e,t){var n=$e(e)?Z(e):e;return n&&typeof n=="object"&&"value"in n?n.value||t:n||t}var xt="ecLoadingOptions",yt={loading:Boolean,loadingOptions:Object},re=null,je="x-vue-echarts",De=[],le=[];(function(e,t){if(e&&typeof document<"u"){var n,a=t.prepend===!0?"prepend":"append",d=t.singleTag===!0,r=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(d){var f=De.indexOf(r);f===-1&&(f=De.push(r)-1,le[f]={}),n=le[f]&&le[f][a]?le[f][a]:le[f][a]=i()}else n=i();e.charCodeAt(0)===65279&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function i(){var o=document.createElement("style");if(o.setAttribute("type","text/css"),t.attributes)for(var l=Object.keys(t.attributes),u=0;u<l.length;u++)o.setAttribute(l[u],t.attributes[l[u]]);var v=a==="prepend"?"afterbegin":"beforeend";return r.insertAdjacentElement(v,o),o}})(`x-vue-echarts{display:block;position:relative;width:100%;height:100%;min-width:0}
.vue-echarts-inner{position:absolute!important;top:0;right:0;bottom:0;left:0}
`,{});var bt=function(){if(re!=null)return re;if(typeof HTMLElement>"u"||typeof customElements>"u")return re=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)(je)}catch{return re=!1}return re=!0}(),wt="ecTheme",zt="ecInitOptions",kt="ecUpdateOptions",Ae=/(^&?~?!?)native:/,St=Ie({name:"echarts",props:W(W({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},ht),yt),emits:{},inheritAttrs:!1,setup:function(e,t){var n=t.attrs,a=ve(),d=ve(),r=ve(),f=ve(),i=de(wt,null),o=de(zt,null),l=de(kt,null),u=Ue(e),v=u.autoresize,g=u.manualUpdate,k=u.loading,y=u.loadingOptions,_=O(function(){return f.value||e.option||null}),m=O(function(){return e.theme||me(i,{})}),c=O(function(){return e.initOptions||me(o,{})}),A=O(function(){return e.updateOptions||me(l,{})}),x=O(function(){return function(w){var C={};for(var P in w)Le(P)||(C[P]=w[P]);return C}(n)}),R={},L=He().proxy.$listeners,N={};function q(w){if(d.value){var C=r.value=Ne(d.value,m.value,c.value);e.group&&(C.group=e.group),Object.keys(N).forEach(function(F){var j=N[F];if(j){var I=F.toLowerCase();I.charAt(0)==="~"&&(I=I.substring(1),j.__once__=!0);var ee=C;if(I.indexOf("zr:")===0&&(ee=C.getZr(),I=I.substring(3)),j.__once__){delete j.__once__;var X=j;j=function(){for(var te=[],B=0;B<arguments.length;B++)te[B]=arguments[B];X.apply(void 0,te),ee.off(I,j)}}ee.on(I,j)}}),v.value?qe(function(){C&&!C.isDisposed()&&C.resize(),P()}):P()}function P(){var F=w||_.value;F&&C.setOption(F,A.value)}}function S(){r.value&&(r.value.dispose(),r.value=void 0)}L?Object.keys(L).forEach(function(w){Ae.test(w)?R[w.replace(Ae,"$1")]=L[w]:N[w]=L[w]}):Object.keys(n).filter(function(w){return Le(w)}).forEach(function(w){var C=w.charAt(2).toLowerCase()+w.slice(3);if(C.indexOf("native:")!==0)C.substring(C.length-4)==="Once"&&(C="~".concat(C.substring(0,C.length-4))),N[C]=n[w];else{var P="on".concat(C.charAt(7).toUpperCase()).concat(C.slice(8));R[P]=n[w]}});var s=null;ae(g,function(w){typeof s=="function"&&(s(),s=null),w||(s=ae(function(){return e.option},function(C,P){C&&(r.value?r.value.setOption(C,W({notMerge:C!==P},A.value)):q())},{deep:!0}))},{immediate:!0}),ae([m,c],function(){S(),q()},{deep:!0}),Oe(function(){e.group&&r.value&&(r.value.group=e.group)});var T=_t(r);return function(w,C,P){var F=de(xt,{}),j=O(function(){return W(W({},me(F,{})),P==null?void 0:P.value)});Oe(function(){var I=w.value;I&&(C.value?I.showLoading(j.value):I.hideLoading())})}(r,k,y),function(w,C,P){var F=null;ae([P,w,C],function(j,I,ee){var X=j[0],te=j[1],B=j[2];if(X&&te&&B){var se=B===!0?{}:B,ce=se.throttle,G=ce===void 0?100:ce,oe=se.onResize,ue=function(){te.resize(),oe==null||oe()};F=G?Be(ue,G):ue,ut(X,F)}ee(function(){X&&F&&dt(X,F)})})}(r,v,d),ke(function(){q()}),Ve(function(){bt&&a.value?a.value.__dispose=S:S()}),W({chart:r,root:a,inner:d,setOption:function(w,C){e.manualUpdate&&(f.value=w),r.value?r.value.setOption(w,C||{}):q(w)},nonEventAttrs:x,nativeListeners:R},T)},render:function(){var e=W(W({},this.nonEventAttrs),this.nativeListeners);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",Ee(je,e,[Ee("div",{ref:"inner",class:"vue-echarts-inner"})])}});const Ct={key:0,class:"mx-4 my-4 text-right"},Ot={__name:"PanelMainChart",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=J(),a=We(),{mobile:d}=Ke(),r=Je(),f=U({}),i=U({from:null,to:null,fromMenu:!1,toMenu:!1,loaded:!1});let o=[];const l=O(()=>(k(),"height: "+(/=maximized$/.test(n.app.currentView)?window.innerHeight-250+"px":t.height)));function u(y){return r.d(y,{dateStyle:d.value?"short":"long"})}function v(y,_){let m;return i.value.from&&_&&(m=i.value.from),i.value.to&&!_&&(m=i.value.to),!m&&!isNaN(y)&&(m=(c=>new Date(c.setDate(c.getDate()+(Number(y)||0))))(new Date)),m||(m=new Date(/.*T.*/.test(y)?y:y+"T00:00:00")),!i.value.from&&_&&(i.value.from=m),!i.value.to&&!_&&(i.value.to=m),m=new Date(m.getTime()-m.getTimezoneOffset()*60*1e3),m.toISOString().split("T")[0]}async function g(){let y=n.handleDefs(t.el.serie,["data","name","digits","suffix","type"],[null,"",0,"","line"],!0),_,m,c=[],A,x,R,L,N,q=[];if(y.length>0)for(const S of y){if(/^get.*/.test(S.data)){N="time",_=S.data.split(" ");for(const s of t.devices)s.split(":")[0]===_[1]&&(_[1]=s.split(":")[1]);if(_[4]=v(_[4],!0),_[5]=v(_[5],!1),m=await n.request("text",_.join(" ")),L=[],c=m.split(`
`),c.length>0)for(const s of c)A=s.split(" "),A.length>1&&(x=new Date(A[0].replace("_","T")),R=parseFloat(A[1]).toFixed(S.digits),L.push([x,R]))}else/^\[.*\]/.test(S.data)?L=n.stringToJson(S.data):L=[n.replacer("%n("+S.digits+")",S.data,!0)];q.push({xAxisType:N,type:S.type,name:S.name,digits:S.digits,suffix:S.suffix,data:L})}return q}async function k(){let y={tooltip:{trigger:"axis"},legend:{data:[],bottom:10},backgroundColor:"rgba(255, 255, 255, 0)",grid:{top:30,bottom:60,left:60,right:60},animationDuration:300,series:[],yAxis:[],xAxis:{}},_=JSON.parse(JSON.stringify(n.getEl(t.el,["options"])||{})),m=JSON.parse(JSON.stringify(n.getEl(t.el,["options2"])||{})),c=Object.assign(y,/=maximized$/.test(n.app.currentView)&&Object.keys(m).length>0?m:_),A;i.value.fromMenu=!1,i.value.toMenu=!1,i.value.loaded=!1,o=await g();for(const[x,R]of Object.entries(o))A={formatter:L=>L.toLocaleString(r.locale.value,{minimumFractionDigits:R.digits,maximumFractionDigits:R.digits})+R.suffix},c.series[x]||(c.series[x]={}),c.yAxis[x]||(c.yAxis[x]={}),c.legend.data||(c.legend.data=[]),c.xAxis.type||(c.xAxis.type=R.xAxisType),c.yAxis[x].type||(c.yAxis[x].type="value"),c.yAxis[x].axisLabel||(c.yAxis[x].axisLabel={}),c.yAxis[x].axisLabel.formatter||(c.yAxis[x].axisLabel.formatter=A.formatter),c.legend.data[x]||(c.legend.data[x]=R.name),c.series[x].name||(c.series[x].name=R.name),c.series[x].type||(c.series[x].type=R.type),c.series[x].data||(c.series[x].data=R.data),c.series[x].detail||(c.series[x].detail={}),c.series[x].detail.formatter||(c.series[x].detail.formatter=A.formatter),c.series[x].tooltip||(c.series[x].tooltip={}),c.series[x].tooltip.valueFormatter||(c.series[x].tooltip.valueFormatter=A.formatter);n.log(7,"Chartdata chart.loaded.",c),f.value=Object.assign({},c),i.value.loaded=!0}return(y,_)=>{const m=h("v-btn"),c=h("v-date-picker"),A=h("v-locale-provider"),x=h("v-menu"),R=h("v-skeleton-loader");return p(),M(Y,null,[/=maximized$/.test(Z(n).app.currentView)?(p(),M("div",Ct,[z(x,{modelValue:i.value.fromMenu,"onUpdate:modelValue":_[2]||(_[2]=L=>i.value.fromMenu=L),"close-on-content-click":!1},{activator:b(({props:L})=>[z(m,ie(L,{variant:"outlined","append-icon":"mdi-calendar",class:"mr-2"}),{default:b(()=>[K(V(u(i.value.from)),1)]),_:2},1040)]),default:b(()=>[z(A,{locale:Z(r).locale.value},{default:b(()=>[z(c,{modelValue:i.value.from,"onUpdate:modelValue":[_[0]||(_[0]=L=>i.value.from=L),_[1]||(_[1]=L=>k())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"]),K(" - "),z(x,{modelValue:i.value.toMenu,"onUpdate:modelValue":_[5]||(_[5]=L=>i.value.toMenu=L),"close-on-content-click":!1},{activator:b(({props:L})=>[z(m,ie(L,{variant:"outlined","append-icon":"mdi-calendar",class:"ml-2"}),{default:b(()=>[K(V(u(i.value.to)),1)]),_:2},1040)]),default:b(()=>[z(A,{locale:Z(r).locale.value},{default:b(()=>[z(c,{modelValue:i.value.to,"onUpdate:modelValue":[_[3]||(_[3]=L=>i.value.to=L),_[4]||(_[4]=L=>k())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"])])):E("",!0),Q("div",{style:pe(l.value)},[i.value.loaded?E("",!0):(p(),D(R,{key:0,type:"text, image, text"})),i.value.loaded?(p(),D(Z(St),{key:1,option:f.value,theme:Z(a).global.name.value==="dark"?"dark":"light",autoresize:""},null,8,["option","theme"])):E("",!0)],4)],64)}}},Et=180/Math.PI,Re=e=>{const t=e%360;return t<0?360+t:t},Lt=({x:e,y:t},n)=>{const a=n.left+n.width/2,d=n.top+n.height/2;return Math.atan2(t-d,e-a)*Et},be=()=>{};class Dt{constructor(t,n){this.active=!1,this.element=t,this.element.style.willChange="transform",this.initOptions(n),this.updateCSS(),this.bindHandlers(),this.addListeners()}get angle(){return this._angle}set angle(t){this._angle!==t&&(this._angle=Re(t),this.updateCSS())}initOptions(t){t=t||{},this.onRotate=t.onRotate||be,this.onDragStart=t.onDragStart||be,this.onDragStop=t.onDragStop||be,this._angle=t.angle||0}bindHandlers(){this.onRotationStart=this.onRotationStart.bind(this),this.onRotated=this.onRotated.bind(this),this.onRotationStop=this.onRotationStop.bind(this)}addListeners(){this.element.addEventListener("touchstart",this.onRotationStart,{passive:!0}),document.addEventListener("touchmove",this.onRotated,{passive:!1}),document.addEventListener("touchend",this.onRotationStop,{passive:!0}),document.addEventListener("touchcancel",this.onRotationStop,{passive:!0}),this.element.addEventListener("mousedown",this.onRotationStart,{passive:!0}),document.addEventListener("mousemove",this.onRotated,{passive:!1}),document.addEventListener("mouseup",this.onRotationStop,{passive:!0}),document.addEventListener("mouseleave",this.onRotationStop,{passive:!1})}removeListeners(){this.element.removeEventListener("touchstart",this.onRotationStart),document.removeEventListener("touchmove",this.onRotated),document.removeEventListener("touchend",this.onRotationStop),document.removeEventListener("touchcancel",this.onRotationStop),this.element.removeEventListener("mousedown",this.onRotationStart),document.removeEventListener("mousemove",this.onRotated),document.removeEventListener("mouseup",this.onRotationStop),document.removeEventListener("mouseleave",this.onRotationStop)}destroy(){this.onRotationStop(),this.removeListeners()}onRotationStart(t){(t.type==="touchstart"||t.button===0)&&(this.active=!0,this.onDragStart(t),this.setAngleFromEvent(t))}onRotationStop(){this.active&&(this.active=!1,this.onDragStop()),this.active=!1}onRotated(t){this.active&&(t.preventDefault(),this.setAngleFromEvent(t))}setAngleFromEvent(t){const n=t.targetTouches?t.targetTouches[0]:t,a=Lt({x:n.clientX,y:n.clientY},this.element.getBoundingClientRect());this._angle=Re(a+90),this.updateCSS(),this.onRotate(this._angle)}updateCSS(){this.element.style.transform="rotate("+this._angle+"deg)"}}const At=(e,t)=>{const n=e.__vccOpts||e;for(const[a,d]of t)n[a]=d;return n},Rt=["red","yellow","green","cyan","blue","magenta","red"],Me={ArrowUp:(e,t)=>e+t,ArrowRight:(e,t)=>e+t,ArrowDown:(e,t)=>e-t,ArrowLeft:(e,t)=>e-t,PageUp:(e,t)=>e+t*10,PageDown:(e,t)=>e-t*10,Home:()=>0,End:()=>359},Mt={name:"ColorPicker",emits:["select","input","change"],props:{hue:{default:0},saturation:{default:100},luminosity:{default:50},alpha:{default:1},step:{default:1},mouseScroll:{default:!1},variant:{default:"collapsible"},disabled:{default:!1},initiallyCollapsed:{default:!1},ariaLabel:{default:"color picker"},ariaRoledescription:{default:"radial slider"},ariaValuetext:{default:""},ariaLabelColorWell:{default:"color well"}},setup(e,{emit:t}){U(null);const n=U(null);let a=null;const d=e.hue+"deg",r=U(e.hue),f=U(!e.initiallyCollapsed),i=U(!e.initiallyCollapsed),o=U(!1),l=U(!1),u=O(()=>`hsla(${r.value}, ${e.saturation}%, ${e.luminosity}%, ${e.alpha})`),v=O(()=>Rt[Math.round(r.value/60)]);return ae(()=>e.hue,c=>{r.value=c,a.angle=c}),ke(()=>{a=new Dt(n.value,{angle:r.value,onRotate(c){r.value=c,t("input",r.value)},onDragStop(){t("change",r.value)}})}),Ve(()=>{a.destroy(),a=null}),{rcp:a,rotator:n,initialAngle:d,angle:r,isPaletteIn:f,isKnobIn:i,isRippling:l,isPressed:o,color:u,valuetext:v,onKeyDown:c=>{e.disabled||o.value||!i.value||!(c.key in Me)||(c.preventDefault(),a.angle=Me[c.key](a.angle,e.step),r.value=a.angle,t("input",r.value),t("change",r.value))},onScroll:c=>{o.value||!i.value||(c.preventDefault(),c.deltaY>0?a.angle+=e.step:a.angle-=e.step,r.value=a.angle,t("input",r.value),t("change",r.value))},selectColor:()=>{o.value=!0,f.value&&i.value?(t("select",r.value),l.value=!0):f.value=!0},togglePicker:()=>{e.variant!=="persistent"&&(i.value?i.value=!1:(i.value=!0,f.value=!0)),l.value=!1,o.value=!1},hidePalette:()=>{i.value||(f.value=!1)}}}},Vt=["aria-roledescription","aria-label","aria-expanded","aria-valuenow","aria-valuetext","aria-disabled","tabindex"],Tt=Q("div",{class:"rcp__palette"},null,-1),jt=["aria-label","disabled","tabindex"];function Pt(e,t,n,a,d,r){return p(),M("div",{role:"slider","aria-roledescription":n.ariaRoledescription,"aria-label":n.ariaLabel,"aria-expanded":a.isPaletteIn,"aria-valuemin":"0","aria-valuemax":"359","aria-valuenow":a.angle,"aria-valuetext":n.ariaValuetext||a.valuetext,"aria-disabled":n.disabled,class:"rcp",tabindex:n.disabled?-1:0,style:pe({"--rcp-initial-angle":a.initialAngle}),onKeyup:t[3]||(t[3]=Ze((...f)=>a.selectColor&&a.selectColor(...f),["enter"])),onKeydown:t[4]||(t[4]=(...f)=>a.onKeyDown&&a.onKeyDown(...f))},[Tt,Q("div",ie({class:"rcp__rotator",style:{"pointer-events":n.disabled||a.isPressed||!a.isKnobIn?"none":null}},Ge(n.mouseScroll?{wheel:a.onScroll}:{},!0),{ref:"rotator"}),[Q("div",{class:H(["rcp__knob",a.isKnobIn?"in":"out"]),onTransitionend:t[0]||(t[0]=(...f)=>a.hidePalette&&a.hidePalette(...f))},null,34)],16),Q("div",{class:H(["rcp__ripple",{rippling:a.isRippling}]),style:pe({borderColor:a.color})},null,6),Q("button",{type:"button",class:H(["rcp__well",{pressed:a.isPressed}]),"aria-label":n.ariaLabelColorWell,disabled:n.disabled,tabindex:n.disabled?-1:0,style:pe({backgroundColor:a.color}),onAnimationend:t[1]||(t[1]=(...f)=>a.togglePicker&&a.togglePicker(...f)),onClick:t[2]||(t[2]=(...f)=>a.selectColor&&a.selectColor(...f))},null,46,jt)],44,Vt)}const Ft=At(Mt,[["render",Pt]]),It={__name:"PanelMainColorpicker",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=J(),a=O(()=>n.handleDefs(t.el.picker,["cmd","current","type"],["",!1,"hex"]));function d(l){let u={hue:0,saturation:100,luminosity:50};return l.type==="hex"&&(u=i(l.current)),l.type==="hue"&&(u.hue=l.current||0),u}function r(l){let u=f(l,100,50),v=a.value.cmd.replace("%v",a.value.type==="hex"?u:Math.round(l));for(const g of t.devices)v=v.replace(" "+g.split(":")[0]+" "," "+g.split(":")[1]+" ");n.request("text",v)}function f(l,u,v){v/=100;const g=u*Math.min(v,1-v)/100,k=y=>{const _=(y+l/30)%12,m=v-g*Math.max(Math.min(_-3,9-_,1),-1);return Math.round(255*m).toString(16).padStart(2,"0")};return`${k(0)}${k(8)}${k(4)}`}function i(l){l&&l.split(" ").length>1&&(l=l.split(" ").slice(-1)[0]),l=l?l.replace(/^#/,""):0;let u=parseInt(l,16),v=u>>16&255,g=u>>8&255,k=u&255;v/=255,g/=255,k/=255;let y=Math.max(v,g,k),_=Math.min(v,g,k),m=y-_,c=(y+_)/2,A=0,x=0;return m!==0&&(y===v?A=((g-k)/m+(g<k?6:0))%6:y===g?A=((k-v)/m+2)%6:A=((v-g)/m+4)%6,A=A*60,x=m/(1-Math.abs(2*c-1))),x=Math.round(x*100),c=Math.round(c*100),{hue:A,saturation:x,luminosity:c}}function o(){let l=t.height;return"height: "+l+"; width: "+l+";"}return(l,u)=>{const v=h("v-spacer"),g=h("v-col"),k=h("v-row");return p(),D(k,null,{default:b(()=>[z(v),z(g,{class:"ma-4"},{default:b(()=>[z(Z(Ft),ie(d(a.value),{variant:"persistent",onChange:u[0]||(u[0]=y=>r(y)),style:o()}),null,16,["style"])]),_:1}),z(v)]),_:1})}}},Ut={__name:"PanelMain",props:{main:Object,levels:Array,iconmap:Object,devices:Object},setup(e){const t=J();function n(i,o){return t.handleDefs(i[o].size,["size"],[!1]).size}function a(i){let o="";return["info"].indexOf(i)!==-1&&(o="mx-2"),o}function d(i,o){return i[o]?t.handleDefs(i[o].divider,["show"],[!1]).show:!1}function r(i){return i.level?t.handleDefs(i.level.height,["height"],["64px"]).height:"64px"}function f(i){if(i==="info")return Ye;if(i==="btn")return Xe;if(i==="slider")return tt;if(i==="image")return nt;if(i==="iframe")return it;if(i==="menu")return ot;if(i==="chart")return Ot;if(i==="colorpicker")return It}return(i,o)=>{const l=h("v-sheet"),u=h("v-col"),v=h("v-divider"),g=h("v-row"),k=h("v-expand-transition");return p(!0),M(Y,null,he(e.main,(y,_)=>(p(),D(k,{key:_},{default:b(()=>[e.levels.indexOf(_)!==-1?(p(),D(g,{key:0,"no-gutters":"",class:"text-center align-center"},{default:b(()=>[z(l,{height:r(y,"level")},null,8,["height"]),(p(),M(Y,null,he(["left1","left2","mid","right1","right2"],m=>(p(),M(Y,{key:m},[y.level[m]?(p(),D(u,{key:0,cols:n(y,m),class:H(a(y.level[m]))},{default:b(()=>[(p(),D(Qe(f(y.level[m])),{el:y[m],iconmap:e.iconmap,devices:e.devices,height:r(y,"level")},null,8,["el","iconmap","devices","height"]))]),_:2},1032,["cols","class"])):E("",!0),d(y,m)?(p(),D(v,{key:1,vertical:""})):E("",!0)],64))),64)),d(y,"level")?(p(),D(v,{key:0})):E("",!0)]),_:2},1024)):E("",!0)]),_:2},1024))),128)}}},Ht={key:0},$t={__name:"PanelCard",props:{panel:Object},setup(e){const t=e,n=J();let a=n.thread();ke(()=>n.thread(a));function d(S){let s=n.handleDefs(t.panel.status[S],["level","color","min","max","reverse"],[0,"success",0,100,!1]);return s.level=Math.round((s.level-s.min)/(s.max-s.min)*100),s}const r=O(()=>d("bar")),f=O(()=>d("bar2")),i=O(()=>n.handleDefs(t.panel.status.imageUrl,["url"],[""])),o=O(()=>n.handleDefs(t.panel.panel.sortby,["sortby"],[null])),l=O(()=>n.handleDefs(t.panel.status.title,["title"],[""])),u=U(n.handleDefs(t.panel.panel.expandable,["expandable","expanded","maximizable"],[!1,!1,!1]));ae(t.panel.main,S=>{let s=v(S);u.value.activeLevels.join("-")!==s.join("-")&&(u.value.activeLevels=s,g(!0))});function v(S){let s=[];for(const[T,w]of Object.entries(S))n.handleDefs(w.level.show,["show"],[!0]).show&&s.push(Number(T));return s}function g(S){let s=u.value,T;S?(s.activeLevels=v(t.panel.main),/=maximized$/.test(n.app.currentView)&&(s.expanded=!0)):(s.expandable&&(s.expanded=!s.expanded),s.maximizable&&(s.expanded?ne.push({name:"devices",params:{view:"panel="+t.panel.name+"=maximized"},query:ne.currentRoute.value.query}):(n.app.currentView=n.app.currentView.replace(/=maximized$/,""),ne.back()))),s.expanded?s.levels=s.activeLevels:s.expandable||S?s.levels=[s.activeLevels[0]]:(T=s.activeLevels.indexOf(s.levels[0]),s.levels=[s.activeLevels[T+1]>=0?s.activeLevels[T+1]:s.activeLevels[0]]),s.activeLevels.length>1||s.maximizable?s.icon=s.expandable?s.expanded?"mdi-arrow-collapse":"mdi-arrow-expand":s.expanded?"":"mdi-swap-vertical":s.icon=""}function k(S){let s=n.app.config.panels.map(C=>C.name).indexOf(S),T,w;if(s!==-1&&(w=n.app.config.panels[s].template,T=n.app.config.templates.map(C=>C.name).indexOf(w),T!==-1&&!n.app.config.templates[T].dist))return w}function y(S,s){ne.push({name:"settings",params:{tab:s,item:S},query:ne.currentRoute.value.query})}function _(S){window.open(n.createURL("?detail="+S),"_self")}function m(S){let s=n.handleDefs(t.panel.info[S],["text","icon","color"],["","",""]);return s.icon&&(s.icon=n.getIcon(s.icon,t.panel.panel.iconmap)),s}function c(S){let s=["left1","left2","mid1","mid2","right1","right2"],T=m(S);return m(s[s.indexOf(S)-1]).text&&T.text&&!T.icon?"ml-1 text-truncate":T.text?"text-truncate":""}const A=O(()=>m("left1")),x=O(()=>m("left2")),R=O(()=>m("mid1")),L=O(()=>m("mid2")),N=O(()=>m("right1")),q=O(()=>m("right2"));return g(!0),(S,s)=>{const T=h("v-progress-linear"),w=h("v-col"),C=h("v-row"),P=h("v-toolbar-title"),F=h("v-btn"),j=h("v-list-item"),I=h("v-divider"),ee=h("v-list"),X=h("v-menu"),te=h("v-toolbar"),B=h("v-img"),se=h("v-sheet"),ce=h("v-card-text"),G=h("v-icon"),oe=h("v-spacer"),ue=h("v-system-bar"),Pe=h("v-layout"),Fe=h("v-card");return p(),D(Fe,{variant:"tonal"},{default:b(()=>[z(C,{"no-gutters":""},{default:b(()=>[e.panel.status.bar?(p(),D(w,{key:0},{default:b(()=>[z(T,{height:"7",modelValue:r.value.level,"onUpdate:modelValue":s[0]||(s[0]=$=>r.value.level=$),color:r.value.color,reverse:r.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):E("",!0),e.panel.status.bar2?(p(),D(w,{key:1},{default:b(()=>[z(T,{height:"7",modelValue:f.value.level,"onUpdate:modelValue":s[1]||(s[1]=$=>f.value.level=$),color:f.value.color,reverse:f.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):E("",!0)]),_:1}),z(se,{color:"primary"},{default:b(()=>[z(B,{src:i.value.url,gradient:i.value.url?Z(n).app.header.imageGradient:"",height:"48",cover:""},{default:b(()=>[z(te,{color:"transparent",density:"compact",class:"pr-1"},{append:b(()=>[Z(n).app.settings.loglevel>6?(p(),M("div",Ht,[K(V(o.value.sortby)+" ",1),z(X,null,{activator:b(({props:$})=>[z(F,ie({icon:"mdi-dots-vertical",density:"compact"},$),null,16)]),default:b(()=>[z(ee,{density:"compact"},{default:b(()=>[k(e.panel.name)?(p(),D(j,{key:"template",title:"Template","prepend-icon":"mdi-application-edit-outline",onClick:s[2]||(s[2]=$=>y(k(e.panel.name),"templates"))})):E("",!0),z(j,{key:"panel",title:"Panel","prepend-icon":"mdi-pencil",onClick:s[3]||(s[3]=$=>y(e.panel.name,"panels"))}),z(I),(p(!0),M(Y,null,he(e.panel.panel.devices,$=>(p(),D(j,{key:$.split(":")[0],title:$.split(":")[1],"prepend-icon":"mdi-link",onClick:Nt=>_($.split(":")[1])},null,8,["title","onClick"]))),128))]),_:1})]),_:1})])):E("",!0),u.value.icon?(p(),D(F,{key:1,icon:u.value.icon,size:"small",variant:"plain",density:"compact",onClick:s[4]||(s[4]=$=>g())},null,8,["icon"])):E("",!0)]),default:b(()=>[z(P,{class:"text-truncate"},{default:b(()=>[K(V(l.value.title),1)]),_:1})]),_:1})]),_:1},8,["src","gradient"])]),_:1}),z(Ut,{main:e.panel.main,levels:u.value.levels,iconmap:e.panel.panel.iconmap,devices:e.panel.panel.devices},null,8,["main","levels","iconmap","devices"]),t.panel.internals?(p(),D(ce,{key:0},{default:b(()=>[K(V(t.panel.internals),1)]),_:1})):E("",!0),z(Pe,{style:{height:"24px"}},{default:b(()=>[z(ue,{color:"secondary"},{default:b(()=>[A.value.icon?(p(),D(G,{key:0,icon:A.value.icon,color:A.value.color},null,8,["icon","color"])):E("",!0),A.value.text?(p(),M("span",{key:1,class:H(c("left1"))},V(A.value.text),3)):E("",!0),x.value.icon?(p(),D(G,{key:2,icon:x.value.icon,color:x.value.color},null,8,["icon","color"])):E("",!0),x.value.text?(p(),M("span",{key:3,class:H(c("left2"))},V(x.value.text),3)):E("",!0),z(oe),R.value.icon?(p(),D(G,{key:4,icon:R.value.icon,color:R.value.color},null,8,["icon","color"])):E("",!0),R.value.text?(p(),M("span",{key:5,class:H(c("mid1"))},V(R.value.text),3)):E("",!0),L.value.icon?(p(),D(G,{key:6,icon:L.value.icon,color:L.value.color},null,8,["icon","color"])):E("",!0),L.value.text?(p(),M("span",{key:7,class:H(c("mid2"))},V(L.value.text),3)):E("",!0),z(oe),N.value.icon?(p(),D(G,{key:8,icon:N.value.icon,color:N.value.color},null,8,["icon","color"])):E("",!0),N.value.text?(p(),M("span",{key:9,class:H(c("right1"))},V(N.value.text),3)):E("",!0),q.value.icon?(p(),D(G,{key:10,icon:q.value.icon,color:q.value.color},null,8,["icon","color"])):E("",!0),q.value.text?(p(),M("span",{key:11,class:H(c("right2"))},V(q.value.text),3)):E("",!0)]),_:1})]),_:1})]),_:1})}}};export{$t as _};
