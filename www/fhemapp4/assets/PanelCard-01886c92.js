import{u as Z,c as C,r as y,o as h,b as P,y as q,t as j,k as z,a as O,w as k,j as J,z as ye,F as Y,e as w,s as X,f as I,q as Q,x as ae,d as he,l as Ae,A as le,B as se,C as Me,D as Ve,E as ke,G as be,H as Oe,m as Se,I as Te,J as Pe,h as K,K as je,L as Ie,i as Fe,p as Ne,M as Ue,N as He,O as qe,P as Be}from"./index-42e67982.js";const We={__name:"PanelMainInfo",props:{el:Object,iconmap:Array,devices:Object,height:String},setup(e){const t=e,n=Z(),r=C(()=>n.handleDefs(t.el.text,["text","format"],["",!t.el.text2&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),u=C(()=>n.handleDefs(t.el.text2,["text","format"],["",t.el.text&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),l=C(()=>n.handleDefs(t.el.text3,["text","format"],["","text-caption"])),c=C(()=>{let a=n.handleDefs(t.el.icon,["icon","color","size"],["","","x-large"]);return a.icon&&(a.icon=n.getIcon(a.icon,t.iconmap)),a}),i=C(()=>{let a=n.handleDefs(t.el.status,["level","color","min","max","reverse","linear"],[0,"success",0,100,!1,!1]);return a.level=Math.round((a.level-a.min)/(a.max-a.min)*100),a.reverse=!!a.reverse,a});return(a,o)=>{const d=y("v-icon"),v=y("v-progress-circular"),g=y("v-progress-linear");return h(),P(Y,null,[e.el.text?(h(),P("div",{key:0,class:q(r.value.format)},j(r.value.text),3)):z("",!0),e.el.icon?(h(),O(d,{key:1,color:c.value.color,size:c.value.size},{default:k(()=>[J(j(c.value.icon),1)]),_:1},8,["color","size"])):z("",!0),e.el.status&&!i.value.linear?(h(),O(v,{key:2,width:"4",modelValue:i.value.level,"onUpdate:modelValue":o[0]||(o[0]=E=>i.value.level=E),color:i.value.color,reverse:i.value.reverse},null,8,["modelValue","color","reverse"])):z("",!0),e.el.status&&i.value.linear?(h(),O(g,{key:3,height:"7",rounded:"",modelValue:i.value.level,"onUpdate:modelValue":o[1]||(o[1]=E=>i.value.level=E),color:i.value.color,reverse:i.value.reverse},null,8,["modelValue","color","reverse"])):z("",!0),ye("div",{class:q(e.el.text2?u.value.format:l.value.format)},[e.el.text2?(h(),P("span",{key:0,class:q(u.value.format)},j(u.value.text),3)):z("",!0),e.el.text3?(h(),P("span",{key:1,class:q(l.value.format)},j(l.value.text),3)):z("",!0)],2)],64)}}},Ke={__name:"PanelMainBtn",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Z(),r=C(()=>{let a=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["",!1,"","text"]);return a.icon&&(a.icon=n.getIcon(a.icon,t.iconmap)),a}),u=C(()=>{let a=n.handleDefs(t.el.status,["level","color","min","max","reverse"],[0,"success",0,100,!1]);return a.level=Math.round((a.level-a.min)/(a.max-a.min)*100),a.reverse=!!a.reverse,a}),l={timer:!1,long:!1};function c(a){let o=[],d=a.cmd,v;if(a.type==="cmd"){for(const g of t.devices)o=g.split(":"),v=RegExp(o[0],"g"),v.test(d)&&(d=d.replace(v,o[1]));n.request("text",d)}a.type==="route"&&X.push({name:"devices",params:{view:a.cmd},query:X.currentRoute.value.query}),a.type==="url"&&window.open(a.cmd,"_self")}function i(a){let o=n.handleDefs(t.el.click,["cmd","type"],["","cmd"],!1,null,!0),d=n.handleDefs(t.el.longClick,["cmd","type"],["","cmd"],!1,null,!0),v=n.handleDefs(t.el.longRelease,["cmd","type"],["","cmd"],!1,null,!0);a==="mouseStart"&&(l.timer=setTimeout(()=>{l.long=!0,d.cmd&&c(d)},1e3)),a==="mouseEnd"&&(l.long?v.cmd&&c(v):o.cmd&&c(o),clearTimeout(l.timer),l.long=!1)}return(a,o)=>{const d=y("v-progress-linear"),v=y("v-icon"),g=y("v-btn");return h(),P(Y,null,[e.el.status?(h(),O(d,{key:0,height:"4",modelValue:u.value.level,"onUpdate:modelValue":o[0]||(o[0]=E=>u.value.level=E),color:u.value.color,reverse:u.value.reverse},null,8,["modelValue","color","reverse"])):z("",!0),w(g,{icon:"",variant:r.value.variant,disabled:r.value.disabled,color:r.value.color,onMousedown:o[1]||(o[1]=E=>i("mouseStart")),onMouseup:o[2]||(o[2]=E=>i("mouseEnd")),class:"my-2"},{default:k(()=>[w(v,{size:"large"},{default:k(()=>[J(j(r.value.icon),1)]),_:1})]),_:1},8,["variant","disabled","color"])],64)}}},Je={class:"text-white"},$e={__name:"PanelMainSlider",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Z(),r=I();function u(a){r.value=a}const l=C(()=>{let a=n.handleDefs(t.el.slider,["cmd","current","color","min","max","steps","reverse","size","vertical"],["",0,"",0,100,10,!1,4,!1],!1,null,!0);return/%v/.test(a.current)&&(a.current=a.current.replace("%v",r.value)),u(a.current),a});let c=null;function i(a){let o=l.value.cmd,d=/\./.exec(l.value.steps),v=0,g=[];d&&(v=l.value.steps.slice(d.index).length-1),o=o.replace("%v",a.toFixed(v));for(const E of t.devices)g=E.split(":"),RegExp(g[0]).test(o)&&(o=o.replace(g[0],g[1]));clearTimeout(c),c=setTimeout(()=>{n.request("text",o)},500)}return(a,o)=>{const d=y("v-slider");return h(),O(d,{modelValue:r.value,"onUpdate:modelValue":[o[0]||(o[0]=v=>r.value=v),o[1]||(o[1]=v=>i(v))],min:l.value.min,max:l.value.max,step:l.value.steps,reverse:l.value.reverse,direction:l.value.vertical?"vertical":"horizontal","track-size":l.value.size,color:l.value.color,"hide-details":"","thumb-label":""},{"thumb-label":k(({modelValue:v})=>[ye("div",Je,j(v),1)]),_:1},8,["modelValue","min","max","step","reverse","direction","track-size","color"])}}},Ge={__name:"PanelMainImage",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Z(),r=I(!1),u=C(()=>n.handleDefs(t.el.image,["source","height"],["",null]));return(l,c)=>{const i=y("v-skeleton-loader"),a=y("v-img");return h(),P(Y,null,[r.value?z("",!0):(h(),O(i,{key:0,type:"image"})),w(a,{src:u.value.source,height:u.value.height,onLoad:c[0]||(c[0]=o=>r.value=!0)},null,8,["src","height"])],64)}}},Ze={__name:"PanelMainMenu",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Z(),r=I([]);Q(t.el,i=>{l()});const u=C(()=>{let i=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["mdi-dots-vertical",!1,"","text"]);return i.icon&&(i.icon=n.getIcon(i.icon,t.iconmap)),i});async function l(){let i=n.handleDefs(t.el.menu,["name","cmd","convert"],["","",null],!0,","),a,o,d;for(const v of i){a=/^get/.test(v.name)?await c(v.name):v.name;for(const g of[",","|",`
`])RegExp(g).test(a)&&(o=g);for(const g of a.split(o))g&&(d=g,/%v/.test(v.cmd)&&v.convert==="regExp"&&(d=RegExp(g.replace(/[^a-z,^A-Z]/g,"."))),r.value.push({name:g,cmd:v.cmd.replace(/%v/g,d)}))}}async function c(i){let a=[];for(const o of t.devices)a=o.split(":"),RegExp(a[0]).test(i)&&(i=i.replace(a[0],a[1]));return n.request("text",i)}return l(),(i,a)=>{const o=y("v-icon"),d=y("v-btn"),v=y("v-list-item-title"),g=y("v-list-item"),E=y("v-list"),x=y("v-menu");return h(),O(x,null,{activator:k(({props:m})=>[w(d,ae(m,{icon:"",variant:u.value.variant,disabled:u.value.disabled||r.value.length<1,color:u.value.color,class:"my-2"}),{default:k(()=>[w(o,{size:"large"},{default:k(()=>[J(j(u.value.icon),1)]),_:1})]),_:2},1040,["variant","disabled","color"])]),default:k(()=>[w(E,null,{default:k(()=>[(h(!0),P(Y,null,he(r.value,(m,_)=>(h(),O(g,{key:_,value:_,onClick:f=>c(m.cmd)},{default:k(()=>[w(v,null,{default:k(()=>[J(j(m.name),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})}}};var me=null;function Ye(e){return me||(me=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),me(e)}var pe=null;function Xe(e){pe||(pe=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),pe(e)}function Qe(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function ue(e,t){t===void 0&&(t={});var n=document.createElement(e);return Object.keys(t).forEach(function(r){n[r]=t[r]}),n}function Le(e,t,n){var r=window.getComputedStyle(e,n||null)||{display:"none"};return r[t]}function ge(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(Le(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var et='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',xe=0,de=null;function tt(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=it.bind(e));var n=e.__resize_listeners__;if(!n){if(e.__resize_listeners__=[],window.ResizeObserver){var r=e.offsetWidth,u=e.offsetHeight,l=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===r&&e.offsetHeight===u)||ve(e)}),c=ge(e),i=c.detached,a=c.rendered;e.__resize_observer_triggered__=i===!1&&a===!1,e.__resize_observer__=l,l.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){ve(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(xe||(de=Qe(et)),rt(e),e.__resize_rendered__=ge(e).rendered,window.MutationObserver){var o=new MutationObserver(e.__resize_mutation_handler__);o.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=o}}e.__resize_listeners__.push(t),xe++}function nt(e,t){var n=e.__resize_listeners__;if(n){if(t&&n.splice(n.indexOf(t),1),!n.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",we),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--xe&&de&&de.parentNode.removeChild(de)}}function at(e){var t=e.__resize_last__,n=t.width,r=t.height,u=e.offsetWidth,l=e.offsetHeight;return u!==n||l!==r?{width:u,height:l}:null}function it(){var e=ge(this),t=e.rendered,n=e.detached;t!==this.__resize_rendered__&&(!n&&this.__resize_triggers__&&(ze(this),this.addEventListener("scroll",we,!0)),this.__resize_rendered__=t,ve(this))}function we(){var e=this;ze(this),this.__resize_raf__&&Xe(this.__resize_raf__),this.__resize_raf__=Ye(function(){var t=at(e);t&&(e.__resize_last__=t,ve(e))})}function ve(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function rt(e){var t=Le(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var n=ue("div",{className:"resize-triggers"}),r=ue("div",{className:"resize-expand-trigger"}),u=ue("div"),l=ue("div",{className:"resize-contract-trigger"});r.appendChild(u),n.appendChild(r),n.appendChild(l),e.appendChild(n),e.__resize_triggers__={triggers:n,expand:r,expandChild:u,contract:l},ze(e),e.addEventListener("scroll",we,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function ze(e){var t=e.__resize_triggers__,n=t.expand,r=t.expandChild,u=t.contract,l=u.scrollWidth,c=u.scrollHeight,i=n.offsetWidth,a=n.offsetHeight,o=n.scrollWidth,d=n.scrollHeight;u.scrollLeft=l,u.scrollTop=c,r.style.width=i+1+"px",r.style.height=a+1+"px",n.scrollLeft=o,n.scrollTop=d}var G=function(){return G=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var u in t=arguments[n])Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u]);return e},G.apply(this,arguments)};var ot=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function lt(e){return t=Object.create(null),ot.forEach(function(n){t[n]=function(r){return function(){for(var u=[],l=0;l<arguments.length;l++)u[l]=arguments[l];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[r].apply(e.value,u)}}(n)}),t;var t}var st={autoresize:[Boolean,Object]},ut=/^on[^a-z]/,ct=function(e){return ut.test(e)};function ce(e,t){var n=K(e);return n&&typeof n=="object"&&"value"in n?n.value||t:n||t}var dt="ecLoadingOptions",vt={loading:Boolean,loadingOptions:Object},te=null,Re="x-vue-echarts",Ce=[],ne=[];(function(e,t){if(e&&typeof document<"u"){var n,r=t.prepend===!0?"prepend":"append",u=t.singleTag===!0,l=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(u){var c=Ce.indexOf(l);c===-1&&(c=Ce.push(l)-1,ne[c]={}),n=ne[c]&&ne[c][r]?ne[c][r]:ne[c][r]=i()}else n=i();e.charCodeAt(0)===65279&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function i(){var a=document.createElement("style");if(a.setAttribute("type","text/css"),t.attributes)for(var o=Object.keys(t.attributes),d=0;d<o.length;d++)a.setAttribute(o[d],t.attributes[o[d]]);var v=r==="prepend"?"afterbegin":"beforeend";return l.insertAdjacentElement(v,a),a}})(`x-vue-echarts,.echarts-inner{display:block;width:100%;height:100%;min-width:0}
`,{});var ft=function(){if(te!=null)return te;if(typeof HTMLElement>"u"||typeof customElements>"u")return te=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)(Re)}catch{return te=!1}return te=!0}(),mt="ecTheme",pt="ecInitOptions",_t="ecUpdateOptions",ht=Ae({name:"echarts",props:G(G({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},st),vt),emits:{},inheritAttrs:!1,setup:function(e,t){var n=t.attrs,r=le(),u=le(),l=le(),c=le(),i=se(mt,null),a=se(pt,null),o=se(_t,null),d=Me(e),v=d.autoresize,g=d.manualUpdate,E=d.loading,x=d.loadingOptions,m=C(function(){return c.value||e.option||null}),_=C(function(){return e.theme||ce(i,{})}),f=C(function(){return e.initOptions||ce(a,{})}),R=C(function(){return e.updateOptions||ce(o,{})}),p=C(function(){return function(b){var D={};for(var A in b)ct(A)||(D[A]=b[A]);return D}(n)}),T=Ve().proxy.$listeners;function S(b){if(u.value){var D=l.value=Te(u.value,_.value,f.value);e.group&&(D.group=e.group);var A=T;A||(A={},Object.keys(n).filter(function(M){return M.indexOf("on")===0&&M.length>2}).forEach(function(M){var V=M.charAt(2).toLowerCase()+M.slice(3);V.substring(V.length-4)==="Once"&&(V="~".concat(V.substring(0,V.length-4))),A[V]=n[M]})),Object.keys(A).forEach(function(M){var V=A[M];if(V){var U=M.toLowerCase();U.charAt(0)==="~"&&(U=U.substring(1),V.__once__=!0);var B=D;if(U.indexOf("zr:")===0&&(B=D.getZr(),U=U.substring(3)),V.__once__){delete V.__once__;var ee=V;V=function(){for(var F=[],W=0;W<arguments.length;W++)F[W]=arguments[W];ee.apply(void 0,F),B.off(U,V)}}B.on(U,V)}}),v.value?Pe(function(){D&&!D.isDisposed()&&D.resize(),H()}):H()}function H(){var M=b||m.value;M&&D.setOption(M,R.value)}}function N(){l.value&&(l.value.dispose(),l.value=void 0)}var L=null;Q(g,function(b){typeof L=="function"&&(L(),L=null),b||(L=Q(function(){return e.option},function(D,A){D&&(l.value?l.value.setOption(D,G({notMerge:D!==A},R.value)):S())},{deep:!0}))},{immediate:!0}),Q([_,f],function(){N(),S()},{deep:!0}),ke(function(){e.group&&l.value&&(l.value.group=e.group)});var s=lt(l);return function(b,D,A){var H=se(dt,{}),M=C(function(){return G(G({},ce(H,{})),A==null?void 0:A.value)});ke(function(){var V=b.value;V&&(D.value?V.showLoading(M.value):V.hideLoading())})}(l,E,x),function(b,D,A){var H=null;Q([A,b,D],function(M,V,U){var B=M[0],ee=M[1],F=M[2];if(B&&ee&&F){var W=F===!0?{}:F,ie=W.throttle,re=ie===void 0?100:ie,oe=W.onResize,$=function(){ee.resize(),oe==null||oe()};H=re?je($,re):$,tt(B,H)}U(function(){B&&H&&nt(B,H)})})}(l,v,u),be(function(){S()}),Oe(function(){ft&&r.value?r.value.__dispose=N:N()}),G({chart:l,root:r,inner:u,setOption:function(b,D){e.manualUpdate&&(c.value=b),l.value?l.value.setOption(b,D||{}):S(b)},nonEventAttrs:p},s)},render:function(){var e=G({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",Se(Re,e,[Se("div",{ref:"inner",class:"echarts-inner"})])}});const gt={key:0,class:"mx-4 my-4 text-right"},xt={__name:"PanelMainChart",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Z(),r=Ie(),{mobile:u}=Fe(),l=Ne(),c=I({}),i=I({from:null,to:null,fromMenu:!1,toMenu:!1,loaded:!1});let a=[];const o=C(()=>(E(),"height: "+(/=maximized$/.test(n.app.currentView)?window.innerHeight-250+"px":t.height)));function d(x){return l.d(x,{dateStyle:u.value?"short":"long"})}function v(x,m){let _;return i.value.from&&m&&(_=i.value.from),i.value.to&&!m&&(_=i.value.to),!_&&!isNaN(x)&&(_=(f=>new Date(f.setDate(f.getDate()+(Number(x)||0))))(new Date)),_||(_=new Date(/.*T.*/.test(x)?x:x+"T00:00:00")),!i.value.from&&m&&(i.value.from=_),!i.value.to&&!m&&(i.value.to=_),_=new Date(_.getTime()-_.getTimezoneOffset()*60*1e3),_.toISOString().split("T")[0]}async function g(){let x=n.handleDefs(t.el.serie,["data","name","digits","suffix","type"],[null,"",0,"","line"],!0),m,_,f=[],R,p,T,S,N,L=[];if(x.length>0)for(const s of x){if(/^get.*/.test(s.data)){N="time",m=s.data.split(" ");for(const b of t.devices)b.split(":")[0]===m[1]&&(m[1]=b.split(":")[1]);if(m[4]=v(m[4],!0),m[5]=v(m[5],!1),_=await n.request("text",m.join(" ")),S=[],f=_.split(`
`),f.length>0)for(const b of f)R=b.split(" "),R.length>1&&(p=new Date(R[0].replace("_","T")),T=parseFloat(R[1]).toFixed(s.digits),S.push([p,T]))}else/^\[.*\]/.test(s.data)?S=n.stringToJson(s.data):S=[n.replacer("%n("+s.digits+")",s.data,!0)];L.push({xAxisType:N,type:s.type,name:s.name,digits:s.digits,suffix:s.suffix,data:S})}return L}async function E(){let x={tooltip:{trigger:"axis"},legend:{data:[],bottom:10},backgroundColor:"rgba(255, 255, 255, 0)",grid:{top:30,bottom:60,left:60,right:60},animationDuration:300,series:[],yAxis:[],xAxis:{}},m=JSON.parse(JSON.stringify(n.getEl(t.el,["options"])||{})),_=JSON.parse(JSON.stringify(n.getEl(t.el,["options2"])||{})),f=Object.assign(x,/=maximized$/.test(n.app.currentView)&&Object.keys(_).length>0?_:m),R;i.value.fromMenu=!1,i.value.toMenu=!1,i.value.loaded=!1,a=await g();for(const[p,T]of Object.entries(a))R={formatter:S=>S.toLocaleString(l.locale.value,{minimumFractionDigits:T.digits,maximumFractionDigits:T.digits})+T.suffix},f.series[p]||(f.series[p]={}),f.yAxis[p]||(f.yAxis[p]={}),f.legend.data||(f.legend.data=[]),f.xAxis.type||(f.xAxis.type=T.xAxisType),f.yAxis[p].type||(f.yAxis[p].type="value"),f.yAxis[p].axisLabel||(f.yAxis[p].axisLabel={}),f.yAxis[p].axisLabel.formatter||(f.yAxis[p].axisLabel.formatter=R.formatter),f.legend.data[p]||(f.legend.data[p]=T.name),f.series[p].name||(f.series[p].name=T.name),f.series[p].type||(f.series[p].type=T.type),f.series[p].data||(f.series[p].data=T.data),f.series[p].detail||(f.series[p].detail={}),f.series[p].detail.formatter||(f.series[p].detail.formatter=R.formatter),f.series[p].tooltip||(f.series[p].tooltip={}),f.series[p].tooltip.valueFormatter||(f.series[p].tooltip.valueFormatter=R.formatter);n.log(7,"Chartdata chart.loaded.",f),c.value=Object.assign({},f),i.value.loaded=!0}return(x,m)=>{const _=y("v-btn"),f=y("v-date-picker"),R=y("v-locale-provider"),p=y("v-menu"),T=y("v-skeleton-loader");return h(),P(Y,null,[/=maximized$/.test(K(n).app.currentView)?(h(),P("div",gt,[w(p,{modelValue:i.value.fromMenu,"onUpdate:modelValue":m[2]||(m[2]=S=>i.value.fromMenu=S),"close-on-content-click":!1},{activator:k(({props:S})=>[w(_,ae(S,{variant:"outlined","append-icon":"mdi-calendar",class:"mr-2"}),{default:k(()=>[J(j(d(i.value.from)),1)]),_:2},1040)]),default:k(()=>[w(R,{locale:K(l).locale.value},{default:k(()=>[w(f,{modelValue:i.value.from,"onUpdate:modelValue":[m[0]||(m[0]=S=>i.value.from=S),m[1]||(m[1]=S=>E())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"]),J(" - "),w(p,{modelValue:i.value.toMenu,"onUpdate:modelValue":m[5]||(m[5]=S=>i.value.toMenu=S),"close-on-content-click":!1},{activator:k(({props:S})=>[w(_,ae(S,{variant:"outlined","append-icon":"mdi-calendar",class:"ml-2"}),{default:k(()=>[J(j(d(i.value.to)),1)]),_:2},1040)]),default:k(()=>[w(R,{locale:K(l).locale.value},{default:k(()=>[w(f,{modelValue:i.value.to,"onUpdate:modelValue":[m[3]||(m[3]=S=>i.value.to=S),m[4]||(m[4]=S=>E())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"])])):z("",!0),ye("div",{style:Ue(o.value)},[i.value.loaded?z("",!0):(h(),O(T,{key:0,type:"text, image, text"})),i.value.loaded?(h(),O(K(ht),{key:1,option:c.value,theme:K(r).global.name.value==="dark"?"dark":"light",autoresize:""},null,8,["option","theme"])):z("",!0)],4)],64)}}},yt=180/Math.PI,Ee=e=>{const t=e%360;return t<0?360+t:t},bt=({x:e,y:t},n)=>{const r=n.left+n.width/2,u=n.top+n.height/2;return Math.atan2(t-u,e-r)*yt},_e=()=>{};class wt{constructor(t,n){this.active=!1,this.element=t,this.element.style.willChange="transform",this.initOptions(n),this.updateCSS(),this.bindHandlers(),this.addListeners()}get angle(){return this._angle}set angle(t){this._angle!==t&&(this._angle=Ee(t),this.updateCSS())}initOptions(t){t=t||{},this.onRotate=t.onRotate||_e,this.onDragStart=t.onDragStart||_e,this.onDragStop=t.onDragStop||_e,this._angle=t.angle||0}bindHandlers(){this.onRotationStart=this.onRotationStart.bind(this),this.onRotated=this.onRotated.bind(this),this.onRotationStop=this.onRotationStop.bind(this)}addListeners(){this.element.addEventListener("touchstart",this.onRotationStart,{passive:!0}),document.addEventListener("touchmove",this.onRotated,{passive:!1}),document.addEventListener("touchend",this.onRotationStop,{passive:!0}),document.addEventListener("touchcancel",this.onRotationStop,{passive:!0}),this.element.addEventListener("mousedown",this.onRotationStart,{passive:!0}),document.addEventListener("mousemove",this.onRotated,{passive:!1}),document.addEventListener("mouseup",this.onRotationStop,{passive:!0}),document.addEventListener("mouseleave",this.onRotationStop,{passive:!1})}removeListeners(){this.element.removeEventListener("touchstart",this.onRotationStart),document.removeEventListener("touchmove",this.onRotated),document.removeEventListener("touchend",this.onRotationStop),document.removeEventListener("touchcancel",this.onRotationStop),this.element.removeEventListener("mousedown",this.onRotationStart),document.removeEventListener("mousemove",this.onRotated),document.removeEventListener("mouseup",this.onRotationStop),document.removeEventListener("mouseleave",this.onRotationStop)}destroy(){this.onRotationStop(),this.removeListeners()}onRotationStart(t){(t.type==="touchstart"||t.button===0)&&(this.active=!0,this.onDragStart(t),this.setAngleFromEvent(t))}onRotationStop(){this.active&&(this.active=!1,this.onDragStop()),this.active=!1}onRotated(t){this.active&&(t.preventDefault(),this.setAngleFromEvent(t))}setAngleFromEvent(t){const n=t.targetTouches?t.targetTouches[0]:t,r=bt({x:n.clientX,y:n.clientY},this.element.getBoundingClientRect());this._angle=Ee(r+90),this.updateCSS(),this.onRotate(this._angle)}updateCSS(){this.element.style.transform="rotate("+this._angle+"deg)"}}const zt=["red","yellow","green","cyan","blue","magenta","red"],De={ArrowUp:(e,t)=>e+t,ArrowRight:(e,t)=>e+t,ArrowDown:(e,t)=>e-t,ArrowLeft:(e,t)=>e-t,PageUp:(e,t)=>e+t*10,PageDown:(e,t)=>e-t*10,Home:()=>0,End:()=>359},fe={name:"ColorPicker",emits:["select","input","change"],props:{hue:{default:0},saturation:{default:100},luminosity:{default:50},alpha:{default:1},step:{default:1},mouseScroll:{default:!1},variant:{default:"collapsible"},disabled:{default:!1},initiallyCollapsed:{default:!1},ariaLabel:{default:"color picker"},ariaRoledescription:{default:"radial slider"},ariaValuetext:{default:""},ariaLabelColorWell:{default:"color well"}},setup(e,{emit:t}){const n=I(null),r=I(null);let u=null;const l=e.hue+"deg",c=I(e.hue),i=I(!e.initiallyCollapsed),a=I(!e.initiallyCollapsed),o=I(!1),d=I(!1),v=I(!1),g=C(()=>`hsla(${c.value}, ${e.saturation}%, ${e.luminosity}%, ${e.alpha})`),E=C(()=>zt[Math.round(c.value/60)]);return Q(()=>e.hue,p=>{c.value=p,u.angle=p}),be(()=>{u=new wt(r.value,{angle:c.value,onRotate(p){c.value=p,t("input",c.value)},onDragStart(){v.value=!0},onDragStop(){v.value=!1,t("change",c.value)}})}),Oe(()=>{u.destroy(),u=null}),{rcp:u,el:n,rotator:r,initialAngle:l,angle:c,isPaletteIn:i,isKnobIn:a,isDragging:v,isRippling:d,isPressed:o,color:g,valuetext:E,onKeyDown:p=>{e.disabled||o.value||!a.value||!(p.key in De)||(p.preventDefault(),u.angle=De[p.key](u.angle,e.step),c.value=u.angle,t("input",c.value),t("change",c.value))},onScroll:p=>{o.value||!a.value||(p.preventDefault(),p.deltaY>0?u.angle+=e.step:u.angle-=e.step,c.value=u.angle,t("input",c.value),t("change",c.value))},selectColor:()=>{o.value=!0,i.value&&a.value?(t("select",c.value),d.value=!0):i.value=!0},togglePicker:()=>{e.variant!=="persistent"&&(a.value?a.value=!1:(a.value=!0,i.value=!0)),d.value=!1,o.value=!1},hidePalette:()=>{a.value||(i.value=!1)}}}};function kt(e,t,n,r,u,l){return h(),O("div",{ref:"el",role:"slider","aria-roledescription":n.ariaRoledescription,"aria-label":n.ariaLabel,"aria-expanded":r.isPaletteIn,"aria-valuemin":"0","aria-valuemax":"359","aria-valuenow":r.angle,"aria-valuetext":n.ariaValuetext||r.valuetext,"aria-disabled":n.disabled,class:["rcp",{dragging:r.isDragging,disabled:n.disabled}],tabindex:n.disabled?-1:0,style:{"--rcp-initial-angle":r.initialAngle},onKeyup:t[4]||(t[4]=qe((...c)=>r.selectColor&&r.selectColor(...c),["enter"])),onKeydown:t[5]||(t[5]=(...c)=>r.onKeyDown&&r.onKeyDown(...c))},[w("div",{class:["rcp__palette",r.isPaletteIn?"in":"out"]},null,2),w("div",ae({class:"rcp__rotator",style:{"pointer-events":n.disabled||r.isPressed||!r.isKnobIn?"none":null}},He(n.mouseScroll?{wheel:r.onScroll}:{}),{ref:"rotator"}),[w("div",{class:["rcp__knob",r.isKnobIn?"in":"out"],onTransitionend:t[1]||(t[1]=(...c)=>r.hidePalette&&r.hidePalette(...c))},null,34)],16),w("div",{class:["rcp__ripple",{rippling:r.isRippling}],style:{borderColor:r.color}},null,6),w("button",{type:"button",class:["rcp__well",{pressed:r.isPressed}],"aria-label":n.ariaLabelColorWell,disabled:n.disabled,tabindex:n.disabled?-1:0,style:{backgroundColor:r.color},onAnimationend:t[2]||(t[2]=(...c)=>r.togglePicker&&r.togglePicker(...c)),onClick:t[3]||(t[3]=(...c)=>r.selectColor&&r.selectColor(...c))},null,46,["aria-label","disabled","tabindex"])],46,["aria-roledescription","aria-label","aria-expanded","aria-valuenow","aria-valuetext","aria-disabled","tabindex"])}fe.render=kt;fe.install=function(e){e.component("ColorPicker",fe)};const St={class:"mt-4 mb-2"},Ct={__name:"PanelMainColorpicker",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Z(),r=C(()=>n.handleDefs(t.el.picker,["cmd","current"],["",!1]));function u(i){let a=l(i,50,100),o=r.value.cmd,d=[];o=o.replace("%v",a);for(const v of t.devices)d=v.split(":"),RegExp(d[0]).test(o)&&(o=o.replace(d[0],d[1]));n.request("text",o)}function l(i,a,o){a/=100;const d=o*Math.min(a,1-a)/100,v=g=>{const E=(g+i/30)%12,x=a-d*Math.max(Math.min(E-3,9-E,1),-1);return Math.round(255*x).toString(16).padStart(2,"0")};return`${v(0)}${v(8)}${v(4)}`}function c(i){i.split(" ").length>1&&(i=i.split(" ").slice(-1)[0]),i=i.replace(/^#/,"");let a=parseInt(i,16),o=a>>16&255,d=a>>8&255,v=a&255;o/=255,d/=255,v/=255;let g=Math.max(o,d,v),E=Math.min(o,d,v),x=g-E,m=(g+E)/2,_=0,f=0;return x!==0&&(g===o?_=((d-v)/x+(d<v?6:0))%6:g===d?_=((v-o)/x+2)%6:_=((o-d)/x+4)%6,_=_*60,f=x/(1-Math.abs(2*m-1))),f=Math.round(f*100),m=Math.round(m*100),{hue:_,saturation:f,luminosity:m}}return(i,a)=>(h(),P("div",St,[w(K(fe),ae(c(r.value.current),{variant:"persistent",onChange:a[0]||(a[0]=o=>u(o))}),null,16)]))}},Et={__name:"PanelMain",props:{main:Object,levels:Array,iconmap:Object,devices:Object},setup(e){const t=Z();function n(i,a){return t.handleDefs(i[a].size,["size"],[!1]).size}function r(i){let a="";return["info"].indexOf(i)!==-1&&(a="mx-2"),a}function u(i,a){return i[a]?t.handleDefs(i[a].divider,["show"],[!1]).show:!1}function l(i){return i.level?t.handleDefs(i.level.height,["height"],["64px"]).height:"64px"}function c(i){if(i==="info")return We;if(i==="btn")return Ke;if(i==="slider")return $e;if(i==="image")return Ge;if(i==="menu")return Ze;if(i==="chart")return xt;if(i==="colorpicker")return Ct}return(i,a)=>{const o=y("v-sheet"),d=y("v-col"),v=y("v-divider"),g=y("v-row"),E=y("v-expand-transition");return h(!0),P(Y,null,he(e.main,(x,m)=>(h(),P("div",{key:m},[w(E,null,{default:k(()=>[e.levels.indexOf(m)!==-1?(h(),O(g,{key:0,"no-gutters":"",class:"text-center align-center"},{default:k(()=>[w(o,{height:l(x,"level")},null,8,["height"]),(h(),P(Y,null,he(["left1","left2","mid","right1","right2"],_=>(h(),P(Y,{key:_},[x.level[_]?(h(),O(d,{key:0,cols:n(x,_),class:q(r(x.level[_]))},{default:k(()=>[(h(),O(Be(c(x.level[_])),{el:x[_],iconmap:e.iconmap,devices:e.devices,height:l(x,"level")},null,8,["el","iconmap","devices","height"]))]),_:2},1032,["cols","class"])):z("",!0),u(x,_)?(h(),O(v,{key:1,vertical:""})):z("",!0)],64))),64)),u(x,"level")?(h(),O(v,{key:0})):z("",!0)]),_:2},1024)):z("",!0)]),_:2},1024)]))),128)}}},Dt={key:0},Lt={__name:"PanelCard",props:{panel:Object},setup(e){const t=e,n=Z();let r=n.thread();be(()=>n.thread(r));function u(L){let s=n.handleDefs(t.panel.status[L],["level","color","min","max","reverse"],[0,"success",0,100,!1]);return s.level=Math.round((s.level-s.min)/(s.max-s.min)*100),s}const l=C(()=>u("bar")),c=C(()=>u("bar2")),i=C(()=>n.handleDefs(t.panel.status.imageUrl,["url"],[""])),a=C(()=>n.handleDefs(t.panel.panel.sortby,["sortby"],[null])),o=C(()=>n.handleDefs(t.panel.status.title,["title"],[""])),d=I(n.handleDefs(t.panel.panel.expandable,["expandable","expanded","maximizable"],[!1,!1,!1]));Q(t.panel.main,L=>{let s=v(L);d.value.activeLevels.join("-")!==s.join("-")&&(d.value.activeLevels=s,g(!0))});function v(L){let s=[];for(const[b,D]of Object.entries(L))n.handleDefs(D.level.show,["show"],[!0]).show&&s.push(Number(b));return s}function g(L){let s=d.value,b;L?(s.activeLevels=v(t.panel.main),/=maximized$/.test(n.app.currentView)&&(s.expanded=!0)):(s.expandable&&(s.expanded=!s.expanded),s.maximizable&&(s.expanded?X.push({name:"devices",params:{view:"panel="+t.panel.name+"=maximized"},query:X.currentRoute.value.query}):(n.app.currentView=n.app.currentView.replace(/=maximized$/,""),X.back()))),s.expanded?s.levels=s.activeLevels:s.expandable||L?s.levels=[s.activeLevels[0]]:(b=s.activeLevels.indexOf(s.levels[0]),s.levels=[s.activeLevels[b+1]>=0?s.activeLevels[b+1]:s.activeLevels[0]]),s.activeLevels.length>1||s.maximizable?s.icon=s.expandable?s.expanded?"mdi-arrow-collapse":"mdi-arrow-expand":s.expanded?"":"mdi-swap-vertical":s.icon=""}function E(L){let s=n.app.config.panels.map(A=>A.name).indexOf(L),b,D;if(s!==-1&&(D=n.app.config.panels[s].template,b=n.app.config.templates.map(A=>A.name).indexOf(D),b!==-1&&!n.app.config.templates[b].dist))return D}function x(L,s){X.push({name:"settings",params:{tab:s,item:L},query:X.currentRoute.value.query})}function m(L){let s=n.handleDefs(t.panel.info[L],["text","icon","color"],["","",""]);return s.icon&&(s.icon=n.getIcon(s.icon,t.panel.panel.iconmap)),s}function _(L){let s=["left1","left2","mid1","mid2","right1","right2"],b=m(L);return m(s[s.indexOf(L)-1]).text&&b.text&&!b.icon?"ml-1 text-truncate":b.text?"text-truncate":""}const f=C(()=>m("left1")),R=C(()=>m("left2")),p=C(()=>m("mid1")),T=C(()=>m("mid2")),S=C(()=>m("right1")),N=C(()=>m("right2"));return g(!0),(L,s)=>{const b=y("v-progress-linear"),D=y("v-col"),A=y("v-row"),H=y("v-toolbar-title"),M=y("v-btn"),V=y("v-toolbar"),U=y("v-img"),B=y("v-sheet"),ee=y("v-card-text"),F=y("v-icon"),W=y("v-spacer"),ie=y("v-system-bar"),re=y("v-layout"),oe=y("v-card");return K(n).app.isReady?(h(),O(oe,{key:0,variant:"tonal"},{default:k(()=>[w(A,{"no-gutters":""},{default:k(()=>[e.panel.status.bar?(h(),O(D,{key:0},{default:k(()=>[w(b,{height:"7",modelValue:l.value.level,"onUpdate:modelValue":s[0]||(s[0]=$=>l.value.level=$),color:l.value.color,reverse:l.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):z("",!0),e.panel.status.bar2?(h(),O(D,{key:1},{default:k(()=>[w(b,{height:"7",modelValue:c.value.level,"onUpdate:modelValue":s[1]||(s[1]=$=>c.value.level=$),color:c.value.color,reverse:c.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):z("",!0)]),_:1}),w(B,{color:"primary"},{default:k(()=>[w(U,{src:i.value.url,gradient:i.value.url?K(n).app.header.imageGradient:"",height:"48",cover:""},{default:k(()=>[w(V,{color:"transparent",density:"compact",class:"pr-1"},{append:k(()=>[K(n).app.settings.loglevel>6?(h(),P("div",Dt,[J(j(a.value.sortby)+" ",1),E(e.panel.name)?(h(),O(M,{key:0,icon:"mdi-application-edit-outline",size:"small",variant:"plain",onClick:s[2]||(s[2]=$=>x(E(e.panel.name),"templates"))})):z("",!0),w(M,{icon:"mdi-pencil",size:"small",variant:"plain",onClick:s[3]||(s[3]=$=>x(e.panel.name,"panels"))})])):z("",!0),d.value.icon?(h(),O(M,{key:1,icon:d.value.icon,size:"small",variant:"plain",density:"compact",onClick:s[4]||(s[4]=$=>g())},null,8,["icon"])):z("",!0)]),default:k(()=>[w(H,{class:"text-truncate"},{default:k(()=>[J(j(o.value.title),1)]),_:1})]),_:1})]),_:1},8,["src","gradient"])]),_:1}),w(Et,{main:e.panel.main,levels:d.value.levels,iconmap:e.panel.panel.iconmap,devices:e.panel.panel.devices},null,8,["main","levels","iconmap","devices"]),t.panel.internals?(h(),O(ee,{key:0},{default:k(()=>[J(j(t.panel.internals),1)]),_:1})):z("",!0),w(re,{style:{height:"24px"}},{default:k(()=>[w(ie,{color:"secondary"},{default:k(()=>[f.value.icon?(h(),O(F,{key:0,icon:f.value.icon,color:f.value.color},null,8,["icon","color"])):z("",!0),f.value.text?(h(),P("span",{key:1,class:q(_("left1"))},j(f.value.text),3)):z("",!0),R.value.icon?(h(),O(F,{key:2,icon:R.value.icon,color:R.value.color},null,8,["icon","color"])):z("",!0),R.value.text?(h(),P("span",{key:3,class:q(_("left2"))},j(R.value.text),3)):z("",!0),w(W),p.value.icon?(h(),O(F,{key:4,icon:p.value.icon,color:p.value.color},null,8,["icon","color"])):z("",!0),p.value.text?(h(),P("span",{key:5,class:q(_("mid1"))},j(p.value.text),3)):z("",!0),T.value.icon?(h(),O(F,{key:6,icon:T.value.icon,color:T.value.color},null,8,["icon","color"])):z("",!0),T.value.text?(h(),P("span",{key:7,class:q(_("mid2"))},j(T.value.text),3)):z("",!0),w(W),S.value.icon?(h(),O(F,{key:8,icon:S.value.icon,color:S.value.color},null,8,["icon","color"])):z("",!0),S.value.text?(h(),P("span",{key:9,class:q(_("right1"))},j(S.value.text),3)):z("",!0),N.value.icon?(h(),O(F,{key:10,icon:N.value.icon,color:N.value.color},null,8,["icon","color"])):z("",!0),N.value.text?(h(),P("span",{key:11,class:q(_("right2"))},j(N.value.text),3)):z("",!0)]),_:1})]),_:1})]),_:1})):z("",!0)}}};export{Lt as _};
