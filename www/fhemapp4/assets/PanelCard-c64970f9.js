import{u as Y,c as D,r as x,o as _,b as M,y as q,t as P,k as S,a as O,w as z,j as K,z as be,F as Z,e as y,s as Q,f as F,q as ee,x as ne,d as fe,l as je,A as se,B as ue,C as Ie,D as Fe,E as Ce,G as we,H as Re,m as Ee,I as Ue,J as Ne,h as W,K as He,L as qe,i as Be,p as We,M as Ke,N as $e,O as Je,P as Ge}from"./index-02eab5f7.js";const Ze={__name:"PanelMainInfo",props:{el:Object,iconmap:Array,devices:Object,height:String},setup(e){const t=e,n=Y(),r=D(()=>n.handleDefs(t.el.text,["text","format"],["",!t.el.text2&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),u=D(()=>n.handleDefs(t.el.text2,["text","format"],["",t.el.text&&!t.el.text3&&!t.el.icon?"text-h6":"text-caption"])),s=D(()=>n.handleDefs(t.el.text3,["text","format"],["","text-caption"])),c=D(()=>{let a=n.handleDefs(t.el.icon,["icon","color","size"],["","","x-large"]);return a.icon&&(a.icon=n.getIcon(a.icon,t.iconmap)),a}),i=D(()=>{let a=n.handleDefs(t.el.status,["level","color","min","max","reverse","linear"],[0,"success",0,100,!1,!1]);return a.level=Math.round((a.level-a.min)/(a.max-a.min)*100),a.reverse=!!a.reverse,a});return(a,o)=>{const d=x("v-icon"),f=x("v-progress-circular"),g=x("v-progress-linear");return _(),M(Z,null,[e.el.text?(_(),M("div",{key:0,class:q(r.value.format)},P(r.value.text),3)):S("",!0),e.el.icon?(_(),O(d,{key:1,color:c.value.color,size:c.value.size},{default:z(()=>[K(P(c.value.icon),1)]),_:1},8,["color","size"])):S("",!0),e.el.status&&!i.value.linear?(_(),O(f,{key:2,width:"4",modelValue:i.value.level,"onUpdate:modelValue":o[0]||(o[0]=C=>i.value.level=C),color:i.value.color,reverse:i.value.reverse},null,8,["modelValue","color","reverse"])):S("",!0),e.el.status&&i.value.linear?(_(),O(g,{key:3,height:"7",rounded:"",modelValue:i.value.level,"onUpdate:modelValue":o[1]||(o[1]=C=>i.value.level=C),color:i.value.color,reverse:i.value.reverse},null,8,["modelValue","color","reverse"])):S("",!0),be("div",{class:q(e.el.text2?u.value.format:s.value.format)},[e.el.text2?(_(),M("span",{key:0,class:q(u.value.format)},P(u.value.text),3)):S("",!0),e.el.text3?(_(),M("span",{key:1,class:q(s.value.format)},P(s.value.text),3)):S("",!0)],2)],64)}}},Ye={__name:"PanelMainBtn",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Y(),r=D(()=>{let a=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["",!1,"","text"]);return a.icon&&(a.icon=n.getIcon(a.icon,t.iconmap)),a}),u=D(()=>{let a=n.handleDefs(t.el.status,["level","color","min","max","reverse"],[0,"success",0,100,!1]);return a.level=Math.round((a.level-a.min)/(a.max-a.min)*100),a.reverse=!!a.reverse,a}),s={timer:!1,long:!1};function c(a){let o;if(a.cmd){if(a.type==="cmd"){o=a.cmd.split(";");for(const[d,f]of Object.entries(o)){o[d]=f;for(const g of t.devices)o[d]=o[d].replace(g.split(":")[0],g.split(":")[1])}n.request("text",o.join(";"))}a.type==="route"&&Q.push({name:"devices",params:{view:a.cmd},query:Q.currentRoute.value.query}),a.type==="url"&&window.open(a.cmd,"_self")}}function i(a){let o=n.handleDefs(t.el.click,["cmd","type"],["","cmd"],!1,null,!0),d=n.handleDefs(t.el.longClick,["cmd","type"],["","cmd"],!1,null,!0),f=n.handleDefs(t.el.longRelease,["cmd","type"],["","cmd"],!1,null,!0),g="ontouchstart"in document;(!g&&a==="mouseStart"||a==="touchStart")&&(s.timer=setTimeout(()=>{s.long=!0,d.cmd&&c(d)},1e3)),(!g&&a==="mouseEnd"||a==="touchEnd")&&(s.long?f.cmd&&c(f):o.cmd&&c(o),clearTimeout(s.timer),s.long=!1)}return(a,o)=>{const d=x("v-progress-linear"),f=x("v-icon"),g=x("v-btn");return _(),M(Z,null,[e.el.status?(_(),O(d,{key:0,height:"4",modelValue:u.value.level,"onUpdate:modelValue":o[0]||(o[0]=C=>u.value.level=C),color:u.value.color,reverse:u.value.reverse},null,8,["modelValue","color","reverse"])):S("",!0),y(g,{icon:"",variant:r.value.variant,disabled:r.value.disabled,color:r.value.color,onMousedown:o[1]||(o[1]=C=>i("mouseStart")),onTouchstart:o[2]||(o[2]=C=>i("touchStart")),onMouseup:o[3]||(o[3]=C=>i("mouseEnd")),onTouchend:o[4]||(o[4]=C=>i("touchEnd")),class:"my-2"},{default:z(()=>[y(f,{size:"large"},{default:z(()=>[K(P(r.value.icon),1)]),_:1})]),_:1},8,["variant","disabled","color"])],64)}}},Xe={class:"text-white"},Qe={__name:"PanelMainSlider",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Y(),r=F();function u(a){r.value=a}const s=D(()=>{let a=n.handleDefs(t.el.slider,["cmd","current","color","min","max","steps","reverse","size","vertical"],["",0,"",0,100,10,!1,4,!1],!1,null,!0);return/%v/.test(a.current)&&(a.current=a.current.replace("%v",r.value)),u(a.current),a});let c=null;function i(a){let o=s.value.cmd,d=/\./.exec(s.value.steps),f=0,g=[];d&&(f=s.value.steps.slice(d.index).length-1),o=o.replace("%v",a.toFixed(f));for(const C of t.devices)g=C.split(":"),RegExp(g[0]).test(o)&&(o=o.replace(g[0],g[1]));clearTimeout(c),c=setTimeout(()=>{n.request("text",o)},500)}return(a,o)=>{const d=x("v-slider");return _(),O(d,{modelValue:r.value,"onUpdate:modelValue":[o[0]||(o[0]=f=>r.value=f),o[1]||(o[1]=f=>i(f))],min:s.value.min,max:s.value.max,step:s.value.steps,reverse:s.value.reverse,direction:s.value.vertical?"vertical":"horizontal","track-size":s.value.size,color:s.value.color,"hide-details":"","thumb-label":""},{"thumb-label":z(({modelValue:f})=>[be("div",Xe,P(f),1)]),_:1},8,["modelValue","min","max","step","reverse","direction","track-size","color"])}}},et={__name:"PanelMainImage",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Y(),r=F(!1),u=D(()=>n.handleDefs(t.el.image,["source","height"],["",null]));return(s,c)=>{const i=x("v-skeleton-loader"),a=x("v-img");return _(),M(Z,null,[r.value?S("",!0):(_(),O(i,{key:0,type:"image"})),y(a,{src:u.value.source,height:u.value.height,onLoad:c[0]||(c[0]=o=>r.value=!0)},null,8,["src","height"])],64)}}},tt={__name:"PanelMainMenu",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Y(),r=F([]);ee(t.el,i=>{s()});const u=D(()=>{let i=n.handleDefs(t.el.btn,["icon","disabled","color","variant"],["mdi-dots-vertical",!1,"","text"]);return i.icon&&(i.icon=n.getIcon(i.icon,t.iconmap)),i});async function s(){let i=n.handleDefs(t.el.menu,["name","cmd","convert"],["","",null],!0,","),a,o,d;r.value=[];for(const f of i){a=/^get/.test(f.name)?await c(f.name):f.name;for(const g of[",","|",`
`])RegExp(g).test(a)&&(o=g);for(const g of a.split(o))g&&(d=g,/%v/.test(f.cmd)&&f.convert==="regExp"&&(d=RegExp(g.replace(/[^a-z,^A-Z]/g,"."))),r.value.push({name:g,cmd:f.cmd.replace(/%v/g,d)}))}}async function c(i){let a=[];for(const o of t.devices)a=o.split(":"),RegExp(a[0]).test(i)&&(i=i.replace(a[0],a[1]));return n.request("text",i)}return s(),(i,a)=>{const o=x("v-icon"),d=x("v-btn"),f=x("v-list-item-title"),g=x("v-list-item"),C=x("v-list"),b=x("v-menu");return _(),O(b,null,{activator:z(({props:h})=>[y(d,ne(h,{icon:"",variant:u.value.variant,disabled:u.value.disabled||r.value.length<1,color:u.value.color,class:"my-2"}),{default:z(()=>[y(o,{size:"large"},{default:z(()=>[K(P(u.value.icon),1)]),_:1})]),_:2},1040,["variant","disabled","color"])]),default:z(()=>[y(C,null,{default:z(()=>[(_(!0),M(Z,null,fe(r.value,(h,m)=>(_(),O(g,{key:m,value:m,onClick:v=>c(h.cmd)},{default:z(()=>[y(f,null,{default:z(()=>[K(P(h.name),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})}}};var _e=null;function nt(e){return _e||(_e=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),_e(e)}var he=null;function at(e){he||(he=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),he(e)}function it(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function ce(e,t){t===void 0&&(t={});var n=document.createElement(e);return Object.keys(t).forEach(function(r){n[r]=t[r]}),n}function Ae(e,t,n){var r=window.getComputedStyle(e,n||null)||{display:"none"};return r[t]}function xe(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(Ae(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var rt='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',ye=0,ve=null;function ot(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=ut.bind(e));var n=e.__resize_listeners__;if(!n){if(e.__resize_listeners__=[],window.ResizeObserver){var r=e.offsetWidth,u=e.offsetHeight,s=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===r&&e.offsetHeight===u)||me(e)}),c=xe(e),i=c.detached,a=c.rendered;e.__resize_observer_triggered__=i===!1&&a===!1,e.__resize_observer__=s,s.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){me(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(ye||(ve=it(rt)),ct(e),e.__resize_rendered__=xe(e).rendered,window.MutationObserver){var o=new MutationObserver(e.__resize_mutation_handler__);o.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=o}}e.__resize_listeners__.push(t),ye++}function lt(e,t){var n=e.__resize_listeners__;if(n){if(t&&n.splice(n.indexOf(t),1),!n.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",ze),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--ye&&ve&&ve.parentNode.removeChild(ve)}}function st(e){var t=e.__resize_last__,n=t.width,r=t.height,u=e.offsetWidth,s=e.offsetHeight;return u!==n||s!==r?{width:u,height:s}:null}function ut(){var e=xe(this),t=e.rendered,n=e.detached;t!==this.__resize_rendered__&&(!n&&this.__resize_triggers__&&(ke(this),this.addEventListener("scroll",ze,!0)),this.__resize_rendered__=t,me(this))}function ze(){var e=this;ke(this),this.__resize_raf__&&at(this.__resize_raf__),this.__resize_raf__=nt(function(){var t=st(e);t&&(e.__resize_last__=t,me(e))})}function me(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function ct(e){var t=Ae(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var n=ce("div",{className:"resize-triggers"}),r=ce("div",{className:"resize-expand-trigger"}),u=ce("div"),s=ce("div",{className:"resize-contract-trigger"});r.appendChild(u),n.appendChild(r),n.appendChild(s),e.appendChild(n),e.__resize_triggers__={triggers:n,expand:r,expandChild:u,contract:s},ke(e),e.addEventListener("scroll",ze,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function ke(e){var t=e.__resize_triggers__,n=t.expand,r=t.expandChild,u=t.contract,s=u.scrollWidth,c=u.scrollHeight,i=n.offsetWidth,a=n.offsetHeight,o=n.scrollWidth,d=n.scrollHeight;u.scrollLeft=s,u.scrollTop=c,r.style.width=i+1+"px",r.style.height=a+1+"px",n.scrollLeft=o,n.scrollTop=d}var G=function(){return G=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var u in t=arguments[n])Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u]);return e},G.apply(this,arguments)};var dt=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function vt(e){return t=Object.create(null),dt.forEach(function(n){t[n]=function(r){return function(){for(var u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[r].apply(e.value,u)}}(n)}),t;var t}var ft={autoresize:[Boolean,Object]},mt=/^on[^a-z]/,pt=function(e){return mt.test(e)};function de(e,t){var n=W(e);return n&&typeof n=="object"&&"value"in n?n.value||t:n||t}var _t="ecLoadingOptions",ht={loading:Boolean,loadingOptions:Object},ae=null,Me="x-vue-echarts",De=[],ie=[];(function(e,t){if(e&&typeof document<"u"){var n,r=t.prepend===!0?"prepend":"append",u=t.singleTag===!0,s=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(u){var c=De.indexOf(s);c===-1&&(c=De.push(s)-1,ie[c]={}),n=ie[c]&&ie[c][r]?ie[c][r]:ie[c][r]=i()}else n=i();e.charCodeAt(0)===65279&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function i(){var a=document.createElement("style");if(a.setAttribute("type","text/css"),t.attributes)for(var o=Object.keys(t.attributes),d=0;d<o.length;d++)a.setAttribute(o[d],t.attributes[o[d]]);var f=r==="prepend"?"afterbegin":"beforeend";return s.insertAdjacentElement(f,a),a}})(`x-vue-echarts,.echarts-inner{display:block;width:100%;height:100%;min-width:0}
`,{});var gt=function(){if(ae!=null)return ae;if(typeof HTMLElement>"u"||typeof customElements>"u")return ae=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)(Me)}catch{return ae=!1}return ae=!0}(),xt="ecTheme",yt="ecInitOptions",bt="ecUpdateOptions",wt=je({name:"echarts",props:G(G({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},ft),ht),emits:{},inheritAttrs:!1,setup:function(e,t){var n=t.attrs,r=se(),u=se(),s=se(),c=se(),i=ue(xt,null),a=ue(yt,null),o=ue(bt,null),d=Ie(e),f=d.autoresize,g=d.manualUpdate,C=d.loading,b=d.loadingOptions,h=D(function(){return c.value||e.option||null}),m=D(function(){return e.theme||de(i,{})}),v=D(function(){return e.initOptions||de(a,{})}),A=D(function(){return e.updateOptions||de(o,{})}),p=D(function(){return function(l){var w={};for(var L in l)pt(L)||(w[L]=l[L]);return w}(n)}),T=Fe().proxy.$listeners;function E(l){if(u.value){var w=s.value=Ue(u.value,m.value,v.value);e.group&&(w.group=e.group);var L=T;L||(L={},Object.keys(n).filter(function(V){return V.indexOf("on")===0&&V.length>2}).forEach(function(V){var R=V.charAt(2).toLowerCase()+V.slice(3);R.substring(R.length-4)==="Once"&&(R="~".concat(R.substring(0,R.length-4))),L[R]=n[V]})),Object.keys(L).forEach(function(V){var R=L[V];if(R){var I=V.toLowerCase();I.charAt(0)==="~"&&(I=I.substring(1),R.__once__=!0);var B=w;if(I.indexOf("zr:")===0&&(B=w.getZr(),I=I.substring(3)),R.__once__){delete R.__once__;var te=R;R=function(){for(var X=[],$=0;$<arguments.length;$++)X[$]=arguments[$];te.apply(void 0,X),B.off(I,R)}}B.on(I,R)}}),f.value?Ne(function(){w&&!w.isDisposed()&&w.resize(),j()}):j()}function j(){var V=l||h.value;V&&w.setOption(V,A.value)}}function N(){s.value&&(s.value.dispose(),s.value=void 0)}var U=null;ee(g,function(l){typeof U=="function"&&(U(),U=null),l||(U=ee(function(){return e.option},function(w,L){w&&(s.value?s.value.setOption(w,G({notMerge:w!==L},A.value)):E())},{deep:!0}))},{immediate:!0}),ee([m,v],function(){N(),E()},{deep:!0}),Ce(function(){e.group&&s.value&&(s.value.group=e.group)});var k=vt(s);return function(l,w,L){var j=ue(_t,{}),V=D(function(){return G(G({},de(j,{})),L==null?void 0:L.value)});Ce(function(){var R=l.value;R&&(w.value?R.showLoading(V.value):R.hideLoading())})}(s,C,b),function(l,w,L){var j=null;ee([L,l,w],function(V,R,I){var B=V[0],te=V[1],X=V[2];if(B&&te&&X){var $=X===!0?{}:X,re=$.throttle,oe=re===void 0?100:re,le=$.onResize,J=function(){te.resize(),le==null||le()};j=oe?He(J,oe):J,ot(B,j)}I(function(){B&&j&&lt(B,j)})})}(s,f,u),we(function(){E()}),Re(function(){gt&&r.value?r.value.__dispose=N:N()}),G({chart:s,root:r,inner:u,setOption:function(l,w){e.manualUpdate&&(c.value=l),s.value?s.value.setOption(l,w||{}):E(l)},nonEventAttrs:p},k)},render:function(){var e=G({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",Ee(Me,e,[Ee("div",{ref:"inner",class:"echarts-inner"})])}});const zt={key:0,class:"mx-4 my-4 text-right"},kt={__name:"PanelMainChart",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Y(),r=qe(),{mobile:u}=Be(),s=We(),c=F({}),i=F({from:null,to:null,fromMenu:!1,toMenu:!1,loaded:!1});let a=[];const o=D(()=>(C(),"height: "+(/=maximized$/.test(n.app.currentView)?window.innerHeight-250+"px":t.height)));function d(b){return s.d(b,{dateStyle:u.value?"short":"long"})}function f(b,h){let m;return i.value.from&&h&&(m=i.value.from),i.value.to&&!h&&(m=i.value.to),!m&&!isNaN(b)&&(m=(v=>new Date(v.setDate(v.getDate()+(Number(b)||0))))(new Date)),m||(m=new Date(/.*T.*/.test(b)?b:b+"T00:00:00")),!i.value.from&&h&&(i.value.from=m),!i.value.to&&!h&&(i.value.to=m),m=new Date(m.getTime()-m.getTimezoneOffset()*60*1e3),m.toISOString().split("T")[0]}async function g(){let b=n.handleDefs(t.el.serie,["data","name","digits","suffix","type"],[null,"",0,"","line"],!0),h,m,v=[],A,p,T,E,N,U=[];if(b.length>0)for(const k of b){if(/^get.*/.test(k.data)){N="time",h=k.data.split(" ");for(const l of t.devices)l.split(":")[0]===h[1]&&(h[1]=l.split(":")[1]);if(h[4]=f(h[4],!0),h[5]=f(h[5],!1),m=await n.request("text",h.join(" ")),E=[],v=m.split(`
`),v.length>0)for(const l of v)A=l.split(" "),A.length>1&&(p=new Date(A[0].replace("_","T")),T=parseFloat(A[1]).toFixed(k.digits),E.push([p,T]))}else/^\[.*\]/.test(k.data)?E=n.stringToJson(k.data):E=[n.replacer("%n("+k.digits+")",k.data,!0)];U.push({xAxisType:N,type:k.type,name:k.name,digits:k.digits,suffix:k.suffix,data:E})}return U}async function C(){let b={tooltip:{trigger:"axis"},legend:{data:[],bottom:10},backgroundColor:"rgba(255, 255, 255, 0)",grid:{top:30,bottom:60,left:60,right:60},animationDuration:300,series:[],yAxis:[],xAxis:{}},h=JSON.parse(JSON.stringify(n.getEl(t.el,["options"])||{})),m=JSON.parse(JSON.stringify(n.getEl(t.el,["options2"])||{})),v=Object.assign(b,/=maximized$/.test(n.app.currentView)&&Object.keys(m).length>0?m:h),A;i.value.fromMenu=!1,i.value.toMenu=!1,i.value.loaded=!1,a=await g();for(const[p,T]of Object.entries(a))A={formatter:E=>E.toLocaleString(s.locale.value,{minimumFractionDigits:T.digits,maximumFractionDigits:T.digits})+T.suffix},v.series[p]||(v.series[p]={}),v.yAxis[p]||(v.yAxis[p]={}),v.legend.data||(v.legend.data=[]),v.xAxis.type||(v.xAxis.type=T.xAxisType),v.yAxis[p].type||(v.yAxis[p].type="value"),v.yAxis[p].axisLabel||(v.yAxis[p].axisLabel={}),v.yAxis[p].axisLabel.formatter||(v.yAxis[p].axisLabel.formatter=A.formatter),v.legend.data[p]||(v.legend.data[p]=T.name),v.series[p].name||(v.series[p].name=T.name),v.series[p].type||(v.series[p].type=T.type),v.series[p].data||(v.series[p].data=T.data),v.series[p].detail||(v.series[p].detail={}),v.series[p].detail.formatter||(v.series[p].detail.formatter=A.formatter),v.series[p].tooltip||(v.series[p].tooltip={}),v.series[p].tooltip.valueFormatter||(v.series[p].tooltip.valueFormatter=A.formatter);n.log(7,"Chartdata chart.loaded.",v),c.value=Object.assign({},v),i.value.loaded=!0}return(b,h)=>{const m=x("v-btn"),v=x("v-date-picker"),A=x("v-locale-provider"),p=x("v-menu"),T=x("v-skeleton-loader");return _(),M(Z,null,[/=maximized$/.test(W(n).app.currentView)?(_(),M("div",zt,[y(p,{modelValue:i.value.fromMenu,"onUpdate:modelValue":h[2]||(h[2]=E=>i.value.fromMenu=E),"close-on-content-click":!1},{activator:z(({props:E})=>[y(m,ne(E,{variant:"outlined","append-icon":"mdi-calendar",class:"mr-2"}),{default:z(()=>[K(P(d(i.value.from)),1)]),_:2},1040)]),default:z(()=>[y(A,{locale:W(s).locale.value},{default:z(()=>[y(v,{modelValue:i.value.from,"onUpdate:modelValue":[h[0]||(h[0]=E=>i.value.from=E),h[1]||(h[1]=E=>C())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"]),K(" - "),y(p,{modelValue:i.value.toMenu,"onUpdate:modelValue":h[5]||(h[5]=E=>i.value.toMenu=E),"close-on-content-click":!1},{activator:z(({props:E})=>[y(m,ne(E,{variant:"outlined","append-icon":"mdi-calendar",class:"ml-2"}),{default:z(()=>[K(P(d(i.value.to)),1)]),_:2},1040)]),default:z(()=>[y(A,{locale:W(s).locale.value},{default:z(()=>[y(v,{modelValue:i.value.to,"onUpdate:modelValue":[h[3]||(h[3]=E=>i.value.to=E),h[4]||(h[4]=E=>C())],color:"secondary"},null,8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["modelValue"])])):S("",!0),be("div",{style:Ke(o.value)},[i.value.loaded?S("",!0):(_(),O(T,{key:0,type:"text, image, text"})),i.value.loaded?(_(),O(W(wt),{key:1,option:c.value,theme:W(r).global.name.value==="dark"?"dark":"light",autoresize:""},null,8,["option","theme"])):S("",!0)],4)],64)}}},St=180/Math.PI,Oe=e=>{const t=e%360;return t<0?360+t:t},Ct=({x:e,y:t},n)=>{const r=n.left+n.width/2,u=n.top+n.height/2;return Math.atan2(t-u,e-r)*St},ge=()=>{};class Et{constructor(t,n){this.active=!1,this.element=t,this.element.style.willChange="transform",this.initOptions(n),this.updateCSS(),this.bindHandlers(),this.addListeners()}get angle(){return this._angle}set angle(t){this._angle!==t&&(this._angle=Oe(t),this.updateCSS())}initOptions(t){t=t||{},this.onRotate=t.onRotate||ge,this.onDragStart=t.onDragStart||ge,this.onDragStop=t.onDragStop||ge,this._angle=t.angle||0}bindHandlers(){this.onRotationStart=this.onRotationStart.bind(this),this.onRotated=this.onRotated.bind(this),this.onRotationStop=this.onRotationStop.bind(this)}addListeners(){this.element.addEventListener("touchstart",this.onRotationStart,{passive:!0}),document.addEventListener("touchmove",this.onRotated,{passive:!1}),document.addEventListener("touchend",this.onRotationStop,{passive:!0}),document.addEventListener("touchcancel",this.onRotationStop,{passive:!0}),this.element.addEventListener("mousedown",this.onRotationStart,{passive:!0}),document.addEventListener("mousemove",this.onRotated,{passive:!1}),document.addEventListener("mouseup",this.onRotationStop,{passive:!0}),document.addEventListener("mouseleave",this.onRotationStop,{passive:!1})}removeListeners(){this.element.removeEventListener("touchstart",this.onRotationStart),document.removeEventListener("touchmove",this.onRotated),document.removeEventListener("touchend",this.onRotationStop),document.removeEventListener("touchcancel",this.onRotationStop),this.element.removeEventListener("mousedown",this.onRotationStart),document.removeEventListener("mousemove",this.onRotated),document.removeEventListener("mouseup",this.onRotationStop),document.removeEventListener("mouseleave",this.onRotationStop)}destroy(){this.onRotationStop(),this.removeListeners()}onRotationStart(t){(t.type==="touchstart"||t.button===0)&&(this.active=!0,this.onDragStart(t),this.setAngleFromEvent(t))}onRotationStop(){this.active&&(this.active=!1,this.onDragStop()),this.active=!1}onRotated(t){this.active&&(t.preventDefault(),this.setAngleFromEvent(t))}setAngleFromEvent(t){const n=t.targetTouches?t.targetTouches[0]:t,r=Ct({x:n.clientX,y:n.clientY},this.element.getBoundingClientRect());this._angle=Oe(r+90),this.updateCSS(),this.onRotate(this._angle)}updateCSS(){this.element.style.transform="rotate("+this._angle+"deg)"}}const Dt=["red","yellow","green","cyan","blue","magenta","red"],Le={ArrowUp:(e,t)=>e+t,ArrowRight:(e,t)=>e+t,ArrowDown:(e,t)=>e-t,ArrowLeft:(e,t)=>e-t,PageUp:(e,t)=>e+t*10,PageDown:(e,t)=>e-t*10,Home:()=>0,End:()=>359},pe={name:"ColorPicker",emits:["select","input","change"],props:{hue:{default:0},saturation:{default:100},luminosity:{default:50},alpha:{default:1},step:{default:1},mouseScroll:{default:!1},variant:{default:"collapsible"},disabled:{default:!1},initiallyCollapsed:{default:!1},ariaLabel:{default:"color picker"},ariaRoledescription:{default:"radial slider"},ariaValuetext:{default:""},ariaLabelColorWell:{default:"color well"}},setup(e,{emit:t}){const n=F(null),r=F(null);let u=null;const s=e.hue+"deg",c=F(e.hue),i=F(!e.initiallyCollapsed),a=F(!e.initiallyCollapsed),o=F(!1),d=F(!1),f=F(!1),g=D(()=>`hsla(${c.value}, ${e.saturation}%, ${e.luminosity}%, ${e.alpha})`),C=D(()=>Dt[Math.round(c.value/60)]);return ee(()=>e.hue,p=>{c.value=p,u.angle=p}),we(()=>{u=new Et(r.value,{angle:c.value,onRotate(p){c.value=p,t("input",c.value)},onDragStart(){f.value=!0},onDragStop(){f.value=!1,t("change",c.value)}})}),Re(()=>{u.destroy(),u=null}),{rcp:u,el:n,rotator:r,initialAngle:s,angle:c,isPaletteIn:i,isKnobIn:a,isDragging:f,isRippling:d,isPressed:o,color:g,valuetext:C,onKeyDown:p=>{e.disabled||o.value||!a.value||!(p.key in Le)||(p.preventDefault(),u.angle=Le[p.key](u.angle,e.step),c.value=u.angle,t("input",c.value),t("change",c.value))},onScroll:p=>{o.value||!a.value||(p.preventDefault(),p.deltaY>0?u.angle+=e.step:u.angle-=e.step,c.value=u.angle,t("input",c.value),t("change",c.value))},selectColor:()=>{o.value=!0,i.value&&a.value?(t("select",c.value),d.value=!0):i.value=!0},togglePicker:()=>{e.variant!=="persistent"&&(a.value?a.value=!1:(a.value=!0,i.value=!0)),d.value=!1,o.value=!1},hidePalette:()=>{a.value||(i.value=!1)}}}};function Ot(e,t,n,r,u,s){return _(),O("div",{ref:"el",role:"slider","aria-roledescription":n.ariaRoledescription,"aria-label":n.ariaLabel,"aria-expanded":r.isPaletteIn,"aria-valuemin":"0","aria-valuemax":"359","aria-valuenow":r.angle,"aria-valuetext":n.ariaValuetext||r.valuetext,"aria-disabled":n.disabled,class:["rcp",{dragging:r.isDragging,disabled:n.disabled}],tabindex:n.disabled?-1:0,style:{"--rcp-initial-angle":r.initialAngle},onKeyup:t[4]||(t[4]=Je((...c)=>r.selectColor&&r.selectColor(...c),["enter"])),onKeydown:t[5]||(t[5]=(...c)=>r.onKeyDown&&r.onKeyDown(...c))},[y("div",{class:["rcp__palette",r.isPaletteIn?"in":"out"]},null,2),y("div",ne({class:"rcp__rotator",style:{"pointer-events":n.disabled||r.isPressed||!r.isKnobIn?"none":null}},$e(n.mouseScroll?{wheel:r.onScroll}:{}),{ref:"rotator"}),[y("div",{class:["rcp__knob",r.isKnobIn?"in":"out"],onTransitionend:t[1]||(t[1]=(...c)=>r.hidePalette&&r.hidePalette(...c))},null,34)],16),y("div",{class:["rcp__ripple",{rippling:r.isRippling}],style:{borderColor:r.color}},null,6),y("button",{type:"button",class:["rcp__well",{pressed:r.isPressed}],"aria-label":n.ariaLabelColorWell,disabled:n.disabled,tabindex:n.disabled?-1:0,style:{backgroundColor:r.color},onAnimationend:t[2]||(t[2]=(...c)=>r.togglePicker&&r.togglePicker(...c)),onClick:t[3]||(t[3]=(...c)=>r.selectColor&&r.selectColor(...c))},null,46,["aria-label","disabled","tabindex"])],46,["aria-roledescription","aria-label","aria-expanded","aria-valuenow","aria-valuetext","aria-disabled","tabindex"])}pe.render=Ot;pe.install=function(e){e.component("ColorPicker",pe)};const Lt={class:"mt-4 mb-2"},Rt={__name:"PanelMainColorpicker",props:{el:Object,iconmap:Array,devices:Array,height:String},setup(e){const t=e,n=Y(),r=D(()=>n.handleDefs(t.el.picker,["cmd","current"],["",!1]));function u(i){let a=s(i,50,100),o=r.value.cmd,d=[];o=o.replace("%v",a);for(const f of t.devices)d=f.split(":"),RegExp(d[0]).test(o)&&(o=o.replace(d[0],d[1]));n.request("text",o)}function s(i,a,o){a/=100;const d=o*Math.min(a,1-a)/100,f=g=>{const C=(g+i/30)%12,b=a-d*Math.max(Math.min(C-3,9-C,1),-1);return Math.round(255*b).toString(16).padStart(2,"0")};return`${f(0)}${f(8)}${f(4)}`}function c(i){i.split(" ").length>1&&(i=i.split(" ").slice(-1)[0]),i=i.replace(/^#/,"");let a=parseInt(i,16),o=a>>16&255,d=a>>8&255,f=a&255;o/=255,d/=255,f/=255;let g=Math.max(o,d,f),C=Math.min(o,d,f),b=g-C,h=(g+C)/2,m=0,v=0;return b!==0&&(g===o?m=((d-f)/b+(d<f?6:0))%6:g===d?m=((f-o)/b+2)%6:m=((o-d)/b+4)%6,m=m*60,v=b/(1-Math.abs(2*h-1))),v=Math.round(v*100),h=Math.round(h*100),{hue:m,saturation:v,luminosity:h}}return(i,a)=>(_(),M("div",Lt,[y(W(pe),ne(c(r.value.current),{variant:"persistent",onChange:a[0]||(a[0]=o=>u(o))}),null,16)]))}},At={__name:"PanelMain",props:{main:Object,levels:Array,iconmap:Object,devices:Object},setup(e){const t=Y();function n(i,a){return t.handleDefs(i[a].size,["size"],[!1]).size}function r(i){let a="";return["info"].indexOf(i)!==-1&&(a="mx-2"),a}function u(i,a){return i[a]?t.handleDefs(i[a].divider,["show"],[!1]).show:!1}function s(i){return i.level?t.handleDefs(i.level.height,["height"],["64px"]).height:"64px"}function c(i){if(i==="info")return Ze;if(i==="btn")return Ye;if(i==="slider")return Qe;if(i==="image")return et;if(i==="menu")return tt;if(i==="chart")return kt;if(i==="colorpicker")return Rt}return(i,a)=>{const o=x("v-sheet"),d=x("v-col"),f=x("v-divider"),g=x("v-row"),C=x("v-expand-transition");return _(!0),M(Z,null,fe(e.main,(b,h)=>(_(),M("div",{key:h},[y(C,null,{default:z(()=>[e.levels.indexOf(h)!==-1?(_(),O(g,{key:0,"no-gutters":"",class:"text-center align-center"},{default:z(()=>[y(o,{height:s(b,"level")},null,8,["height"]),(_(),M(Z,null,fe(["left1","left2","mid","right1","right2"],m=>(_(),M(Z,{key:m},[b.level[m]?(_(),O(d,{key:0,cols:n(b,m),class:q(r(b.level[m]))},{default:z(()=>[(_(),O(Ge(c(b.level[m])),{el:b[m],iconmap:e.iconmap,devices:e.devices,height:s(b,"level")},null,8,["el","iconmap","devices","height"]))]),_:2},1032,["cols","class"])):S("",!0),u(b,m)?(_(),O(f,{key:1,vertical:""})):S("",!0)],64))),64)),u(b,"level")?(_(),O(f,{key:0})):S("",!0)]),_:2},1024)):S("",!0)]),_:2},1024)]))),128)}}},Mt={key:0},Pt={__name:"PanelCard",props:{panel:Object},setup(e){const t=e,n=Y();let r=n.thread();we(()=>n.thread(r));function u(k){let l=n.handleDefs(t.panel.status[k],["level","color","min","max","reverse"],[0,"success",0,100,!1]);return l.level=Math.round((l.level-l.min)/(l.max-l.min)*100),l}const s=D(()=>u("bar")),c=D(()=>u("bar2")),i=D(()=>n.handleDefs(t.panel.status.imageUrl,["url"],[""])),a=D(()=>n.handleDefs(t.panel.panel.sortby,["sortby"],[null])),o=D(()=>n.handleDefs(t.panel.status.title,["title"],[""])),d=F(n.handleDefs(t.panel.panel.expandable,["expandable","expanded","maximizable"],[!1,!1,!1]));ee(t.panel.main,k=>{let l=f(k);d.value.activeLevels.join("-")!==l.join("-")&&(d.value.activeLevels=l,g(!0))});function f(k){let l=[];for(const[w,L]of Object.entries(k))n.handleDefs(L.level.show,["show"],[!0]).show&&l.push(Number(w));return l}function g(k){let l=d.value,w;k?(l.activeLevels=f(t.panel.main),/=maximized$/.test(n.app.currentView)&&(l.expanded=!0)):(l.expandable&&(l.expanded=!l.expanded),l.maximizable&&(l.expanded?Q.push({name:"devices",params:{view:"panel="+t.panel.name+"=maximized"},query:Q.currentRoute.value.query}):(n.app.currentView=n.app.currentView.replace(/=maximized$/,""),Q.back()))),l.expanded?l.levels=l.activeLevels:l.expandable||k?l.levels=[l.activeLevels[0]]:(w=l.activeLevels.indexOf(l.levels[0]),l.levels=[l.activeLevels[w+1]>=0?l.activeLevels[w+1]:l.activeLevels[0]]),l.activeLevels.length>1||l.maximizable?l.icon=l.expandable?l.expanded?"mdi-arrow-collapse":"mdi-arrow-expand":l.expanded?"":"mdi-swap-vertical":l.icon=""}function C(k){let l=n.app.config.panels.map(j=>j.name).indexOf(k),w,L;if(l!==-1&&(L=n.app.config.panels[l].template,w=n.app.config.templates.map(j=>j.name).indexOf(L),w!==-1&&!n.app.config.templates[w].dist))return L}function b(k,l){Q.push({name:"settings",params:{tab:l,item:k},query:Q.currentRoute.value.query})}function h(k){window.open(n.createURL("?detail="+k),"_self")}function m(k){let l=n.handleDefs(t.panel.info[k],["text","icon","color"],["","",""]);return l.icon&&(l.icon=n.getIcon(l.icon,t.panel.panel.iconmap)),l}function v(k){let l=["left1","left2","mid1","mid2","right1","right2"],w=m(k);return m(l[l.indexOf(k)-1]).text&&w.text&&!w.icon?"ml-1 text-truncate":w.text?"text-truncate":""}const A=D(()=>m("left1")),p=D(()=>m("left2")),T=D(()=>m("mid1")),E=D(()=>m("mid2")),N=D(()=>m("right1")),U=D(()=>m("right2"));return g(!0),(k,l)=>{const w=x("v-progress-linear"),L=x("v-col"),j=x("v-row"),V=x("v-toolbar-title"),R=x("v-btn"),I=x("v-list-item"),B=x("v-divider"),te=x("v-list"),X=x("v-menu"),$=x("v-toolbar"),re=x("v-img"),oe=x("v-sheet"),le=x("v-card-text"),J=x("v-icon"),Se=x("v-spacer"),Te=x("v-system-bar"),Ve=x("v-layout"),Pe=x("v-card");return W(n).app.isReady?(_(),O(Pe,{key:0,variant:"tonal"},{default:z(()=>[y(j,{"no-gutters":""},{default:z(()=>[e.panel.status.bar?(_(),O(L,{key:0},{default:z(()=>[y(w,{height:"7",modelValue:s.value.level,"onUpdate:modelValue":l[0]||(l[0]=H=>s.value.level=H),color:s.value.color,reverse:s.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):S("",!0),e.panel.status.bar2?(_(),O(L,{key:1},{default:z(()=>[y(w,{height:"7",modelValue:c.value.level,"onUpdate:modelValue":l[1]||(l[1]=H=>c.value.level=H),color:c.value.color,reverse:c.value.reverse},null,8,["modelValue","color","reverse"])]),_:1})):S("",!0)]),_:1}),y(oe,{color:"primary"},{default:z(()=>[y(re,{src:i.value.url,gradient:i.value.url?W(n).app.header.imageGradient:"",height:"48",cover:""},{default:z(()=>[y($,{color:"transparent",density:"compact",class:"pr-1"},{append:z(()=>[W(n).app.settings.loglevel>6?(_(),M("div",Mt,[K(P(a.value.sortby)+" ",1),y(X,null,{activator:z(({props:H})=>[y(R,ne({icon:"mdi-dots-vertical",density:"compact"},H),null,16)]),default:z(()=>[y(te,{density:"compact"},{default:z(()=>[C(e.panel.name)?(_(),O(I,{key:"template",title:"Template","prepend-icon":"mdi-application-edit-outline",onClick:l[2]||(l[2]=H=>b(C(e.panel.name),"templates"))})):S("",!0),y(I,{key:"panel",title:"Panel","prepend-icon":"mdi-pencil",onClick:l[3]||(l[3]=H=>b(e.panel.name,"panels"))}),y(B),(_(!0),M(Z,null,fe(e.panel.panel.devices,H=>(_(),O(I,{key:H.split(":")[0],title:H.split(":")[1],"prepend-icon":"mdi-link",onClick:Tt=>h(H.split(":")[1])},null,8,["title","onClick"]))),128))]),_:1})]),_:1})])):S("",!0),d.value.icon?(_(),O(R,{key:1,icon:d.value.icon,size:"small",variant:"plain",density:"compact",onClick:l[4]||(l[4]=H=>g())},null,8,["icon"])):S("",!0)]),default:z(()=>[y(V,{class:"text-truncate"},{default:z(()=>[K(P(o.value.title),1)]),_:1})]),_:1})]),_:1},8,["src","gradient"])]),_:1}),y(At,{main:e.panel.main,levels:d.value.levels,iconmap:e.panel.panel.iconmap,devices:e.panel.panel.devices},null,8,["main","levels","iconmap","devices"]),t.panel.internals?(_(),O(le,{key:0},{default:z(()=>[K(P(t.panel.internals),1)]),_:1})):S("",!0),y(Ve,{style:{height:"24px"}},{default:z(()=>[y(Te,{color:"secondary"},{default:z(()=>[A.value.icon?(_(),O(J,{key:0,icon:A.value.icon,color:A.value.color},null,8,["icon","color"])):S("",!0),A.value.text?(_(),M("span",{key:1,class:q(v("left1"))},P(A.value.text),3)):S("",!0),p.value.icon?(_(),O(J,{key:2,icon:p.value.icon,color:p.value.color},null,8,["icon","color"])):S("",!0),p.value.text?(_(),M("span",{key:3,class:q(v("left2"))},P(p.value.text),3)):S("",!0),y(Se),T.value.icon?(_(),O(J,{key:4,icon:T.value.icon,color:T.value.color},null,8,["icon","color"])):S("",!0),T.value.text?(_(),M("span",{key:5,class:q(v("mid1"))},P(T.value.text),3)):S("",!0),E.value.icon?(_(),O(J,{key:6,icon:E.value.icon,color:E.value.color},null,8,["icon","color"])):S("",!0),E.value.text?(_(),M("span",{key:7,class:q(v("mid2"))},P(E.value.text),3)):S("",!0),y(Se),N.value.icon?(_(),O(J,{key:8,icon:N.value.icon,color:N.value.color},null,8,["icon","color"])):S("",!0),N.value.text?(_(),M("span",{key:9,class:q(v("right1"))},P(N.value.text),3)):S("",!0),U.value.icon?(_(),O(J,{key:10,icon:U.value.icon,color:U.value.color},null,8,["icon","color"])):S("",!0),U.value.text?(_(),M("span",{key:11,class:q(v("right2"))},P(U.value.text),3)):S("",!0)]),_:1})]),_:1})]),_:1})):S("",!0)}}};export{Pt as _};
